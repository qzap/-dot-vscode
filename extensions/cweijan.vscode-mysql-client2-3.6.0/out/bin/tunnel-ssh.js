module.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=551)}({0:function(e,t){e.exports=require("util")},1:function(e,t){e.exports=require("stream")},133:function(e,t){e.exports=require("child_process")},16:function(e,t){e.exports=require("buffer")},162:function(e,t,r){e.exports={SFTPStream:r(557),SSH2Stream:r(563),utils:r(72),constants:r(165)}},163:function(e,t){e.exports={newInvalidAsn1Error:function(e){var t=new Error;return t.name="InvalidAsn1Error",t.message=e||"",t}}},164:function(e,t){e.exports={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128}},165:function(e,t,r){var i,n,s,o=r(262),a=t.MESSAGE={DISCONNECT:1,IGNORE:2,UNIMPLEMENTED:3,DEBUG:4,SERVICE_REQUEST:5,SERVICE_ACCEPT:6,KEXINIT:20,NEWKEYS:21,USERAUTH_REQUEST:50,USERAUTH_FAILURE:51,USERAUTH_SUCCESS:52,USERAUTH_BANNER:53,GLOBAL_REQUEST:80,REQUEST_SUCCESS:81,REQUEST_FAILURE:82,CHANNEL_OPEN:90,CHANNEL_OPEN_CONFIRMATION:91,CHANNEL_OPEN_FAILURE:92,CHANNEL_WINDOW_ADJUST:93,CHANNEL_DATA:94,CHANNEL_EXTENDED_DATA:95,CHANNEL_EOF:96,CHANNEL_CLOSE:97,CHANNEL_REQUEST:98,CHANNEL_SUCCESS:99,CHANNEL_FAILURE:100};for(i=0,s=(n=Object.keys(a)).length;i<s;++i)a[a[n[i]]]=n[i];a.KEXDH_INIT=30,a.KEXDH_REPLY=31,a.KEXDH_GEX_REQUEST=34,a.KEXDH_GEX_GROUP=31,a.KEXDH_GEX_INIT=32,a.KEXDH_GEX_REPLY=33,a.KEXECDH_INIT=30,a.KEXECDH_REPLY=31,a.USERAUTH_PASSWD_CHANGEREQ=60,a.USERAUTH_PK_OK=60,a.USERAUTH_INFO_REQUEST=60,a.USERAUTH_INFO_RESPONSE=61;var c=t.DYNAMIC_KEXDH_MESSAGE={};c[a.KEXDH_GEX_GROUP]="KEXDH_GEX_GROUP",c[a.KEXDH_GEX_REPLY]="KEXDH_GEX_REPLY";var u=t.KEXDH_MESSAGE={};u[a.KEXDH_INIT]="KEXDH_INIT",u[a.KEXDH_REPLY]="KEXDH_REPLY";var f=t.DISCONNECT_REASON={HOST_NOT_ALLOWED_TO_CONNECT:1,PROTOCOL_ERROR:2,KEY_EXCHANGE_FAILED:3,RESERVED:4,MAC_ERROR:5,COMPRESSION_ERROR:6,SERVICE_NOT_AVAILABLE:7,PROTOCOL_VERSION_NOT_SUPPORTED:8,HOST_KEY_NOT_VERIFIABLE:9,CONNECTION_LOST:10,BY_APPLICATION:11,TOO_MANY_CONNECTIONS:12,AUTH_CANCELED_BY_USER:13,NO_MORE_AUTH_METHODS_AVAILABLE:14,ILLEGAL_USER_NAME:15};for(i=0,s=(n=Object.keys(f)).length;i<s;++i)f[f[n[i]]]=n[i];var h=t.CHANNEL_OPEN_FAILURE={ADMINISTRATIVELY_PROHIBITED:1,CONNECT_FAILED:2,UNKNOWN_CHANNEL_TYPE:3,RESOURCE_SHORTAGE:4};for(i=0,s=(n=Object.keys(h)).length;i<s;++i)h[h[n[i]]]=n[i];var p=t.TERMINAL_MODE={TTY_OP_END:0,VINTR:1,VQUIT:2,VERASE:3,VKILL:4,VEOF:5,VEOL:6,VEOL2:7,VSTART:8,VSTOP:9,VSUSP:10,VDSUSP:11,VREPRINT:12,VWERASE:13,VLNEXT:14,VFLUSH:15,VSWTCH:16,VSTATUS:17,VDISCARD:18,IGNPAR:30,PARMRK:31,INPCK:32,ISTRIP:33,INLCR:34,IGNCR:35,ICRNL:36,IUCLC:37,IXON:38,IXANY:39,IXOFF:40,IMAXBEL:41,ISIG:50,ICANON:51,XCASE:52,ECHO:53,ECHOE:54,ECHOK:55,ECHONL:56,NOFLSH:57,TOSTOP:58,IEXTEN:59,ECHOCTL:60,ECHOKE:61,PENDIN:62,OPOST:70,OLCUC:71,ONLCR:72,OCRNL:73,ONOCR:74,ONLRET:75,CS7:90,CS8:91,PARENB:92,PARODD:93,TTY_OP_ISPEED:128,TTY_OP_OSPEED:129};for(i=0,s=(n=Object.keys(p)).length;i<s;++i)p[p[n[i]]]=n[i];var l=t.CHANNEL_EXTENDED_DATATYPE={STDERR:1};for(i=0,s=(n=Object.keys(l)).length;i<s;++i)l[l[n[i]]]=n[i];t.SIGNALS=["ABRT","ALRM","FPE","HUP","ILL","INT","QUIT","SEGV","TERM","USR1","USR2","KILL","PIPE"];var d=["diffie-hellman-group14-sha1"],E=["diffie-hellman-group1-sha1"];o.gte(process.version,"0.11.12")&&(d=["diffie-hellman-group-exchange-sha256"].concat(d),E=["diffie-hellman-group-exchange-sha1"].concat(E)),o.gte(process.version,"0.11.14")&&(d=["ecdh-sha2-nistp256","ecdh-sha2-nistp384","ecdh-sha2-nistp521"].concat(d));var g=new Buffer(d.join(","),"ascii");E=d.concat(E);var m=["ssh-rsa"],v=["ssh-dss"];o.gte(process.version,"5.2.0")&&m.push("ecdsa-sha2-nistp256","ecdsa-sha2-nistp384","ecdsa-sha2-nistp521");var w=new Buffer(m.join(","),"ascii");v=m.concat(v);var y=[],_=["aes256-cbc","aes192-cbc","aes128-cbc","blowfish-cbc","3des-cbc","arcfour256","arcfour128","cast128-cbc","arcfour"];o.gte(process.version,"0.11.12")&&(y=["aes128-gcm","aes128-gcm@openssh.com","aes256-gcm","aes256-gcm@openssh.com"].concat(y)),y=["aes128-ctr","aes192-ctr","aes256-ctr"].concat(y);var b=new Buffer(y.join(","),"ascii");_=y.concat(_);var B=["hmac-sha2-256","hmac-sha2-512","hmac-sha1"],S=["hmac-md5","hmac-sha2-256-96","hmac-sha2-512-96","hmac-ripemd160","hmac-sha1-96","hmac-md5-96"],U=new Buffer(B.join(","),"ascii");S=B.concat(S);var I=["none","zlib@openssh.com","zlib"],A=[],T=new Buffer(I.join(","),"ascii");A=I.concat(A),t.ALGORITHMS={KEX:d,KEX_BUF:g,SUPPORTED_KEX:E,SERVER_HOST_KEY:m,SERVER_HOST_KEY_BUF:w,SUPPORTED_SERVER_HOST_KEY:v,CIPHER:y,CIPHER_BUF:b,SUPPORTED_CIPHER:_,HMAC:B,HMAC_BUF:U,SUPPORTED_HMAC:S,COMPRESS:I,COMPRESS_BUF:T,SUPPORTED_COMPRESS:A},t.SSH_TO_OPENSSL={"ecdh-sha2-nistp256":"prime256v1","ecdh-sha2-nistp384":"secp384r1","ecdh-sha2-nistp521":"secp521r1","aes128-gcm":"aes-128-gcm","aes256-gcm":"aes-256-gcm","aes128-gcm@openssh.com":"aes-128-gcm","aes256-gcm@openssh.com":"aes-256-gcm","3des-cbc":"des-ede3-cbc","blowfish-cbc":"bf-cbc","aes256-cbc":"aes-256-cbc","aes192-cbc":"aes-192-cbc","aes128-cbc":"aes-128-cbc","idea-cbc":"idea-cbc","cast128-cbc":"cast-cbc","rijndael-cbc@lysator.liu.se":"aes-256-cbc",arcfour128:"rc4",arcfour256:"rc4",arcfour512:"rc4",arcfour:"rc4","camellia128-cbc":"camellia-128-cbc","camellia192-cbc":"camellia-192-cbc","camellia256-cbc":"camellia-256-cbc","camellia128-cbc@openssh.com":"camellia-128-cbc","camellia192-cbc@openssh.com":"camellia-192-cbc","camellia256-cbc@openssh.com":"camellia-256-cbc","3des-ctr":"des-ede3","blowfish-ctr":"bf-ecb","aes256-ctr":"aes-256-ctr","aes192-ctr":"aes-192-ctr","aes128-ctr":"aes-128-ctr","cast128-ctr":"cast5-ecb","camellia128-ctr":"camellia-128-ecb","camellia192-ctr":"camellia-192-ecb","camellia256-ctr":"camellia-256-ecb","camellia128-ctr@openssh.com":"camellia-128-ecb","camellia192-ctr@openssh.com":"camellia-192-ecb","camellia256-ctr@openssh.com":"camellia-256-ecb","hmac-sha1-96":"sha1","hmac-sha1":"sha1","hmac-sha2-256":"sha256","hmac-sha2-256-96":"sha256","hmac-sha2-512":"sha512","hmac-sha2-512-96":"sha512","hmac-md5-96":"md5","hmac-md5":"md5","hmac-ripemd160":"ripemd160"};var N=t.BUGS={BAD_DHGEX:1,OLD_EXIT:2,DYN_RPORT_BUG:4};t.BUGGY_IMPLS=[["Cisco-1.25",N.BAD_DHGEX],[/^[0-9.]+$/,N.OLD_EXIT],[/^OpenSSH_5\.\d+/,N.DYN_RPORT_BUG]]},18:function(e,t){e.exports=require("net")},19:function(e,t){e.exports=require("fs")},2:function(e,t){e.exports=require("crypto")},21:function(e,t){e.exports=require("zlib")},258:function(e,t,r){"undefined"!=typeof process&&"renderer"===process.type?e.exports=r(552):e.exports=r(554)},259:function(e,t,r){var i;function n(e){function r(){if(r.enabled){var e=r,n=+new Date,s=n-(i||n);e.diff=s,e.prev=i,e.curr=n,i=n;for(var o=new Array(arguments.length),a=0;a<o.length;a++)o[a]=arguments[a];o[0]=t.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var c=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,(function(r,i){if("%%"===r)return r;c++;var n=t.formatters[i];if("function"==typeof n){var s=o[c];r=n.call(e,s),o.splice(c,1),c--}return r})),t.formatArgs.call(e,o);var u=r.log||t.log||console.log.bind(console);u.apply(e,o)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var r,i=0;for(r in e)i=(i<<5)-i+e.charCodeAt(r),i|=0;return t.colors[Math.abs(i)%t.colors.length]}(e),"function"==typeof t.init&&t.init(r),r}(t=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length,n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var r,i;for(r=0,i=t.skips.length;r<i;r++)if(t.skips[r].test(e))return!1;for(r=0,i=t.names.length;r<i;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(553),t.names=[],t.skips=[],t.formatters={}},260:function(e,t,r){var i=r(558);e.exports={Ber:i,BerReader:i.Reader,BerWriter:i.Writer}},261:function(e,t,r){"use strict";var i,n=r(16),s=n.Buffer,o={};for(i in n)n.hasOwnProperty(i)&&"SlowBuffer"!==i&&"Buffer"!==i&&(o[i]=n[i]);var a=o.Buffer={};for(i in s)s.hasOwnProperty(i)&&"allocUnsafe"!==i&&"allocUnsafeSlow"!==i&&(a[i]=s[i]);if(o.Buffer.prototype=s.prototype,a.from&&a.from!==Uint8Array.from||(a.from=function(e,t,r){if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type '+typeof e);if(e&&void 0===e.length)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);return s(e,t,r)}),a.alloc||(a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError('The "size" argument must be of type number. Received type '+typeof e);if(e<0||e>=2*(1<<30))throw new RangeError('The value "'+e+'" is invalid for option "size"');var i=s(e);return t&&0!==t.length?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i}),!o.kStringMaxLength)try{o.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch(e){}o.constants||(o.constants={MAX_LENGTH:o.kMaxLength},o.kStringMaxLength&&(o.constants.MAX_STRING_LENGTH=o.kStringMaxLength)),e.exports=o},262:function(e,t){var r;t=e.exports=j,r="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var i=Number.MAX_SAFE_INTEGER||9007199254740991,n=t.re=[],s=t.src=[],o=0,a=o++;s[a]="0|[1-9]\\d*";var c=o++;s[c]="[0-9]+";var u=o++;s[u]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var f=o++;s[f]="("+s[a]+")\\.("+s[a]+")\\.("+s[a]+")";var h=o++;s[h]="("+s[c]+")\\.("+s[c]+")\\.("+s[c]+")";var p=o++;s[p]="(?:"+s[a]+"|"+s[u]+")";var l=o++;s[l]="(?:"+s[c]+"|"+s[u]+")";var d=o++;s[d]="(?:-("+s[p]+"(?:\\."+s[p]+")*))";var E=o++;s[E]="(?:-?("+s[l]+"(?:\\."+s[l]+")*))";var g=o++;s[g]="[0-9A-Za-z-]+";var m=o++;s[m]="(?:\\+("+s[g]+"(?:\\."+s[g]+")*))";var v=o++,w="v?"+s[f]+s[d]+"?"+s[m]+"?";s[v]="^"+w+"$";var y="[v=\\s]*"+s[h]+s[E]+"?"+s[m]+"?",_=o++;s[_]="^"+y+"$";var b=o++;s[b]="((?:<|>)?=?)";var B=o++;s[B]=s[c]+"|x|X|\\*";var S=o++;s[S]=s[a]+"|x|X|\\*";var U=o++;s[U]="[v=\\s]*("+s[S]+")(?:\\.("+s[S]+")(?:\\.("+s[S]+")(?:"+s[d]+")?"+s[m]+"?)?)?";var I=o++;s[I]="[v=\\s]*("+s[B]+")(?:\\.("+s[B]+")(?:\\.("+s[B]+")(?:"+s[E]+")?"+s[m]+"?)?)?";var A=o++;s[A]="^"+s[b]+"\\s*"+s[U]+"$";var T=o++;s[T]="^"+s[b]+"\\s*"+s[I]+"$";var N=o++;s[N]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var k=o++;s[k]="(?:~>?)";var R=o++;s[R]="(\\s*)"+s[k]+"\\s+",n[R]=new RegExp(s[R],"g");var C=o++;s[C]="^"+s[k]+s[U]+"$";var D=o++;s[D]="^"+s[k]+s[I]+"$";var O=o++;s[O]="(?:\\^)";var L=o++;s[L]="(\\s*)"+s[O]+"\\s+",n[L]=new RegExp(s[L],"g");var P=o++;s[P]="^"+s[O]+s[U]+"$";var H=o++;s[H]="^"+s[O]+s[I]+"$";var x=o++;s[x]="^"+s[b]+"\\s*("+y+")$|^$";var G=o++;s[G]="^"+s[b]+"\\s*("+w+")$|^$";var K=o++;s[K]="(\\s*)"+s[b]+"\\s*("+y+"|"+s[U]+")",n[K]=new RegExp(s[K],"g");var F=o++;s[F]="^\\s*("+s[U]+")\\s+-\\s+("+s[U]+")\\s*$";var M=o++;s[M]="^\\s*("+s[I]+")\\s+-\\s+("+s[I]+")\\s*$";var q=o++;s[q]="(<|>)?=?\\s*\\*";for(var W=0;W<35;W++)r(W,s[W]),n[W]||(n[W]=new RegExp(s[W]));function X(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof j)return e;if("string"!=typeof e)return null;if(e.length>256)return null;if(!(t.loose?n[_]:n[v]).test(e))return null;try{return new j(e,t)}catch(e){return null}}function j(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof j){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>256)throw new TypeError("version is longer than 256 characters");if(!(this instanceof j))return new j(e,t);r("SemVer",e,t),this.options=t,this.loose=!!t.loose;var s=e.trim().match(t.loose?n[_]:n[v]);if(!s)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<i)return t}return e})):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}t.parse=X,t.valid=function(e,t){var r=X(e,t);return r?r.version:null},t.clean=function(e,t){var r=X(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null},t.SemVer=j,j.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},j.prototype.toString=function(){return this.version},j.prototype.compare=function(e){return r("SemVer.compare",this.version,this.options,e),e instanceof j||(e=new j(e,this.options)),this.compareMain(e)||this.comparePre(e)},j.prototype.compareMain=function(e){return e instanceof j||(e=new j(e,this.options)),V(this.major,e.major)||V(this.minor,e.minor)||V(this.patch,e.patch)},j.prototype.comparePre=function(e){if(e instanceof j||(e=new j(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var i=this.prerelease[t],n=e.prerelease[t];if(r("prerelease compare",t,i,n),void 0===i&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===i)return-1;if(i!==n)return V(i,n)}while(++t)},j.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},t.inc=function(e,t,r,i){"string"==typeof r&&(i=r,r=void 0);try{return new j(e,r).inc(t,i).version}catch(e){return null}},t.diff=function(e,t){if(Z(e,t))return null;var r=X(e),i=X(t),n="";if(r.prerelease.length||i.prerelease.length){n="pre";var s="prerelease"}for(var o in r)if(("major"===o||"minor"===o||"patch"===o)&&r[o]!==i[o])return n+o;return s},t.compareIdentifiers=V;var z=/^[0-9]+$/;function V(e,t){var r=z.test(e),i=z.test(t);return r&&i&&(e=+e,t=+t),e===t?0:r&&!i?-1:i&&!r?1:e<t?-1:1}function Q(e,t,r){return new j(e,r).compare(new j(t,r))}function Y(e,t,r){return Q(e,t,r)>0}function $(e,t,r){return Q(e,t,r)<0}function Z(e,t,r){return 0===Q(e,t,r)}function J(e,t,r){return 0!==Q(e,t,r)}function ee(e,t,r){return Q(e,t,r)>=0}function te(e,t,r){return Q(e,t,r)<=0}function re(e,t,r,i){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return Z(e,r,i);case"!=":return J(e,r,i);case">":return Y(e,r,i);case">=":return ee(e,r,i);case"<":return $(e,r,i);case"<=":return te(e,r,i);default:throw new TypeError("Invalid operator: "+t)}}function ie(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof ie){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof ie))return new ie(e,t);r("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===ne?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}t.rcompareIdentifiers=function(e,t){return V(t,e)},t.major=function(e,t){return new j(e,t).major},t.minor=function(e,t){return new j(e,t).minor},t.patch=function(e,t){return new j(e,t).patch},t.compare=Q,t.compareLoose=function(e,t){return Q(e,t,!0)},t.rcompare=function(e,t,r){return Q(t,e,r)},t.sort=function(e,r){return e.sort((function(e,i){return t.compare(e,i,r)}))},t.rsort=function(e,r){return e.sort((function(e,i){return t.rcompare(e,i,r)}))},t.gt=Y,t.lt=$,t.eq=Z,t.neq=J,t.gte=ee,t.lte=te,t.cmp=re,t.Comparator=ie;var ne={};function se(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof se)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new se(e.raw,t);if(e instanceof ie)return new se(e.value,t);if(!(this instanceof se))return new se(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function oe(e){return!e||"x"===e.toLowerCase()||"*"===e}function ae(e,t,r,i,n,s,o,a,c,u,f,h,p){return((t=oe(r)?"":oe(i)?">="+r+".0.0":oe(n)?">="+r+"."+i+".0":">="+t)+" "+(a=oe(c)?"":oe(u)?"<"+(+c+1)+".0.0":oe(f)?"<"+c+"."+(+u+1)+".0":h?"<="+c+"."+u+"."+f+"-"+h:"<="+a)).trim()}function ce(e,t,i){for(var n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!i.includePrerelease){for(n=0;n<e.length;n++)if(r(e[n].semver),e[n].semver!==ne&&e[n].semver.prerelease.length>0){var s=e[n].semver;if(s.major===t.major&&s.minor===t.minor&&s.patch===t.patch)return!0}return!1}return!0}function ue(e,t,r){try{t=new se(t,r)}catch(e){return!1}return t.test(e)}function fe(e,t,r,i){var n,s,o,a,c;switch(e=new j(e,i),t=new se(t,i),r){case">":n=Y,s=te,o=$,a=">",c=">=";break;case"<":n=$,s=ee,o=Y,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(ue(e,t,i))return!1;for(var u=0;u<t.set.length;++u){var f=t.set[u],h=null,p=null;if(f.forEach((function(e){e.semver===ne&&(e=new ie(">=0.0.0")),h=h||e,p=p||e,n(e.semver,h.semver,i)?h=e:o(e.semver,p.semver,i)&&(p=e)})),h.operator===a||h.operator===c)return!1;if((!p.operator||p.operator===a)&&s(e,p.semver))return!1;if(p.operator===c&&o(e,p.semver))return!1}return!0}ie.prototype.parse=function(e){var t=this.options.loose?n[x]:n[G],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],"="===this.operator&&(this.operator=""),r[2]?this.semver=new j(r[2],this.options.loose):this.semver=ne},ie.prototype.toString=function(){return this.value},ie.prototype.test=function(e){return r("Comparator.test",e,this.options.loose),this.semver===ne||("string"==typeof e&&(e=new j(e,this.options)),re(e,this.operator,this.semver,this.options))},ie.prototype.intersects=function(e,t){if(!(e instanceof ie))throw new TypeError("a Comparator is required");var r;if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return r=new se(e.value,t),ue(this.value,r,t);if(""===e.operator)return r=new se(this.value,t),ue(e.semver,r,t);var i=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),n=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),s=this.semver.version===e.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=re(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=re(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return i||n||s&&o||a||c},t.Range=se,se.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},se.prototype.toString=function(){return this.range},se.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var i=t?n[M]:n[F];e=e.replace(i,ae),r("hyphen replace",e),e=e.replace(n[K],"$1$2$3"),r("comparator trim",e,n[K]),e=(e=(e=e.replace(n[R],"$1~")).replace(n[L],"$1^")).split(/\s+/).join(" ");var s=t?n[x]:n[G],o=e.split(" ").map((function(e){return function(e,t){return r("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){r("caret",e,t);var i=t.loose?n[H]:n[P];return e.replace(i,(function(t,i,n,s,o){var a;return r("caret",e,t,i,n,s,o),oe(i)?a="":oe(n)?a=">="+i+".0.0 <"+(+i+1)+".0.0":oe(s)?a="0"===i?">="+i+"."+n+".0 <"+i+"."+(+n+1)+".0":">="+i+"."+n+".0 <"+(+i+1)+".0.0":o?(r("replaceCaret pr",o),a="0"===i?"0"===n?">="+i+"."+n+"."+s+"-"+o+" <"+i+"."+n+"."+(+s+1):">="+i+"."+n+"."+s+"-"+o+" <"+i+"."+(+n+1)+".0":">="+i+"."+n+"."+s+"-"+o+" <"+(+i+1)+".0.0"):(r("no pr"),a="0"===i?"0"===n?">="+i+"."+n+"."+s+" <"+i+"."+n+"."+(+s+1):">="+i+"."+n+"."+s+" <"+i+"."+(+n+1)+".0":">="+i+"."+n+"."+s+" <"+(+i+1)+".0.0"),r("caret return",a),a}))}(e,t)})).join(" ")}(e,t),r("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var i=t.loose?n[D]:n[C];return e.replace(i,(function(t,i,n,s,o){var a;return r("tilde",e,t,i,n,s,o),oe(i)?a="":oe(n)?a=">="+i+".0.0 <"+(+i+1)+".0.0":oe(s)?a=">="+i+"."+n+".0 <"+i+"."+(+n+1)+".0":o?(r("replaceTilde pr",o),a=">="+i+"."+n+"."+s+"-"+o+" <"+i+"."+(+n+1)+".0"):a=">="+i+"."+n+"."+s+" <"+i+"."+(+n+1)+".0",r("tilde return",a),a}))}(e,t)})).join(" ")}(e,t),r("tildes",e),e=function(e,t){return r("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var i=t.loose?n[T]:n[A];return e.replace(i,(function(t,i,n,s,o,a){r("xRange",e,t,i,n,s,o,a);var c=oe(n),u=c||oe(s),f=u||oe(o);return"="===i&&f&&(i=""),c?t=">"===i||"<"===i?"<0.0.0":"*":i&&f?(u&&(s=0),o=0,">"===i?(i=">=",u?(n=+n+1,s=0,o=0):(s=+s+1,o=0)):"<="===i&&(i="<",u?n=+n+1:s=+s+1),t=i+n+"."+s+"."+o):u?t=">="+n+".0.0 <"+(+n+1)+".0.0":f&&(t=">="+n+"."+s+".0 <"+n+"."+(+s+1)+".0"),r("xRange return",t),t}))}(e,t)})).join(" ")}(e,t),r("xrange",e),e=function(e,t){return r("replaceStars",e,t),e.trim().replace(n[q],"")}(e,t),r("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(o=o.filter((function(e){return!!e.match(s)}))),o=o.map((function(e){return new ie(e,this.options)}),this)},se.prototype.intersects=function(e,t){if(!(e instanceof se))throw new TypeError("a Range is required");return this.set.some((function(r){return r.every((function(r){return e.set.some((function(e){return e.every((function(e){return r.intersects(e,t)}))}))}))}))},t.toComparators=function(e,t){return new se(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},se.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new j(e,this.options));for(var t=0;t<this.set.length;t++)if(ce(this.set[t],e,this.options))return!0;return!1},t.satisfies=ue,t.maxSatisfying=function(e,t,r){var i=null,n=null;try{var s=new se(t,r)}catch(e){return null}return e.forEach((function(e){s.test(e)&&(i&&-1!==n.compare(e)||(n=new j(i=e,r)))})),i},t.minSatisfying=function(e,t,r){var i=null,n=null;try{var s=new se(t,r)}catch(e){return null}return e.forEach((function(e){s.test(e)&&(i&&1!==n.compare(e)||(n=new j(i=e,r)))})),i},t.minVersion=function(e,t){e=new se(e,t);var r=new j("0.0.0");if(e.test(r))return r;if(r=new j("0.0.0-0"),e.test(r))return r;r=null;for(var i=0;i<e.set.length;++i){e.set[i].forEach((function(e){var t=new j(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":r&&!Y(r,t)||(r=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}))}if(r&&e.test(r))return r;return null},t.validRange=function(e,t){try{return new se(e,t).range||"*"}catch(e){return null}},t.ltr=function(e,t,r){return fe(e,t,"<",r)},t.gtr=function(e,t,r){return fe(e,t,">",r)},t.outside=fe,t.prerelease=function(e,t){var r=X(e,t);return r&&r.prerelease.length?r.prerelease:null},t.intersects=function(e,t,r){return e=new se(e,r),t=new se(t,r),e.intersects(t)},t.coerce=function(e){if(e instanceof j)return e;if("string"!=typeof e)return null;var t=e.match(n[N]);if(null==t)return null;return X(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}},263:function(e,t,r){var i=r(0).inherits,n=r(1).Duplex,s=r(1).Readable,o=r(1).Writable,a=r(162).constants.CHANNEL_EXTENDED_DATATYPE.STDERR,c=["CHANNEL_EOF","CHANNEL_CLOSE","CHANNEL_DATA","CHANNEL_EXTENDED_DATA","CHANNEL_WINDOW_ADJUST","CHANNEL_SUCCESS","CHANNEL_FAILURE","CHANNEL_REQUEST"],u=c.length;function f(e,t,r){var i={highWaterMark:1048576,allowHalfOpen:!r||r&&!1!==r.allowHalfOpen};this.allowHalfOpen=i.allowHalfOpen,n.call(this,i);var o=this,a=r&&r.server;this.server=a,this.type=e.type,this.subtype=void 0;var f,l,d,E,g,m=this.incoming=e.incoming,v=m.id,w=this.outgoing=e.outgoing,y=this._callbacks=[];this._client=t,this._hasX11=!1;var _=t._channels,b=t._sshstream;function B(){o._waitClientDrain&&(o._waitClientDrain=!1,o._waitWindow||(o._chunk?o._write(o._chunk,null,o._chunkcb):o._chunkcb?o._chunkcb():o._chunkErr?o.stderr._write(o._chunkErr,null,o._chunkcbErr):o._chunkcbErr&&o._chunkcbErr()))}function S(){o.eof(),(a||!a&&!o.allowHalfOpen)&&o.close(),o.writable=!1}function U(){o.readable=!1}t._sock.on("drain",B),b.once("CHANNEL_EOF:"+v,(function(){"closed"!==m.state&&"eof"!==m.state&&(m.state="eof",o.readable&&o.push(null),!a&&o.stderr.readable&&o.stderr.push(null))})).once("CHANNEL_CLOSE:"+v,(function(){if("closed"!==m.state){m.state="closed",o.readable&&o.push(null),a&&o.stderr.writable?o.stderr.end():!a&&o.stderr.readable&&o.stderr.push(null),"open"!==w.state&&"eof"!==w.state||o.close(),"closing"===w.state&&(w.state="closed"),delete _[v];var e=o._writableState;t._sock.removeListener("drain",B),e.ending||e.finished||o.end(),o._callbacks=[];for(var r=0;r<y.length;++r)y[r](!0);y=o._callbacks,a?o.readable?o.once("end",(function(){o.emit("close")})):o.emit("close"):(o.readable?o.once("end",(function(){null===f?o.emit("close",f,l,d,E,g):o.emit("close",f)})):null===f?o.emit("close",f,l,d,E,g):o.emit("close",f),o.stderr.readable?o.stderr.once("end",(function(){o.stderr.emit("close")})):o.stderr.emit("close"));for(r=0;r<u;++r)b.removeAllListeners(c[r]+":"+v)}})).on("CHANNEL_DATA:"+v,(function(e){0!==m.window&&(m.window-=e.length,o.push(e)?m.window<=524288&&h(o):o._waitChanDrain=!0)})).on("CHANNEL_WINDOW_ADJUST:"+v,(function(e){w.window+=e,o._waitWindow&&(o._waitWindow=!1,o._waitClientDrain||(o._chunk?o._write(o._chunk,null,o._chunkcb):o._chunkcb?o._chunkcb():o._chunkErr?o.stderr._write(o._chunkErr,null,o._chunkcbErr):o._chunkcbErr&&o._chunkcbErr()))})).on("CHANNEL_SUCCESS:"+v,(function(){a?(b._kalast=Date.now(),b._kacnt=0):t._resetKA(),y.length&&y.shift()(!1)})).on("CHANNEL_FAILURE:"+v,(function(){a?(b._kalast=Date.now(),b._kacnt=0):t._resetKA(),y.length&&y.shift()(!0)})).on("CHANNEL_REQUEST:"+v,(function(e){if(!a){if("exit-status"===e.request)return void o.emit("exit",f=e.code);if("exit-signal"===e.request)return void o.emit("exit",f=null,l="SIG"+e.signal,d=e.coredump,E=e.description,g=e.lang)}e.wantReply&&b.channelFailure(w.id)})),this.stdin=this.stdout=this,a?this.stderr=new p(this):(this.stderr=new s(i),this.stderr._read=function(e){o._waitChanDrain&&(o._waitChanDrain=!1,m.window<=524288&&h(o))},b.on("CHANNEL_EXTENDED_DATA:"+v,(function(e,t){0!==m.window&&(m.window-=t.length,o.stderr.push(t)?m.window<=524288&&h(o):o._waitChanDrain=!0)}))),this._waitClientDrain=!1,this._waitWindow=!1,this._waitChanDrain=!1,this._chunk=void 0,this._chunkcb=void 0,this._chunkErr=void 0,this._chunkcbErr=void 0,this.on("finish",S).on("prefinish",S),this.on("end",U).on("close",U)}function h(e){if("open"!==e.outgoing.state)return!0;var t=1048576-e.incoming.window;return t<=0||(e.incoming.window+=t,e._client._sshstream.channelWindowAdjust(e.outgoing.id,t))}function p(e){o.call(this,{highWaterMark:1048576}),this._channel=e}i(f,n),f.prototype.eof=function(){var e=!0,t=this.outgoing;return"open"===t.state&&(t.state="eof",e=this._client._sshstream.channelEOF(t.id)),e},f.prototype.close=function(){var e=!0,t=this.outgoing;return"open"!==t.state&&"eof"!==t.state||(t.state="closing",e=this._client._sshstream.channelClose(t.id)),e},f.prototype._read=function(e){this._waitChanDrain&&(this._waitChanDrain=!1,this.incoming.window<=524288&&h(this))},f.prototype._write=function(e,t,r){var i,n,s,o=this._client._sshstream,a=this.outgoing,c=a.packetSize,u=a.id,f=a.window,h=e.length,p=0;if("open"===a.state){for(;h-p>0&&f>0;)if((s=h-p)>f&&(s=f),s>c&&(s=c),i=o.channelData(u,e.slice(p,p+s)),p+=s,f-=s,!i){this._waitClientDrain=!0,this._chunk=void 0,this._chunkcb=r;break}if(a.window=f,h-p>0)return 0===f&&(this._waitWindow=!0),p>0?(n=new Buffer(h-p),e.copy(n,0,p),this._chunk=n):this._chunk=e,void(this._chunkcb=r);this._waitClientDrain||r()}},f.prototype.destroy=function(){this.end()},f.prototype.setWindow=function(e,t,r,i){if(this.server)throw new Error("Client-only method called in server mode");return"session"!==this.type||"shell"!==this.subtype&&"exec"!==this.subtype||!this.writable||"open"!==this.outgoing.state||this._client._sshstream.windowChange(this.outgoing.id,e,t,r,i)},f.prototype.signal=function(e){if(this.server)throw new Error("Client-only method called in server mode");return"session"!==this.type||!this.writable||"open"!==this.outgoing.state||this._client._sshstream.signal(this.outgoing.id,e)},f.prototype.exit=function(e,t,r){if(!this.server)throw new Error("Server-only method called in client mode");return"session"!==this.type||!this.writable||"open"!==this.outgoing.state||("number"==typeof e?this._client._sshstream.exitStatus(this.outgoing.id,e):this._client._sshstream.exitSignal(this.outgoing.id,e,t,r))},f.MAX_WINDOW=1048576,f.PACKET_SIZE=32768,i(p,o),p.prototype._write=function(e,t,r){var i,n,s,o=this._channel,c=o._client._sshstream,u=o.outgoing,f=u.packetSize,h=u.id,p=u.window,l=e.length,d=0;if("open"===o.outgoing.state){for(;l-d>0&&p>0;)if((s=l-d)>p&&(s=p),s>f&&(s=f),i=c.channelExtData(h,e.slice(d,d+s),a),d+=s,p-=s,!i){o._waitClientDrain=!0,o._chunkErr=void 0,o._chunkcbErr=r;break}if(u.window=p,l-d>0)return 0===p&&(o._waitWindow=!0),d>0?(n=new Buffer(l-d),e.copy(n,0,d),o._chunkErr=n):o._chunkErr=e,void(o._chunkcbErr=r);o._waitClientDrain||r()}},e.exports=f},32:function(e,t){e.exports=require("assert")},4:function(e,t){e.exports=require("events")},47:function(e,t){e.exports=require("path")},551:function(e,t,r){var i=r(18),n=r(258)("tunnel-ssh"),s=r(556),o=r(571),a=r(4),c=function(){};function u(e){var t,r=[],o=0;return(t=i.createServer((function(i){var a;o++,i.on("error",t.emit.bind(t,"error")),i.on("close",(function(){0===--o&&(e.keepAlive||setTimeout((function(){0===o&&t.close()}),2))})),t.emit("netConnection",i,t),(a=function(e,t){var r=new s;return t.on("close",r.end.bind(r)),r.on("ready",(function(){n("sshConnection:ready"),t.emit("sshConnection",r,t),r.forwardOut(e.srcHost,e.srcPort,e.dstHost,e.dstPort,(function(e,r){if(e)return t.emit("error",e),void n("Destination port:",e);n("sshStream:create"),t.emit("sshStream",r),t.pipe(r).pipe(t)}))})),r}(e,i)).on("error",t.emit.bind(t,"error")),i.on("sshStream",(function(e){e.on("error",(function(){t.close()}))})),r.push(a,i),a.connect(e)}))).on("close",(function(){r.forEach((function(e){e.end()}))})),t}e.exports=function(e,t){var r,i;t||(t=c);try{i=o(e),(r=u(i)).listen(i.localPort,i.localHost,(function(e){t(e,r)}))}catch(e){r=new a.EventEmitter,setImmediate((function(){t(e),r.emit("error",e)}))}return r}},552:function(e,t,r){function i(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=r(259)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),!r)return;var i="color: "+this.color;e.splice(1,0,i,"color: inherit");var n=0,s=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(s=n))})),e.splice(s,0,i)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())},553:function(e,t){var r=1e3,i=6e4,n=60*i,s=24*n;function o(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}e.exports=function(e,t){t=t||{};var a,c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var o=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"days":case"day":case"d":return o*s;case"hours":case"hour":case"hrs":case"hr":case"h":return o*n;case"minutes":case"minute":case"mins":case"min":case"m":return o*i;case"seconds":case"second":case"secs":case"sec":case"s":return o*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(e);if("number"===c&&!1===isNaN(e))return t.long?o(a=e,s,"day")||o(a,n,"hour")||o(a,i,"minute")||o(a,r,"second")||a+" ms":function(e){if(e>=s)return Math.round(e/s)+"d";if(e>=n)return Math.round(e/n)+"h";if(e>=i)return Math.round(e/i)+"m";if(e>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},554:function(e,t,r){var i=r(555),n=r(0);(t=e.exports=r(259)).init=function(e){e.inspectOpts={};for(var r=Object.keys(t.inspectOpts),i=0;i<r.length;i++)e.inspectOpts[r[i]]=t.inspectOpts[r[i]]},t.log=function(){return o.write(n.format.apply(n,arguments)+"\n")},t.formatArgs=function(e){var r=this.namespace;if(this.useColors){var i=this.color,n="  [3"+i+";1m"+r+" [0m";e[0]=n+e[0].split("\n").join("\n"+n),e.push("[3"+i+"m+"+t.humanize(this.diff)+"[0m")}else e[0]=(new Date).toUTCString()+" "+r+" "+e[0]},t.save=function(e){null==e?delete process.env.DEBUG:process.env.DEBUG=e},t.load=a,t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):i.isatty(s)},t.colors=[6,2,3,4,5,1],t.inspectOpts=Object.keys(process.env).filter((function(e){return/^debug_/i.test(e)})).reduce((function(e,t){var r=t.substring(6).toLowerCase().replace(/_([a-z])/g,(function(e,t){return t.toUpperCase()})),i=process.env[t];return i=!!/^(yes|on|true|enabled)$/i.test(i)||!/^(no|off|false|disabled)$/i.test(i)&&("null"===i?null:Number(i)),e[r]=i,e}),{});var s=parseInt(process.env.DEBUG_FD,10)||2;1!==s&&2!==s&&n.deprecate((function(){}),"except for stderr(2) and stdout(1), any other usage of DEBUG_FD is deprecated. Override debug.log if you want to use a different log function (https://git.io/debug_fd)")();var o=1===s?process.stdout:2===s?process.stderr:function(e){var t;switch(process.binding("tty_wrap").guessHandleType(e)){case"TTY":(t=new i.WriteStream(e))._type="tty",t._handle&&t._handle.unref&&t._handle.unref();break;case"FILE":var n=r(19);(t=new n.SyncWriteStream(e,{autoClose:!1}))._type="fs";break;case"PIPE":case"TCP":var s=r(18);(t=new s.Socket({fd:e,readable:!1,writable:!0})).readable=!1,t.read=null,t._type="pipe",t._handle&&t._handle.unref&&t._handle.unref();break;default:throw new Error("Implement me. Unknown stream file type!")}return t.fd=e,t._isStdio=!0,t}(s);function a(){return process.env.DEBUG}t.formatters.o=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts).split("\n").map((function(e){return e.trim()})).join(" ")},t.formatters.O=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts)},t.enable(a())},555:function(e,t){e.exports=require("tty")},556:function(e,t,r){var i=r(2),n=r(18).Socket,s=r(85).lookup,o=r(4).EventEmitter,a=r(0).inherits,c=i.getHashes(),u=r(162),f=u.SSH2Stream,h=u.SFTPStream,p=u.constants,l=p.BUGS,d=p.ALGORITHMS,E=u.utils.parseKey,g=u.utils.decryptKey,m=u.utils.genPublicKey,v=r(263),w=r(566),y=r(567),_=Math.pow(2,32)-1,b=/^OpenSSH_(?:(?![0-4])\d)|(?:\d{2,})/,B=function(e){};function S(){if(!(this instanceof S))return new S;o.call(this),this.config={host:void 0,port:void 0,forceIPv4:void 0,forceIPv6:void 0,keepaliveCountMax:void 0,keepaliveInterval:void 0,readyTimeout:void 0,username:void 0,password:void 0,privateKey:void 0,publicKey:void 0,tryKeyboard:void 0,agent:void 0,allowAgentFwd:void 0,hostHashAlgo:void 0,hostHashCb:void 0,strictVendor:void 0,debug:void 0},this._readyTimeout=void 0,this._channels=void 0,this._callbacks=void 0,this._forwarding=void 0,this._acceptX11=void 0,this._agentFwdEnabled=void 0,this._curChan=void 0,this._remoteVer=void 0,this._sshstream=void 0,this._sock=void 0,this._resetKA=void 0}function U(e,t,r,i){var n=I(e),s=v.MAX_WINDOW,o=v.PACKET_SIZE,a=!0;if(!1===n)return i(new Error("No free channels available"));"function"==typeof r&&(i=r,r={}),e._channels[n]=!0;var c=e._sshstream;return c.once("CHANNEL_OPEN_CONFIRMATION:"+n,u).once("CHANNEL_OPEN_FAILURE:"+n,f).once("CHANNEL_CLOSE:"+n,f),"session"===t?a=c.session(n,s,o):"direct-tcpip"===t?a=c.directTcpip(n,s,o,r):"direct-streamlocal@openssh.com"===t&&(a=c.openssh_directStreamLocal(n,s,o,r)),a;function u(r){c.removeListener("CHANNEL_OPEN_FAILURE:"+n,f),c.removeListener("CHANNEL_CLOSE:"+n,f);var a={type:t,incoming:{id:n,window:s,packetSize:o,state:"open"},outgoing:{id:r.sender,window:r.window,packetSize:r.packetSize,state:"open"}};i(void 0,new v(a,e))}function f(t){var r;c.removeListener("CHANNEL_OPEN_CONFIRMATION:"+n,u),c.removeListener("CHANNEL_OPEN_FAILURE:"+n,f),c.removeListener("CHANNEL_CLOSE:"+n,f),delete e._channels[n],t instanceof Error?r=t:"object"==typeof t&&null!==t?((r=new Error("(SSH) Channel open failure: "+t.description)).reason=t.reason,r.lang=t.lang):(r=new Error("(SSH) Channel open failure: server closed channel unexpectedly")).reason=r.lang="",i(r)}}function I(e){if(e._curChan<_)return++e._curChan;for(var t=0,r=e._channels;t<_;++t)if(!r[t])return t;return!1}function A(e,t,r){var n={single:!1,protocol:"MIT-MAGIC-COOKIE-1",cookie:i.randomBytes(16).toString("hex"),screen:"number"==typeof t?t:0};"function"==typeof t?r=t:"object"==typeof t&&("boolean"==typeof t.single&&(n.single=t.single),"number"==typeof t.screen&&(n.screen=t.screen));var s="function"==typeof r;return"open"!==e.outgoing.state?(s&&r(new Error("Channel is not open")),!0):(s&&e._callbacks.push((function(t){if(t)return r(!0!==t?t:new Error("Unable to request X11"));e._hasX11=!0,++e._client._acceptX11,e.once("close",(function(){e._client._acceptX11&&--e._client._acceptX11})),r()})),e._client._sshstream.x11Forward(e.outgoing.id,n,s))}function T(e,t,r){var i=24,n=80,s=640,o=480,a="vt100";"function"==typeof t?r=t:"object"==typeof t&&("number"==typeof t.rows&&(i=t.rows),"number"==typeof t.cols&&(n=t.cols),"number"==typeof t.width&&(s=t.width),"number"==typeof t.height&&(o=t.height),"string"==typeof t.term&&(a=t.term));var c="function"==typeof r;return"open"!==e.outgoing.state?(c&&r(new Error("Channel is not open")),!0):(c&&e._callbacks.push((function(e){if(e)return r(!0!==e?e:new Error("Unable to request a pseudo-terminal"));r()})),e._client._sshstream.pty(e.outgoing.id,i,n,o,s,a,null,c))}function N(e,t){var r="function"==typeof t;return"open"!==e.outgoing.state?(r&&t(new Error("Channel is not open")),!0):e._client._agentFwdEnabled?(r&&t(!1),!0):(e._client._agentFwdEnabled=!0,e._callbacks.push((function(i){if(i)return e._client._agentFwdEnabled=!1,void(r&&t(!0!==i?i:new Error("Unable to request agent forwarding")));r&&t()})),e._client._sshstream.openssh_agentForward(e.outgoing.id,!0))}function k(e,t,r){return"open"!==e.outgoing.state?(r(new Error("Channel is not open")),!0):(e._callbacks.push((function(i){if(i)return r(!0!==i?i:new Error("Unable to start subsystem: "+t));e.subtype="subsystem",r(void 0,e)})),e._client._sshstream.subsystem(e.outgoing.id,t,!0))}function R(e,t){try{return e.sign(t)}catch(e){return e}}a(S,o),S.prototype.connect=function(e){var t=this;if(this._sock&&this._sock.writable)return this.once("close",(function(){t.connect(e)})),void this.end();this.config.host=e.hostname||e.host||"localhost",this.config.port=e.port||22,this.config.forceIPv4=e.forceIPv4||!1,this.config.forceIPv6=e.forceIPv6||!1,this.config.keepaliveCountMax="number"==typeof e.keepaliveCountMax&&e.keepaliveCountMax>=0?e.keepaliveCountMax:3,this.config.keepaliveInterval="number"==typeof e.keepaliveInterval&&e.keepaliveInterval>0?e.keepaliveInterval:0,this.config.readyTimeout="number"==typeof e.readyTimeout&&e.readyTimeout>=0?e.readyTimeout:2e4;var r,o={kex:void 0,kexBuf:void 0,cipher:void 0,cipherBuf:void 0,serverHostKey:void 0,serverHostKeyBuf:void 0,hmac:void 0,hmacBuf:void 0,compress:void 0,compressBuf:void 0};if("object"==typeof e.algorithms&&null!==e.algorithms){var a,u;if(u=e.algorithms.kex,Array.isArray(u)&&u.length>0){for(a=d.SUPPORTED_KEX,r=0;r<u.length;++r)if(-1===a.indexOf(u[r]))throw new Error("Unsupported key exchange algorithm: "+u[r]);o.kex=u}if(u=e.algorithms.cipher,Array.isArray(u)&&u.length>0){for(a=d.SUPPORTED_CIPHER,r=0;r<u.length;++r)if(-1===a.indexOf(u[r]))throw new Error("Unsupported cipher algorithm: "+u[r]);o.cipher=u}if(u=e.algorithms.serverHostKey,Array.isArray(u)&&u.length>0){for(a=d.SUPPORTED_SERVER_HOST_KEY,r=0;r<u.length;++r)if(-1===a.indexOf(u[r]))throw new Error("Unsupported server host key algorithm: "+u[r]);o.serverHostKey=u}if(u=e.algorithms.hmac,Array.isArray(u)&&u.length>0){for(a=d.SUPPORTED_HMAC,r=0;r<u.length;++r)if(-1===a.indexOf(u[r]))throw new Error("Unsupported HMAC algorithm: "+u[r]);o.hmac=u}if(u=e.algorithms.compress,Array.isArray(u)&&u.length>0){for(a=d.SUPPORTED_COMPRESS,r=0;r<u.length;++r)if(-1===a.indexOf(u[r]))throw new Error("Unsupported compression algorithm: "+u[r]);o.compress=u}}void 0===o.compress&&(e.compress?(o.compress=["zlib@openssh.com","zlib"],"force"!==e.compress&&o.compress.push("none")):!1===e.compress&&(o.compress=["none"])),this.config.username=e.username||e.user,this.config.password="string"==typeof e.password?e.password:void 0,this.config.privateKey="string"==typeof e.privateKey||Buffer.isBuffer(e.privateKey)?e.privateKey:void 0,this.config.publicKey=void 0,this.config.localHostname="string"==typeof e.localHostname&&e.localHostname.length?e.localHostname:void 0,this.config.localUsername="string"==typeof e.localUsername&&e.localUsername.length?e.localUsername:void 0,this.config.tryKeyboard=!0===e.tryKeyboard,this.config.agent="string"==typeof e.agent&&e.agent.length?e.agent:void 0,this.config.allowAgentFwd=!0===e.agentForward&&void 0!==this.config.agent,this.config.strictVendor="boolean"!=typeof e.strictVendor||e.strictVendor;var h=this.config.debug="function"==typeof e.debug?e.debug:B;if("string"!=typeof this.config.username)throw new Error("Invalid username");if(!0===e.agentForward&&!this.config.allowAgentFwd)throw new Error("You must set a valid agent path to allow agent forwarding");var l=this._callbacks=[];if(this._channels={},this._forwarding={},this._acceptX11=0,this._agentFwdEnabled=!1,this._curChan=-1,this._remoteVer=void 0,this.config.privateKey){var y=E(this.config.privateKey);if(y instanceof Error)throw new Error("Cannot parse privateKey: "+y.message);if(!y.private)throw new Error("privateKey value does not contain a (valid) private key");if(y.encryption){if("string"!=typeof e.passphrase)throw new Error("Encrypted private key detected, but no passphrase given");g(y,e.passphrase)}this.config.privateKey=y,this.config.publicKey=m(y)}var _=this._sshstream=new f({algorithms:o,debug:h===B?void 0:h}),b=this._sock=e.sock||new n;this._sock.stderr&&this._sock.stderr.resume();var S,U=this.config.keepaliveInterval,A=this.config.keepaliveCountMax,T=0;function N(){if(++T>A){if(clearInterval(S),b.readable){var e=new Error("Keepalive timeout");e.level="client-timeout",t.emit("error",e),b.destroy()}}else b.writable?(l.push(k),_.ping()):clearInterval(S)}function k(){U>0&&(T=0,clearInterval(S),b.writable&&(S=setInterval(N,U)))}if(this._resetKA=k,_.on("USERAUTH_BANNER",(function(e){t.emit("banner",e)})),b.on("connect",(function(){h("DEBUG: Client: Connected"),t.emit("connect"),e.sock||_.pipe(b).pipe(_)})).on("timeout",(function(){t.emit("timeout")})).on("error",(function(e){clearTimeout(t._readyTimeout),e.level="client-socket",t.emit("error",e)})).on("end",(function(){_.unpipe(b),clearTimeout(t._readyTimeout),clearInterval(S),t.emit("end")})).on("close",(function(){_.unpipe(b),clearTimeout(t._readyTimeout),clearInterval(S),t.emit("close");var e=l,i=new Error("No response from server");for(l=t._callbacks=[],r=0;r<e.length;++r)e[r](i);var n=Object.keys(t._channels);for(t._channels={},r=0;r<n.length;++r)_.emit("CHANNEL_OPEN_FAILURE:"+n[r],i),_.emit("CHANNEL_CLOSE:"+n[r])})),_.on("drain",(function(){t.emit("drain")})).once("header",(function(e){t._remoteVer=e.versions.software,e.greeting&&t.emit("greeting",e.greeting)})).on("continue",(function(){t.emit("continue")})).on("error",(function(e){e.level="protocol",t.emit("error",e)})),"function"==typeof e.hostVerifier){if(-1===c.indexOf(e.hostHash))throw new Error("Invalid host hash algorithm: "+e.hostHash);var C=e.hostVerifier,D=i.createHash(e.hostHash);_.once("fingerprint",(function(e,t){D.update(e);var r=C(D.digest("hex"),t);void 0!==r&&t(r)}))}var O,L,P=[],H=0;function x(){if(!P.length){_.removeListener("USERAUTH_FAILURE",M),_.removeListener("USERAUTH_PK_OK",F);var e=new Error("All configured authentication methods failed");return e.level="client-authentication",t.emit("error",e),void(_.writable&&t.end())}switch(O=P.shift()){case"password":_.authPassword(t.config.username,t.config.password);break;case"publickey":_.authPK(t.config.username,t.config.publicKey),_.once("USERAUTH_PK_OK",F);break;case"hostbased":_.authHostbased(t.config.username,t.config.publicKey,t.config.localHostname,t.config.localUsername,(function(e,r){var n;switch(t.config.privateKey.fulltype){case"ssh-rsa":n="RSA-SHA1";break;case"ssh-dss":n="DSA-SHA1";break;case"ecdsa-sha2-nistp256":n="sha256";break;case"ecdsa-sha2-nistp384":n="sha384";break;case"ecdsa-sha2-nistp521":n="sha512"}var s=i.createSign(n);if(s.update(e),(s=R(s,t.config.privateKey.privateOrig))instanceof Error)return s.message="Error while signing data with privateKey: "+s.message,s.level="client-authentication",t.emit("error",s),x();r(s)}));break;case"agent":w(t.config.agent,(function(e,r){return e?(e.level="agent",t.emit("error",e),L=void 0,x()):0===r.length?(h("DEBUG: Agent: No keys stored in agent"),L=void 0,x()):(L=r,H=0,_.authPK(t.config.username,r[0]),void _.once("USERAUTH_PK_OK",F))}));break;case"keyboard-interactive":_.authKeyboard(t.config.username),_.on("USERAUTH_INFO_REQUEST",K);break;case"none":_.authNone(t.config.username)}}function G(){if("agent"===O){if(H>=L.length)return;++H>=L.length?(h("DEBUG: Agent: No more keys left to try"),h("DEBUG: Client: agent auth failed"),L=void 0,x()):(h("DEBUG: Agent: Trying key #"+(H+1)),_.authPK(t.config.username,L[H]),_.once("USERAUTH_PK_OK",F))}}function K(e,r,i,n){if(0===(Array.isArray(n)?n.length:0))return h("DEBUG: Client: Sending automatic USERAUTH_INFO_RESPONSE"),_.authInfoRes();t.emit("keyboard-interactive",e,r,i,n,(function(e){_.authInfoRes(e)}))}function F(){if("agent"===O){var e=L[H],r=e.readUInt32BE(0,!0),n=e.toString("ascii",4,4+r),s=n.slice(4);switch(n){case"ssh-rsa":case"ssh-dss":case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":break;default:return h("DEBUG: Agent: Skipping unsupported key type: "+n),G()}_.authPK(t.config.username,e,(function(r,i){w(t.config.agent,e,s,r,(function(e,r){if(e)e.level="agent",t.emit("error",e);else{var s=r.readUInt32BE(0,!0);if(4+s+4<r.length){if(r.toString("ascii",4,4+s)===n)return i(r.slice(4+s+4));(e=new Error("Agent key/signature type mismatch")).level="agent",t.emit("error",e)}}G()}))}))}else"publickey"===O&&_.authPK(t.config.username,t.config.publicKey,(function(e,r){var n;switch(t.config.privateKey.fulltype){case"ssh-rsa":n="RSA-SHA1";break;case"ssh-dss":n="DSA-SHA1";break;case"ecdsa-sha2-nistp256":n="sha256";break;case"ecdsa-sha2-nistp384":n="sha384";break;case"ecdsa-sha2-nistp521":n="sha512"}var s=i.createSign(n);if(s.update(e),(s=R(s,t.config.privateKey.privateOrig))instanceof Error)return s.message="Error while signing data with privateKey: "+s.message,s.level="client-authentication",t.emit("error",s),x();r(s)}))}function M(e,t){if(_.removeListener("USERAUTH_PK_OK",F),_.removeListener("USERAUTH_INFO_REQUEST",K),"agent"===O)return h("DEBUG: Client: Agent key #"+(H+1)+" failed"),G();h("DEBUG: Client: "+O+" auth failed"),x()}if(void 0!==this.config.password&&P.push("password"),void 0!==this.config.publicKey&&P.push("publickey"),void 0!==this.config.agent&&P.push("agent"),this.config.tryKeyboard&&P.push("keyboard-interactive"),void 0!==this.config.publicKey&&void 0!==this.config.localHostname&&void 0!==this.config.localUsername&&P.push("hostbased"),P.push("none"),_.once("USERAUTH_SUCCESS",(function(){P=void 0,_.removeListener("USERAUTH_FAILURE",M),_.removeListener("USERAUTH_INFO_REQUEST",K),k(),clearTimeout(t._readyTimeout),t.emit("ready")})).on("USERAUTH_FAILURE",M),_.once("ready",(function(){_.service("ssh-userauth"),_.once("SERVICE_ACCEPT",(function(e){"ssh-userauth"===e&&x()}))})),_.on("CHANNEL_OPEN",(function(e){!function(e,t){var r,i=!1;function n(){var r={type:t.type,incoming:{id:i,window:v.MAX_WINDOW,packetSize:v.PACKET_SIZE,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}},n=new v(r,e);return e._sshstream.channelOpenConfirm(t.sender,i,v.MAX_WINDOW,v.PACKET_SIZE),n}function s(){void 0===r&&(r=!1===i?p.CHANNEL_OPEN_FAILURE.RESOURCE_SHORTAGE:p.CHANNEL_OPEN_FAILURE.CONNECT_FAILED),e._sshstream.channelOpenFail(t.sender,r,"","")}if("forwarded-tcpip"===t.type||"x11"===t.type||"auth-agent@openssh.com"===t.type){var o="forwarded-tcpip"===t.type&&void 0===e._forwarding[t.data.destIP+":"+t.data.destPort]||"x11"===t.type&&0===e._acceptX11||"auth-agent@openssh.com"===t.type&&!e._agentFwdEnabled;o?(r=p.CHANNEL_OPEN_FAILURE.ADMINISTRATIVELY_PROHIBITED,e.config.debug("DEBUG: Client: Automatic rejection of incoming channel open: unexpected channel open for: "+t.type)):!1===(i=I(e))?(e.config.debug("DEBUG: Client: Automatic rejection of incoming channel open: no channels available"),o=!0):e._channels[i]=!0,o&&s(),!1!==i&&("forwarded-tcpip"===t.type?(0===t.data.destPort&&(t.data.destPort=e._forwarding[t.data.destIP+":"+t.data.destPort]),e.emit("tcp connection",t.data,n,s)):"x11"===t.type?e.emit("x11",t.data,n,s):w(e.config.agent,n,s))}else e.config.debug("DEBUG: Client: Automatic rejection of incoming channel open: unsupported type: "+t.type),r=p.CHANNEL_OPEN_FAILURE.UNKNOWN_CHANNEL_TYPE,s()}(t,e)})),_.on("REQUEST_SUCCESS",(function(e){l.length&&l.shift()(!1,e)})).on("REQUEST_FAILURE",(function(){l.length&&l.shift()(!0)})),_.on("GLOBAL_REQUEST",(function(e,t,r){t&&_.requestFailure()})),e.sock)z(),_.pipe(b).pipe(_);else{var q=this.config.host,W=this.config.forceIPv4,X=this.config.forceIPv6;function j(){z(),t._sock.connect(t.config.port,q),t._sock.setNoDelay(!0),t._sock.setMaxListeners(0),t._sock.setTimeout("number"==typeof e.timeout?e.timeout:0)}h("DEBUG: Client: Trying "+q+" on port "+this.config.port+" ..."),!W&&!X||W&&X?j():s(q,W?4:6,(function(e,r,i){if(e){var n=new Error("Error while looking up "+(W?"IPv4":"IPv6")+" address for host "+q+": "+e);return clearTimeout(t._readyTimeout),n.level="client-dns",t.emit("error",n),void t.emit("close")}q=r,j()}))}function z(){t.config.readyTimeout>0&&(t._readyTimeout=setTimeout((function(){var e=new Error("Timed out while waiting for handshake");e.level="client-timeout",t.emit("error",e),b.destroy()}),t.config.readyTimeout))}},S.prototype.end=function(){return!!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable)&&this._sshstream.disconnect()},S.prototype.destroy=function(){this._sock&&this._sock.destroy()},S.prototype.exec=function(e,t,r){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");"function"==typeof t&&(r=t,t={});var i=this;return U(this,"session",{allowHalfOpen:!1!==t.allowHalfOpen},(function(n,s){if(n)return r(n);var o=[];function a(e){if(e)return s.close(),r(e);o.length&&o.shift()()}(!0===i.config.allowAgentFwd||t&&!0===t.agentForward&&void 0!==i.config.agent)&&o.push((function(){N(s,a)})),"object"==typeof t&&("object"==typeof t.env&&function(e,t){if("open"!==e.outgoing.state)return!0;for(var r,i,n=!0,s=Object.keys(t||{}),o=0,a=s.length;o<a;++o)r=s[o],i=t[r],n=e._client._sshstream.env(e.outgoing.id,r,i,!1)}(s,t.env),"object"!=typeof t.pty&&!0!==t.pty||o.push((function(){T(s,t.pty,a)})),"object"!=typeof t.x11&&"number"!==t.x11&&!0!==t.x11||o.push((function(){A(s,t.x11,a)}))),o.push((function(){!function(e,t,r,i){if("open"!==e.outgoing.state)return i(new Error("Channel is not open")),!0;e._callbacks.push((function(t){if(t)return i(!0!==t?t:new Error("Unable to exec"));e.subtype="exec",e.allowHalfOpen=!1!==r.allowHalfOpen,i(void 0,e)})),e._client._sshstream.exec(e.outgoing.id,t,!0)}(s,e,t,r)})),o.shift()()}))},S.prototype.shell=function(e,t,r){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var i=this;return"function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),e&&void 0!==e.x11&&(t=e,e=void 0),U(this,"session",(function(n,s){if(n)return r(n);var o=[];function a(e){if(e)return s.close(),r(e);o.length&&o.shift()()}(!0===i.config.allowAgentFwd||t&&!0===t.agentForward&&void 0!==i.config.agent)&&o.push((function(){N(s,a)})),!1!==e&&o.push((function(){T(s,e,a)})),"object"==typeof t&&("object"!=typeof t.x11&&"number"!==t.x11&&!0!==t.x11||o.push((function(){A(s,t.x11,a)}))),o.push((function(){!function(e,t){if("open"!==e.outgoing.state)return t(new Error("Channel is not open")),!0;e._callbacks.push((function(r){if(r)return t(!0!==r?r:new Error("Unable to open shell"));e.subtype="shell",t(void 0,e)})),e._client._sshstream.shell(e.outgoing.id,!0)}(s,r)})),o.shift()()}))},S.prototype.subsys=function(e,t){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");return U(this,"session",(function(r,i){if(r)return t(r);k(i,e,(function(e,r){if(e)return t(e);t(void 0,r)}))}))},S.prototype.sftp=function(e){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var t=this;return U(this,"session",(function(r,i){if(r)return e(r);k(i,"sftp",(function(r,i){if(r)return e(r);var n=t._sshstream._state.incoming.identRaw,s={debug:t.config.debug},o=new h(s,n);function a(t){o.removeListener("ready",c),i.removeListener("exit",u),e(t)}function c(){o.removeListener("error",a),i.removeListener("exit",u),e(void 0,new y(o))}function u(t,r){var i;o.removeListener("ready",c),o.removeListener("error",a),i="number"==typeof t?"Received exit code "+t+" while establishing SFTP session":"Received signal "+r+" while establishing SFTP session";var n=new Error(i);n.code=t,n.signal=r,e(n)}o.once("error",a).once("ready",c).once("close",(function(){i.end()})),i.once("exit",u),o.pipe(i).pipe(o)}))}))},S.prototype.forwardIn=function(e,t,r){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var i=this,n="function"==typeof r;return n&&this._callbacks.push((function(n,s){if(n)return r(!0!==n?n:new Error("Unable to bind to "+e+":"+t));var o=t;0===t&&s&&s.length>=4&&(o=s.readUInt32BE(0,!0),i._sshstream.remoteBugs&l.DYN_RPORT_BUG||(t=o)),i._forwarding[e+":"+t]=o,r(void 0,o)})),this._sshstream.tcpipForward(e,t,n)},S.prototype.unforwardIn=function(e,t,r){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var i=this,n="function"==typeof r;return n&&this._callbacks.push((function(n){if(n)return r(!0!==n?n:new Error("Unable to unbind from "+e+":"+t));delete i._forwarding[e+":"+t],r()})),this._sshstream.cancelTcpipForward(e,t,n)},S.prototype.forwardOut=function(e,t,r,i,n){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");return U(this,"direct-tcpip",{srcIP:e,srcPort:t,dstIP:r,dstPort:i},n)},S.prototype.openssh_noMoreSessions=function(e){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var t="function"==typeof e;return!this.config.strictVendor||this.config.strictVendor&&b.test(this._remoteVer)?(t&&this._callbacks.push((function(t){if(t)return e(!0!==t?t:new Error("Unable to disable future sessions"));e()})),this._sshstream.openssh_noMoreSessions(t)):(t&&process.nextTick((function(){e(new Error("strictVendor enabled and server is not OpenSSH or compatible version"))})),!0)},S.prototype.openssh_forwardInStreamLocal=function(e,t){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var r="function"==typeof t;return!this.config.strictVendor||this.config.strictVendor&&b.test(this._remoteVer)?(r&&this._callbacks.push((function(r){if(r)return t(!0!==r?r:new Error("Unable to bind to "+e));t()})),this._sshstream.openssh_streamLocalForward(e,r)):(r&&process.nextTick((function(){t(new Error("strictVendor enabled and server is not OpenSSH or compatible version"))})),!0)},S.prototype.openssh_unforwardInStreamLocal=function(e,t){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var r="function"==typeof t;return!this.config.strictVendor||this.config.strictVendor&&b.test(this._remoteVer)?(r&&this._callbacks.push((function(r){if(r)return t(!0!==r?r:new Error("Unable to unbind on "+e));t()})),this._sshstream.openssh_cancelStreamLocalForward(e,r)):(r&&process.nextTick((function(){t(new Error("strictVendor enabled and server is not OpenSSH or compatible version"))})),!0)},S.prototype.openssh_forwardOutStreamLocal=function(e,t){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");return!this.config.strictVendor||this.config.strictVendor&&b.test(this._remoteVer)?U(this,"direct-streamlocal@openssh.com",{socketPath:e},t):(process.nextTick((function(){t(new Error("strictVendor enabled and server is not OpenSSH or compatible version"))})),!0)},S.Client=S,S.Server=r(568),S.utils=u.utils,S.SFTP_STATUS_CODE=h.STATUS_CODE,S.SFTP_OPEN_MODE=h.OPEN_MODE,e.exports=S},557:function(e,t,r){var i=r(1).Transform,n=r(1).Readable,s=r(1).Writable,o=r(19).constants||process.binding("constants"),a=r(0),c=a.inherits,u=a.isDate,f=r(4).EventEmitter.listenerCount,h=r(19),p=r(72).readString,l=r(72).readInt,d=1,E=2,g=4,m=8,v=2147483648,w={OK:0,EOF:1,NO_SUCH_FILE:2,PERMISSION_DENIED:3,FAILURE:4,BAD_MESSAGE:5,NO_CONNECTION:6,CONNECTION_LOST:7,OP_UNSUPPORTED:8};Object.keys(w).forEach((function(e){w[w[e]]=e}));var y={0:"No error",1:"End of file",2:"No such file or directory",3:"Permission denied",4:"Failure",5:"Bad message",6:"No connection",7:"Connection lost",8:"Operation unsupported"};N.STATUS_CODE=w;var _={INIT:1,OPEN:3,CLOSE:4,READ:5,WRITE:6,LSTAT:7,FSTAT:8,SETSTAT:9,FSETSTAT:10,OPENDIR:11,READDIR:12,REMOVE:13,MKDIR:14,RMDIR:15,REALPATH:16,STAT:17,RENAME:18,READLINK:19,SYMLINK:20,EXTENDED:200};Object.keys(_).forEach((function(e){_[_[e]]=e}));var b={VERSION:2,STATUS:101,HANDLE:102,DATA:103,NAME:104,ATTRS:105,EXTENDED:201};Object.keys(b).forEach((function(e){b[b[e]]=e}));var B={READ:1,WRITE:2,APPEND:4,CREAT:8,TRUNC:16,EXCL:32};N.OPEN_MODE=B;var S=Math.pow(2,32)-1,U=new Buffer([0,0,0,5,_.INIT,0,0,0,3]),I=new Buffer([0,0,0,5,b.VERSION,0,0,0,3]),A=/^SSH-2.0-(?:OpenSSH|dropbear)/;function T(e){}function N(e,t){"string"!=typeof e||t||(t=e,e=void 0),"object"==typeof e&&e||(e={}),i.call(this,{highWaterMark:"number"==typeof e.highWaterMark?e.highWaterMark:32768}),this.debug="function"==typeof e.debug?e.debug:T,this.server=!!e.server,this._isOpenSSH=t&&A.test(t),this._needContinue=!1,this._state={status:"packet_header",writeReqid:-1,pktLeft:void 0,pktHdrBuf:new Buffer(9),pktBuf:void 0,pktType:void 0,version:void 0,extensions:{},maxDataLen:this._isOpenSSH?260096:32768,requests:{}};var r=this;function n(){r.writable=!1,r._cleanup(!1)}this.on("end",(function(){r.readable=!1})).on("finish",n).on("prefinish",n),this.server||this.push(U)}function k(e,t,r,i,n,s){var o,a,c,u,f=64,p=32768;"function"==typeof n?s=n:"object"==typeof n&&("number"==typeof n.concurrency&&n.concurrency>0&&!isNaN(n.concurrency)&&(f=n.concurrency),"number"==typeof n.chunkSize&&n.chunkSize>0&&!isNaN(n.chunkSize)&&(p=n.chunkSize),"function"==typeof n.step&&(o=n.step),"string"!=typeof n.mode&&"number"!=typeof n.mode||(a=P(n.mode)));var l,d,E,g=0,m=0,v=0,w=0,y=!1,_=p*f;function b(r){if(!y){y=!0;var i,n=0;l||d?(i=function(){0==--n&&s(r)},l&&(e===h||e.writable)&&++n,d&&(t===h||t.writable)&&++n,l&&(e===h||e.writable)&&e.close(l,i),d&&(t===h||t.writable)&&t.close(d,i)):s(r)}}e.open(r,"r",(function(n,y){if(n)return b(n);l=y,e.fstat(l,(function n(y,B){if(y)return e!==h?void e.stat(r,(function(e,t){if(e)return b(y);n(null,t)})):b(y);c=B.size,t.open(i,"w",(function(r,n){if(r)return b(r);if(d=n,c<=0)return b();for(;_>c;){if(1===f){_=c;break}_-=p,--f}if((E=function(e){try{return new Buffer(e)}catch(e){return e}}(_))instanceof Error)return b(E);function y(r,i,n,a,u){if(r)return b(r);function f(r){if(r)return b(r);w+=i,o&&o(w,i,c),0==--v&&(w===c?t.close(d,(function(t){if(d=void 0,t)return b(t);e.close(l,(function(e){if(l=void 0,e)return b(e);s()}))})):S())}e===h?t.writeData(d,n,u||0,i,a,f):t.write(d,n,u||0,i,a,f)}function B(e,t){return function(r,i,n){y(r,i,n,t,e)}}function S(){for(;m<c&&v<f;)u=m+p>c?c-m:p,e===h?e.read(l,E,g,u,m,B(g,m)):e.readData(l,E,g,u,m,y),g+=u,m+=u,++v;g=0}void 0!==a?t.fchmod(d,a,(function e(r){r?t.chmod(i,a,(function(t){e()})):S()})):S()}))}))}))}function R(e,t,r,i,n,s,o){var a="function"==typeof o?o:void 0;e.writeData(t,r,i,n,s,(function(o,c){if(o)return e.close(t,(function(){a&&a(o)}));c===n?e.close(t,a):R(e,t,r,i+=c,n-=c,s+=c,a)}))}function C(e,t,r,i){var n=e.readUInt32BE(t,!0),s=new K;if(t+=4,n&d){var o=D(e,t,r,i);if(!1===o)return!1;s.size=o,t+=8}if(n&E){var a,c;if(!1===(a=l(e,t,this,i)))return!1;if(s.uid=a,!1===(c=l(e,t+=4,this,i)))return!1;s.gid=c,t+=4}if(n&g){var u=l(e,t,this,i);if(!1===u)return!1;s.mode=u,s.permissions=u,t+=4}if(n&m){var f,h;if(!1===(f=l(e,t,this,i)))return!1;if(s.atime=f,!1===(h=l(e,t+=4,this,i)))return!1;s.mtime=h,t+=4}if(n&v){var p=l(e,t,this,i);if(!1===p)return!1;t+=4;for(var w,y=0;y<p;++y){if(!1===(w=l(e,t,this,i)))return!1;t+=4+w}}return e._pos=t,s}function D(e,t,r,i){if(e.length-t<8)return r&&r._cleanup(i),!1;for(var n=0,s=t+8;t<s;++t)n*=256,n+=e[t];return e._pos=t,n}function O(e){var t=0,r=0,i=[],n=0;if("number"==typeof e.size){t|=d,r+=8;var s=new Array(8),o=e.size;for(n=7;n>=0;--n)s[n]=255&o,o/=256;i.push(s)}if("number"==typeof e.uid&&"number"==typeof e.gid&&(t|=E,r+=8,i.push([e.uid>>24&255,e.uid>>16&255,e.uid>>8&255,255&e.uid]),i.push([e.gid>>24&255,e.gid>>16&255,e.gid>>8&255,255&e.gid])),"number"==typeof e.permissions||"string"==typeof e.permissions||"number"==typeof e.mode||"string"==typeof e.mode){var a=P(e.mode||e.permissions);t|=g,r+=4,i.push([a>>24&255,a>>16&255,a>>8&255,255&a])}if(("number"==typeof e.atime||u(e.atime))&&("number"==typeof e.mtime||u(e.mtime))){var c=L(e.atime),f=L(e.mtime);t|=m,r+=8,i.push([c>>24&255,c>>16&255,c>>8&255,255&c]),i.push([f>>24&255,f>>16&255,f>>8&255,255&f])}return{flags:t,nbytes:r,bytes:i}}function L(e){if("number"==typeof e&&!isNaN(e))return e;if(u(e))return parseInt(e.getTime()/1e3,10);throw new Error("Cannot parse time: "+e)}function P(e){if("number"==typeof e&&!isNaN(e))return e;if("string"==typeof e)return P(parseInt(e,8));throw new Error("Cannot parse mode: "+e)}c(N,i),N.prototype.__read=i.prototype._read,N.prototype._read=function(e){return this._needContinue&&(this._needContinue=!1,this.emit("continue")),this.__read(e)},N.prototype.__push=i.prototype.push,N.prototype.push=function(e,t){if(!this.readable)return!1;null===e&&(this.readable=!1);var r=this.__push(e,t);return this._needContinue=!1===r,r},N.prototype._cleanup=function(e){var t=this._state;t.pktBuf=void 0;var r=t.requests,i=Object.keys(r),n=i.length;if(n){if(this.readable)for(var s,o=new Error("SFTP session ended early"),a=0;a<n;++a)(s=r[i[a]].cb)&&s(o);t.requests={}}this.readable&&this.push(null),this._readableState.endEmitted||this._readableState.flowing||this.resume(),!1!==e&&(this.debug("DEBUG[SFTP]: Parser: Malformed packet"),e&&e(new Error("Malformed packet")))},N.prototype._transform=function(e,t,r){for(var i,n,s,o=this._state,a=this.server,c=o.status,u=o.pktType,h=o.pktBuf,d=o.pktLeft,E=o.version,g=o.pktHdrBuf,m=o.requests,v=this.debug,B=e.length,S=0;;){if("discard"===c){if(!(d<=(n=B-S))){d-=n;break}S+=d,d=0,c="packet_header",i=h=void 0}else{if(void 0!==h){if(d<=(n=B-S)){e.copy(h,h.length-d,S,S+d),S+=d,d=0,i=h,h=void 0;continue}e.copy(h,h.length-d,S),d-=n;break}if("packet_header"===c)if(i){if(d=i.readUInt32BE(4,!0)-1,u=i[8],a){if(void 0===E&&u!==_.INIT)return v("DEBUG[SFTP]: Parser: Unexpected packet before init"),this._cleanup(!1),r(new Error("Unexpected packet before init"));if(void 0!==E&&u===_.INIT)v("DEBUG[SFTP]: Parser: Unexpected duplicate init"),c="bad_pkt";else{if(d>34e3)return v("DEBUG[SFTP]: Parser: "+(X="Packet length ("+d+") exceeds max length (34000)")),this._cleanup(!1),r(new Error(X));u===_.EXTENDED?c="bad_pkt":void 0===_[u]&&(v("DEBUG[SFTP]: Parser: Unsupported packet type: "+u),c="discard")}}else{if(void 0===E&&u!==b.VERSION)return v("DEBUG[SFTP]: Parser: Unexpected packet before version"),this._cleanup(!1),r(new Error("Unexpected packet before version"));void 0!==E&&u===b.VERSION?(v("DEBUG[SFTP]: Parser: Unexpected duplicate version"),c="bad_pkt"):void 0===b[u]&&(c="discard")}"bad_pkt"===c?(g.writeUInt32BE(d,0,!0),g[4]=u,d=4,h=g):(h=new Buffer(d),c="payload")}else d=5,h=g;else if("payload"===c){if(u===b.VERSION||u===_.INIT){if(!1===(E=o.version=l(i,0,this,r)))return;if(E<3)return this._cleanup(!1),r(new Error("Incompatible SFTP version: "+E));a&&this.push(I);var U,A,T=i.length;for(i._pos=4;i._pos<T;){if(!1===(U=p(i,i._pos,"ascii",this,r)))return;if(!1===(A=p(i,i._pos,"ascii",this,r)))return;o.extensions[U]?o.extensions[U].push(A):o.extensions[U]=[A]}this.emit("ready")}else{if(!1===(s=l(i,0,this,r)))return;var N,k,R,O;if(a){var L,P,H=_[u];if(v("DEBUG[SFTP]: Parser: Request: "+H),f(this,H)){if(u===_.OPEN){if(!1===(N=p(i,4,"utf8",this,r)))return;var x=l(i,i._pos,this,r);if(!1===x)return;if(!1===(k=C(i,i._pos+4,this,r)))return;this.emit(H,s,N,x,k)}else if(u===_.CLOSE||u===_.FSTAT||u===_.READDIR){if(!1===(R=p(i,4,this,r)))return;this.emit(H,s,R)}else if(u===_.READ){if(!1===(R=p(i,4,this,r)))return;if(!1===(L=D(i,i._pos,this,r)))return;var G=l(i,i._pos,this,r);if(!1===G)return;this.emit(H,s,R,L,G)}else if(u===_.WRITE){if(!1===(R=p(i,4,this,r)))return;if(!1===(L=D(i,i._pos,this,r)))return;if(!1===(O=p(i,i._pos,this,r)))return;this.emit(H,s,R,L,O)}else if(u===_.LSTAT||u===_.STAT||u===_.OPENDIR||u===_.REMOVE||u===_.RMDIR||u===_.REALPATH||u===_.READLINK){if(!1===(P=p(i,4,"utf8",this,r)))return;this.emit(H,s,P)}else if(u===_.SETSTAT||u===_.MKDIR){if(!1===(P=p(i,4,"utf8",this,r)))return;if(!1===(k=C(i,i._pos,this,r)))return;this.emit(H,s,P,k)}else if(u===_.FSETSTAT){if(!1===(R=p(i,4,this,r)))return;if(!1===(k=C(i,i._pos,this,r)))return;this.emit(H,s,R,k)}else if(u===_.RENAME||u===_.SYMLINK){var K,F;if(!1===(K=p(i,4,"utf8",this,r)))return;if(!1===(F=p(i,i._pos,"utf8",this,r)))return;u===_.SYMLINK&&this._isOpenSSH?this.emit(H,s,F,K):this.emit(H,s,K,F)}}else this.status(s,w.OP_UNSUPPORTED)}else{var M=m[s],q=M&&M.cb;if(v("DEBUG[SFTP]: Parser: Response: "+b[u]),M&&q)if(u===b.STATUS){var W=l(i,4,this,r);if(!1===W)return;if(W===w.OK)q();else{var X,j="";if(i.length>=12){if(!1===(X=p(i,8,"utf8",this,r)))return;if(i._pos+4<i.length&&!1===(j=p(i,i._pos,"ascii",this,r)))return}var z=new Error(X||y[W]||"Unknown status");z.code=W,z.lang=j,q(z)}}else if(u===b.HANDLE){if(!1===(R=p(i,4,this,r)))return;q(void 0,R)}else if(u===b.DATA)if(M.buffer){var V=l(i,4,this,r);if(!1===V)return;var Q=M.buffer.length;if(V>Q&&i.writeUInt32BE(Q,4,!0),!1===(O=p(i,4,M.buffer,this,r)))return;q(void 0,O,V)}else{if(!1===(O=p(i,4,this,r)))return;q(void 0,O)}else if(u===b.NAME){var Y=l(i,4,this,r);if(!1===Y)return;var $,Z=[];i._pos=8;for(var J=0;J<Y;++J){if(!1===(N=p(i,i._pos,"utf8",this,r)))return;if(!1===($=p(i,i._pos,"utf8",this,r)))return;if(!1===(k=C(i,i._pos,this,r)))return;Z.push({filename:N,longname:$,attrs:k})}q(void 0,Z)}else if(u===b.ATTRS){if(!1===(k=C(i,4,this,r)))return;q(void 0,k)}else if(u===b.EXTENDED){if(M.extended)switch(M.extended){case"statvfs@openssh.com":case"fstatvfs@openssh.com":var ee={f_bsize:void 0,f_frsize:void 0,f_blocks:void 0,f_bfree:void 0,f_bavail:void 0,f_files:void 0,f_ffree:void 0,f_favail:void 0,f_sid:void 0,f_flag:void 0,f_namemax:void 0};if(ee.f_bsize=D(i,4,this,r),!1===ee.f_bsize)return;if(ee.f_frsize=D(i,12,this,r),!1===ee.f_frsize)return;if(ee.f_blocks=D(i,20,this,r),!1===ee.f_blocks)return;if(ee.f_bfree=D(i,28,this,r),!1===ee.f_bfree)return;if(ee.f_bavail=D(i,36,this,r),!1===ee.f_bavail)return;if(ee.f_files=D(i,44,this,r),!1===ee.f_files)return;if(ee.f_ffree=D(i,52,this,r),!1===ee.f_ffree)return;if(ee.f_favail=D(i,60,this,r),!1===ee.f_favail)return;if(ee.f_sid=D(i,68,this,r),!1===ee.f_sid)return;if(ee.f_flag=D(i,76,this,r),!1===ee.f_flag)return;if(ee.f_namemax=D(i,84,this,r),!1===ee.f_namemax)return;q(void 0,ee)}q()}M&&delete m[s]}}c="packet_header",i=h=void 0}else if("bad_pkt"===c){if(a&&i[4]!==_.INIT){var te=i[4]===_.EXTENDED?w.OP_UNSUPPORTED:w.FAILURE;if(i[4]===_.INIT||i[4]===b.VERSION)return this._cleanup(r);if(!1===(s=l(i,5,this,r)))return;this.status(s,te)}d=i.readUInt32BE(0,!0)-5,c="discard"}}if(S>=B)break}o.status=c,o.pktType=u,o.pktBuf=h,o.pktLeft=d,o.version=E,r()},N.prototype.createReadStream=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");return new M(this,e,t)},N.prototype.createWriteStream=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");return new q(this,e,t)},N.prototype.open=function(e,t,r,i){if(this.server)throw new Error("Client-only method called in server mode");var n=this._state;"function"==typeof r&&(i=r,r=void 0);var s=G(t);if(null===s)throw new Error("Unknown flags string: "+t);var o=0,a=0;"string"!=typeof r&&"number"!=typeof r||(r={mode:r}),"object"==typeof r&&(o=(r=O(r)).flags,a=r.nbytes,r=r.bytes);var c=Buffer.byteLength(e),u=9,f=new Buffer(13+c+4+4+a);f.writeUInt32BE(f.length-4,0,!0),f[4]=_.OPEN;var h=n.writeReqid=(n.writeReqid+1)%S;if(f.writeUInt32BE(h,5,!0),f.writeUInt32BE(c,u,!0),f.write(e,u+=4,c,"utf8"),f.writeUInt32BE(s,u+=c,!0),f.writeUInt32BE(o,u+=4,!0),r&&o){u+=4;for(var p=0,l=r.length;p<l;++p)for(var d=0,E=r[p].length;d<E;++d)f[u++]=r[p][d]}return n.requests[h]={cb:i},this.debug("DEBUG[SFTP]: Outgoing: Writing OPEN"),this.push(f)},N.prototype.close=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");var r=this._state,i=e.length,n=9,s=new Buffer(13+i);s.writeUInt32BE(s.length-4,0,!0),s[4]=_.CLOSE;var o=r.writeReqid=(r.writeReqid+1)%S;return s.writeUInt32BE(o,5,!0),s.writeUInt32BE(i,n,!0),e.copy(s,n+=4),r.requests[o]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing CLOSE"),this.push(s)},N.prototype.readData=function(e,t,r,i,n,s){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(t))throw new Error("buffer is not a Buffer");if(r>=t.length)throw new Error("offset is out of bounds");if(r+i>t.length)throw new Error("length extends beyond buffer");if(null===n)throw new Error("null position currently unsupported");var o=this._state,a=e.length,c=9,u=n,f=new Buffer(13+a+8+4);f.writeUInt32BE(f.length-4,0,!0),f[4]=_.READ;var h=o.writeReqid=(o.writeReqid+1)%S;f.writeUInt32BE(h,5,!0),f.writeUInt32BE(a,c,!0),e.copy(f,c+=4),c+=a;for(var p=7;p>=0;--p)f[c+p]=255&u,u/=256;return f.writeUInt32BE(i,c+=8,!0),o.requests[h]={cb:function(e,t,r){if(e&&e.code!==w.EOF)return s(e);s(void 0,r||0,t,n)},buffer:t.slice(r,r+i)},this.debug("DEBUG[SFTP]: Outgoing: Writing READ"),this.push(f)},N.prototype.writeData=function(e,t,r,i,n,s){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(t))throw new Error("buffer is not a Buffer");if(r>t.length)throw new Error("offset is out of bounds");if(r+i>t.length)throw new Error("length extends beyond buffer");if(null===n)throw new Error("null position currently unsupported");var o=this,a=this._state;if(i){var c=i>a.maxDataLen?i-a.maxDataLen:0,u=n;c&&(i=a.maxDataLen);var f=e.length,h=9,p=new Buffer(13+f+8+4+i);p.writeUInt32BE(p.length-4,0,!0),p[4]=_.WRITE;var l=a.writeReqid=(a.writeReqid+1)%S;p.writeUInt32BE(l,5,!0),p.writeUInt32BE(f,h,!0),e.copy(p,h+=4),h+=f;for(var d=7;d>=0;--d)p[h+d]=255&n,n/=256;return p.writeUInt32BE(i,h+=8,!0),t.copy(p,h+=4,r,r+i),a.requests[l]={cb:function(n){n?s&&s(n):c?o.writeData(e,t,r+i,c,u+i,s):s&&s(void 0,r+i)}},this.debug("DEBUG[SFTP]: Outgoing: Writing WRITE"),this.push(p)}s&&process.nextTick((function(){s(void 0,0)}))},N.prototype.fastGet=function(e,t,r,i){if(this.server)throw new Error("Client-only method called in server mode");k(this,h,e,t,r,i)},N.prototype.fastPut=function(e,t,r,i){if(this.server)throw new Error("Client-only method called in server mode");k(h,this,e,t,r,i)},N.prototype.readFile=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i;"function"==typeof r?i=r:"function"==typeof t&&(i=t,t=void 0);var n=this;if("string"==typeof t)t={encoding:t,flag:"r"};else if(t){if("object"!=typeof t)throw new TypeError("Bad arguments")}else t={encoding:null,flag:"r"};var s,o,a,c=t.encoding;if(c&&!Buffer.isEncoding(c))throw new Error("Unknown encoding: "+c);var u,f=0,h=0,p=t.flag||"r";function l(){0===s?(o=new Buffer(8192),n.readData(u,o,0,8192,h,d)):n.readData(u,o,f,s-f,h,d)}function d(e,t){return e?n.close(u,(function(){return i&&i(e)})):0===t?E():(h+=t,f+=t,void(0!==s?f===s?E():l():(a.push(o.slice(0,t)),l())))}function E(){n.close(u,(function(e){return 0===s?o=Buffer.concat(a,f):f<s&&(o=o.slice(0,f)),c&&(o=o.toString(c)),i&&i(e,o)}))}this.open(e,p,438,(function(t,r){if(t)return i&&i(t);u=r,n.fstat(u,(function t(r,c){if(r)n.stat(e,(function(e,s){if(e)return n.close(u,(function(){i&&i(r)}));t(null,s)}));else{if(0===(s=c.size||0))return a=[],l();o=new Buffer(s),l()}}))}))},N.prototype.writeFile=function(e,t,r,i){if(this.server)throw new Error("Client-only method called in server mode");var n;"function"==typeof i?n=i:"function"==typeof r&&(n=r,r=void 0);var s=this;if("string"==typeof r)r={encoding:r,mode:438,flag:"w"};else if(r){if("object"!=typeof r)throw new TypeError("Bad arguments")}else r={encoding:"utf8",mode:438,flag:"w"};if(r.encoding&&!Buffer.isEncoding(r.encoding))throw new Error("Unknown encoding: "+r.encoding);var o=r.flag||"w";this.open(e,o,r.mode,(function(i,a){if(i)n&&n(i);else{var c=Buffer.isBuffer(t)?t:new Buffer(""+t,r.encoding||"utf8"),u=/a/.test(o)?null:0;if(null===u)return void s.fstat(a,(function t(r,i){r?s.stat(e,(function(e,i){if(e)return s.close(a,(function(){n&&n(r)}));t(null,i)})):R(s,a,c,0,c.length,i.size,n)}));R(s,a,c,0,c.length,u,n)}}))},N.prototype.appendFile=function(e,t,r,i){if(this.server)throw new Error("Client-only method called in server mode");var n;if("function"==typeof i?n=i:"function"==typeof r&&(n=r,r=void 0),"string"==typeof r)r={encoding:r,mode:438,flag:"a"};else if(r){if("object"!=typeof r)throw new TypeError("Bad arguments")}else r={encoding:"utf8",mode:438,flag:"a"};r.flag||(r=a._extend({flag:"a"},r)),this.writeFile(e,t,r,n)},N.prototype.exists=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");this.stat(e,(function(e){t&&t(!e)}))},N.prototype.unlink=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,i=Buffer.byteLength(e),n=9,s=new Buffer(13+i);s.writeUInt32BE(s.length-4,0,!0),s[4]=_.REMOVE;var o=r.writeReqid=(r.writeReqid+1)%S;return s.writeUInt32BE(o,5,!0),s.writeUInt32BE(i,n,!0),s.write(e,n+=4,i,"utf8"),r.requests[o]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing REMOVE"),this.push(s)},N.prototype.rename=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=this._state,n=Buffer.byteLength(e),s=Buffer.byteLength(t),o=9,a=new Buffer(13+n+4+s);a.writeUInt32BE(a.length-4,0,!0),a[4]=_.RENAME;var c=i.writeReqid=(i.writeReqid+1)%S;return a.writeUInt32BE(c,5,!0),a.writeUInt32BE(n,o,!0),a.write(e,o+=4,n,"utf8"),a.writeUInt32BE(s,o+=n,!0),a.write(t,o+=4,s,"utf8"),i.requests[c]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing RENAME"),this.push(a)},N.prototype.mkdir=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=0,n=0,s=this._state;"function"==typeof t&&(r=t,t=void 0),"object"==typeof t&&(i=(t=O(t)).flags,n=t.nbytes,t=t.bytes);var o=Buffer.byteLength(e),a=9,c=new Buffer(13+o+4+n);c.writeUInt32BE(c.length-4,0,!0),c[4]=_.MKDIR;var u=s.writeReqid=(s.writeReqid+1)%S;if(c.writeUInt32BE(u,5,!0),c.writeUInt32BE(o,a,!0),c.write(e,a+=4,o,"utf8"),c.writeUInt32BE(i,a+=o),i){a+=4;for(var f=0,h=t.length;f<h;++f)for(var p=0,l=t[f].length;p<l;++p)c[a++]=t[f][p]}return s.requests[u]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing MKDIR"),this.push(c)},N.prototype.rmdir=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,i=Buffer.byteLength(e),n=9,s=new Buffer(13+i);s.writeUInt32BE(s.length-4,0,!0),s[4]=_.RMDIR;var o=r.writeReqid=(r.writeReqid+1)%S;return s.writeUInt32BE(o,5,!0),s.writeUInt32BE(i,n,!0),s.write(e,n+=4,i,"utf8"),r.requests[o]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing RMDIR"),this.push(s)},N.prototype.readdir=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i,n=this._state;if("function"==typeof t&&(r=t,t={}),"object"!=typeof t&&(t={}),i=!t||!t.full,!Buffer.isBuffer(e)&&"string"!=typeof e)throw new Error("missing directory handle or path");if("string"==typeof e){var s=this,o=[],a=0;return this.opendir(e,(function e(i,n){if(i)return r(i);s.readdir(n,t,(function(t,i){var c=t&&t.code===w.EOF;if(t&&!c)return s.close(n,(function(){r(t)}));if(c)return s.close(n,(function(e){if(e)return r(e);r(void 0,o)}));for(var u=0,f=i.length;u<f;++u,++a)o[a]=i[u];e(void 0,n)}))}))}var c=e.length,u=9,f=new Buffer(13+c);f.writeUInt32BE(f.length-4,0,!0),f[4]=_.READDIR;var h=n.writeReqid=(n.writeReqid+1)%S;return f.writeUInt32BE(h,5,!0),f.writeUInt32BE(c,u,!0),e.copy(f,u+=4),n.requests[h]={cb:i?function(e,t){if(e)return r(e);for(var i=t.length-1;i>=0;--i)"."!==t[i].filename&&".."!==t[i].filename||t.splice(i,1);r(void 0,t)}:r},this.debug("DEBUG[SFTP]: Outgoing: Writing READDIR"),this.push(f)},N.prototype.fstat=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");var r=this._state,i=e.length,n=9,s=new Buffer(13+i);s.writeUInt32BE(s.length-4,0,!0),s[4]=_.FSTAT;var o=r.writeReqid=(r.writeReqid+1)%S;return s.writeUInt32BE(o,5,!0),s.writeUInt32BE(i,n,!0),e.copy(s,n+=4),r.requests[o]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing FSTAT"),this.push(s)},N.prototype.stat=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,i=Buffer.byteLength(e),n=9,s=new Buffer(13+i);s.writeUInt32BE(s.length-4,0,!0),s[4]=_.STAT;var o=r.writeReqid=(r.writeReqid+1)%S;return s.writeUInt32BE(o,5,!0),s.writeUInt32BE(i,n,!0),s.write(e,n+=4,i,"utf8"),r.requests[o]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing STAT"),this.push(s)},N.prototype.lstat=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,i=Buffer.byteLength(e),n=9,s=new Buffer(13+i);s.writeUInt32BE(s.length-4,0,!0),s[4]=_.LSTAT;var o=r.writeReqid=(r.writeReqid+1)%S;return s.writeUInt32BE(o,5,!0),s.writeUInt32BE(i,n,!0),s.write(e,n+=4,i,"utf8"),r.requests[o]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing LSTAT"),this.push(s)},N.prototype.opendir=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,i=Buffer.byteLength(e),n=9,s=new Buffer(13+i);s.writeUInt32BE(s.length-4,0,!0),s[4]=_.OPENDIR;var o=r.writeReqid=(r.writeReqid+1)%S;return s.writeUInt32BE(o,5,!0),s.writeUInt32BE(i,n,!0),s.write(e,n+=4,i,"utf8"),r.requests[o]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing OPENDIR"),this.push(s)},N.prototype.setstat=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=0,n=0,s=this._state;"object"==typeof t?(i=(t=O(t)).flags,n=t.nbytes,t=t.bytes):"function"==typeof t&&(r=t);var o=Buffer.byteLength(e),a=9,c=new Buffer(13+o+4+n);c.writeUInt32BE(c.length-4,0,!0),c[4]=_.SETSTAT;var u=s.writeReqid=(s.writeReqid+1)%S;if(c.writeUInt32BE(u,5,!0),c.writeUInt32BE(o,a,!0),c.write(e,a+=4,o,"utf8"),c.writeUInt32BE(i,a+=o),i){a+=4;for(var f=0,h=t.length;f<h;++f)for(var p=0,l=t[f].length;p<l;++p)c[a++]=t[f][p]}return s.requests[u]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing SETSTAT"),this.push(c)},N.prototype.fsetstat=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");var i=0,n=0,s=this._state;"object"==typeof t?(i=(t=O(t)).flags,n=t.nbytes,t=t.bytes):"function"==typeof t&&(r=t);var o=e.length,a=9,c=new Buffer(13+o+4+n);c.writeUInt32BE(c.length-4,0,!0),c[4]=_.FSETSTAT;var u=s.writeReqid=(s.writeReqid+1)%S;if(c.writeUInt32BE(u,5,!0),c.writeUInt32BE(o,a,!0),e.copy(c,a+=4),c.writeUInt32BE(i,a+=o),i){a+=4;for(var f=0,h=t.length;f<h;++f)for(var p=0,l=t[f].length;p<l;++p)c[a++]=t[f][p]}return s.requests[u]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing FSETSTAT"),this.push(c)},N.prototype.futimes=function(e,t,r,i){return this.fsetstat(e,{atime:L(t),mtime:L(r)},i)},N.prototype.utimes=function(e,t,r,i){return this.setstat(e,{atime:L(t),mtime:L(r)},i)},N.prototype.fchown=function(e,t,r,i){return this.fsetstat(e,{uid:t,gid:r},i)},N.prototype.chown=function(e,t,r,i){return this.setstat(e,{uid:t,gid:r},i)},N.prototype.fchmod=function(e,t,r){return this.fsetstat(e,{mode:t},r)},N.prototype.chmod=function(e,t,r){return this.setstat(e,{mode:t},r)},N.prototype.readlink=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,i=Buffer.byteLength(e),n=9,s=new Buffer(13+i);s.writeUInt32BE(s.length-4,0,!0),s[4]=_.READLINK;var o=r.writeReqid=(r.writeReqid+1)%S;return s.writeUInt32BE(o,5,!0),s.writeUInt32BE(i,n,!0),s.write(e,n+=4,i,"utf8"),r.requests[o]={cb:function(e,r){return e?t(e):r&&r.length?void t(void 0,r[0].filename):t(new Error("Response missing link info"))}},this.debug("DEBUG[SFTP]: Outgoing: Writing READLINK"),this.push(s)},N.prototype.symlink=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=this._state,n=Buffer.byteLength(t),s=Buffer.byteLength(e),o=9,a=new Buffer(13+n+4+s);a.writeUInt32BE(a.length-4,0,!0),a[4]=_.SYMLINK;var c=i.writeReqid=(i.writeReqid+1)%S;return a.writeUInt32BE(c,5,!0),this._isOpenSSH?(a.writeUInt32BE(s,o,!0),a.write(e,o+=4,s,"utf8"),a.writeUInt32BE(n,o+=s,!0),a.write(t,o+=4,n,"utf8")):(a.writeUInt32BE(n,o,!0),a.write(t,o+=4,n,"utf8"),a.writeUInt32BE(s,o+=n,!0),a.write(e,o+=4,s,"utf8")),i.requests[c]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing SYMLINK"),this.push(a)},N.prototype.realpath=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,i=Buffer.byteLength(e),n=9,s=new Buffer(13+i);s.writeUInt32BE(s.length-4,0,!0),s[4]=_.REALPATH;var o=r.writeReqid=(r.writeReqid+1)%S;return s.writeUInt32BE(o,5,!0),s.writeUInt32BE(i,n,!0),s.write(e,n+=4,i,"utf8"),r.requests[o]={cb:function(e,r){return e?t(e):r&&r.length?void t(void 0,r[0].filename):t(new Error("Response missing path info"))}},this.debug("DEBUG[SFTP]: Outgoing: Writing REALPATH"),this.push(s)},N.prototype.ext_openssh_rename=function(e,t,r){var i=this._state;if(this.server)throw new Error("Client-only method called in server mode");if(!i.extensions["posix-rename@openssh.com"]||-1===i.extensions["posix-rename@openssh.com"].indexOf("1"))throw new Error("Server does not support this extended request");var n=Buffer.byteLength(e),s=Buffer.byteLength(t),o=9,a=new Buffer(41+n+4+s);a.writeUInt32BE(a.length-4,0,!0),a[4]=_.EXTENDED;var c=i.writeReqid=(i.writeReqid+1)%S;return a.writeUInt32BE(c,5,!0),a.writeUInt32BE(24,o,!0),a.write("posix-rename@openssh.com",o+=4,24,"ascii"),a.writeUInt32BE(n,o+=24,!0),a.write(e,o+=4,n,"utf8"),a.writeUInt32BE(s,o+=n,!0),a.write(t,o+=4,s,"utf8"),i.requests[c]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing posix-rename@openssh.com"),this.push(a)},N.prototype.ext_openssh_statvfs=function(e,t){var r=this._state;if(this.server)throw new Error("Client-only method called in server mode");if(!r.extensions["statvfs@openssh.com"]||-1===r.extensions["statvfs@openssh.com"].indexOf("2"))throw new Error("Server does not support this extended request");var i=Buffer.byteLength(e),n=9,s=new Buffer(36+i);s.writeUInt32BE(s.length-4,0,!0),s[4]=_.EXTENDED;var o=r.writeReqid=(r.writeReqid+1)%S;return s.writeUInt32BE(o,5,!0),s.writeUInt32BE(19,n,!0),s.write("statvfs@openssh.com",n+=4,19,"ascii"),s.writeUInt32BE(i,n+=19,!0),s.write(e,n+=4,i,"utf8"),r.requests[o]={extended:"statvfs@openssh.com",cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing statvfs@openssh.com"),this.push(s)},N.prototype.ext_openssh_fstatvfs=function(e,t){var r=this._state;if(this.server)throw new Error("Client-only method called in server mode");if(!r.extensions["fstatvfs@openssh.com"]||-1===r.extensions["fstatvfs@openssh.com"].indexOf("2"))throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");var i=e.length,n=9,s=new Buffer(37+i);s.writeUInt32BE(s.length-4,0,!0),s[4]=_.EXTENDED;var o=r.writeReqid=(r.writeReqid+1)%S;return s.writeUInt32BE(o,5,!0),s.writeUInt32BE(20,n,!0),s.write("fstatvfs@openssh.com",n+=4,20,"ascii"),s.writeUInt32BE(i,n+=20,!0),s.write(e,n+=4,i,"utf8"),r.requests[o]={extended:"fstatvfs@openssh.com",cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing fstatvfs@openssh.com"),this.push(s)},N.prototype.ext_openssh_hardlink=function(e,t,r){var i=this._state;if(this.server)throw new Error("Client-only method called in server mode");if(!i.extensions["hardlink@openssh.com"]||-1===i.extensions["hardlink@openssh.com"].indexOf("1"))throw new Error("Server does not support this extended request");var n=Buffer.byteLength(e),s=Buffer.byteLength(t),o=9,a=new Buffer(37+n+4+s);a.writeUInt32BE(a.length-4,0,!0),a[4]=_.EXTENDED;var c=i.writeReqid=(i.writeReqid+1)%S;return a.writeUInt32BE(c,5,!0),a.writeUInt32BE(20,o,!0),a.write("hardlink@openssh.com",o+=4,20,"ascii"),a.writeUInt32BE(n,o+=20,!0),a.write(e,o+=4,n,"utf8"),a.writeUInt32BE(s,o+=n,!0),a.write(t,o+=4,s,"utf8"),i.requests[c]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing hardlink@openssh.com"),this.push(a)},N.prototype.ext_openssh_fsync=function(e,t){var r=this._state;if(this.server)throw new Error("Client-only method called in server mode");if(!r.extensions["fsync@openssh.com"]||-1===r.extensions["fsync@openssh.com"].indexOf("1"))throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");var i=e.length,n=9,s=new Buffer(34+i);s.writeUInt32BE(s.length-4,0,!0),s[4]=_.EXTENDED;var o=r.writeReqid=(r.writeReqid+1)%S;return s.writeUInt32BE(o,5,!0),s.writeUInt32BE(17,n,!0),s.write("fsync@openssh.com",n+=4,17,"ascii"),s.writeUInt32BE(i,n+=17,!0),s.write(e,n+=4,i,"utf8"),r.requests[o]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing fsync@openssh.com"),this.push(s)},N.prototype.status=function(e,t,r,i){if(!this.server)throw new Error("Server-only method called in client mode");if(!w[t]||"number"!=typeof t)throw new Error("Bad status code: "+t);r||(r=""),i||(i="");var n=Buffer.byteLength(r),s=Buffer.byteLength(i),o=new Buffer(17+n+4+s);return o.writeUInt32BE(o.length-4,0,!0),o[4]=b.STATUS,o.writeUInt32BE(e,5,!0),o.writeUInt32BE(t,9,!0),o.writeUInt32BE(n,13,!0),n&&o.write(r,17,n,"utf8"),o.writeUInt32BE(s,17+n,!0),s&&o.write(i,17+n+4,s,"ascii"),this.debug("DEBUG[SFTP]: Outgoing: Writing STATUS"),this.push(o)},N.prototype.handle=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");var r=t.length;if(r>256)throw new Error("handle too large (> 256 bytes)");var i=new Buffer(13+r);return i.writeUInt32BE(i.length-4,0,!0),i[4]=b.HANDLE,i.writeUInt32BE(e,5,!0),i.writeUInt32BE(r,9,!0),r&&t.copy(i,13),this.debug("DEBUG[SFTP]: Outgoing: Writing HANDLE"),this.push(i)},N.prototype.data=function(e,t,r){if(!this.server)throw new Error("Server-only method called in client mode");var i=Buffer.isBuffer(t);if(!i&&"string"!=typeof t)throw new Error("data is not a Buffer or string");i||r||(r="utf8");var n=i?t.length:Buffer.byteLength(t,r),s=new Buffer(13+n);return s.writeUInt32BE(s.length-4,0,!0),s[4]=b.DATA,s.writeUInt32BE(e,5,!0),s.writeUInt32BE(n,9,!0),n&&(i?t.copy(s,13):s.write(t,13,n,r)),this.debug("DEBUG[SFTP]: Outgoing: Writing DATA"),this.push(s)},N.prototype.name=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if(Array.isArray(t)||"object"!=typeof t){if(!Array.isArray(t))throw new Error("names is not an object or array")}else t=[t];var r,i,n,s,o,a,c,u,f,h,p,l,d=t.length,E=0,g=[];for(h=0;h<d;++h)n=(i=t[h])&&i.filename&&"string"==typeof i.filename?i.filename:"",E+=4+Buffer.byteLength(n),s=i&&i.longname&&"string"==typeof i.longname?i.longname:"",E+=4+Buffer.byteLength(s),"object"==typeof i.attrs?(E+=4+(r=O(i.attrs)).nbytes,g.push(r)):(E+=4,g.push(null));for((u=new Buffer(13+E)).writeUInt32BE(u.length-4,0,!0),u[4]=b.NAME,u.writeUInt32BE(e,5,!0),u.writeUInt32BE(d,9,!0),f=13,h=0;h<d;++h)if(n=(i=t[h])&&i.filename&&"string"==typeof i.filename?i.filename:"",a=Buffer.byteLength(n),u.writeUInt32BE(a,f,!0),f+=4,a&&(u.write(n,f,a,"utf8"),f+=a),s=i&&i.longname&&"string"==typeof i.longname?i.longname:"",a=Buffer.byteLength(s),u.writeUInt32BE(a,f,!0),f+=4,a&&(u.write(s,f,a,"utf8"),f+=a),o=g[h]){if(u.writeUInt32BE(o.flags,f,!0),f+=4,o.flags&&o.bytes){var m=o.bytes;for(p=0,a=m.length;p<a;++p)for(l=0,c=m[p].length;l<c;++l)u[f++]=m[p][l]}}else u.writeUInt32BE(0,f,!0),f+=4;return this.debug("DEBUG[SFTP]: Outgoing: Writing NAME"),this.push(u)},N.prototype.attrs=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if("object"!=typeof t)throw new Error("attrs is not an object");var r=O(t),i=new Buffer(13+r.nbytes),n=13;if(i.writeUInt32BE(i.length-4,0,!0),i[4]=b.ATTRS,i.writeUInt32BE(e,5,!0),i.writeUInt32BE(r.flags,9,!0),r.flags&&r.bytes)for(var s=r.bytes,o=0,a=s.length;o<a;++o)for(var c=0,u=s[o].length;c<u;++c)i[n++]=s[o][c];return this.debug("DEBUG[SFTP]: Outgoing: Writing ATTRS"),this.push(i)};var H={r:B.READ,"r+":B.READ|B.WRITE,w:B.TRUNC|B.CREAT|B.WRITE,wx:B.TRUNC|B.CREAT|B.WRITE|B.EXCL,xw:B.TRUNC|B.CREAT|B.WRITE|B.EXCL,"w+":B.TRUNC|B.CREAT|B.READ|B.WRITE,"wx+":B.TRUNC|B.CREAT|B.READ|B.WRITE|B.EXCL,"xw+":B.TRUNC|B.CREAT|B.READ|B.WRITE|B.EXCL,a:B.APPEND|B.CREAT|B.WRITE,ax:B.APPEND|B.CREAT|B.WRITE|B.EXCL,xa:B.APPEND|B.CREAT|B.WRITE|B.EXCL,"a+":B.APPEND|B.CREAT|B.READ|B.WRITE,"ax+":B.APPEND|B.CREAT|B.READ|B.WRITE|B.EXCL,"xa+":B.APPEND|B.CREAT|B.READ|B.WRITE|B.EXCL},x=Object.keys(H);function G(e){var t=H[e];return void 0!==t?t:null}function K(e){this.mode=e&&e.mode,this.permissions=this.mode,this.uid=e&&e.uid,this.gid=e&&e.gid,this.size=e&&e.size,this.atime=e&&e.atime,this.mtime=e&&e.mtime}N.stringToFlags=G,N.flagsToString=function(e){for(var t=0;t<x.length;++t){var r=x[t];if(H[r]===e)return r}return null},K.prototype._checkModeProperty=function(e){return(this.mode&o.S_IFMT)===e},K.prototype.isDirectory=function(){return this._checkModeProperty(o.S_IFDIR)},K.prototype.isFile=function(){return this._checkModeProperty(o.S_IFREG)},K.prototype.isBlockDevice=function(){return this._checkModeProperty(o.S_IFBLK)},K.prototype.isCharacterDevice=function(){return this._checkModeProperty(o.S_IFCHR)},K.prototype.isSymbolicLink=function(){return this._checkModeProperty(o.S_IFLNK)},K.prototype.isFIFO=function(){return this._checkModeProperty(o.S_IFIFO)},K.prototype.isSocket=function(){return this._checkModeProperty(o.S_IFSOCK)},N.Stats=K;var F;function M(e,t,r){if(!(this instanceof M))return new M(e,t,r);var i=this;if(void 0===r)r={};else if("string"==typeof r)r={encoding:r};else{if(null===r||"object"!=typeof r)throw new TypeError('"options" argument must be a string or an object');r=Object.create(r)}if(void 0===r.highWaterMark&&(r.highWaterMark=65536),n.call(this,r),this.path=t,this.handle=void 0===r.handle?null:r.handle,this.flags=void 0===r.flags?"r":r.flags,this.mode=void 0===r.mode?438:r.mode,this.start=void 0===r.start?void 0:r.start,this.end=void 0===r.end?void 0:r.end,this.autoClose=void 0===r.autoClose||r.autoClose,this.pos=0,this.sftp=e,void 0!==this.start){if("number"!=typeof this.start)throw new TypeError("start must be a Number");if(void 0===this.end)this.end=1/0;else if("number"!=typeof this.end)throw new TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.on("end",(function(){i.autoClose&&i.destroy()})),Buffer.isBuffer(this.handle)||this.open()}function q(e,t,r){if(!(this instanceof q))return new q(e,t,r);if(void 0===r)r={};else if("string"==typeof r)r={encoding:r};else{if(null===r||"object"!=typeof r)throw new TypeError('"options" argument must be a string or an object');r=Object.create(r)}if(s.call(this,r),this.path=t,this.handle=void 0===r.handle?null:r.handle,this.flags=void 0===r.flags?"w":r.flags,this.mode=void 0===r.mode?438:r.mode,this.start=void 0===r.start?void 0:r.start,this.autoClose=void 0===r.autoClose||r.autoClose,this.pos=0,this.bytesWritten=0,this.sftp=e,void 0!==this.start){if("number"!=typeof this.start)throw new TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}r.encoding&&this.setDefaultEncoding(r.encoding),Buffer.isBuffer(this.handle)||this.open(),this.once("finish",(function(){this.autoClose&&this.close()}))}c(M,n),M.prototype.open=function(){var e=this;this.sftp.open(this.path,this.flags,this.mode,(function(t,r){if(t)return e.emit("error",t),this.destroyed=this.closed=!0,void e.emit("close");e.handle=r,e.emit("open",r),e.read()}))},M.prototype._read=function(e){if(!Buffer.isBuffer(this.handle))return this.once("open",(function(){this._read(e)}));if(!this.destroyed){var t;(!F||F.length-F.used<128)&&(F=null,t=this._readableState.highWaterMark,(F=new Buffer(t)).used=0);var r=F,i=Math.min(F.length-F.used,e),n=F.used;if(void 0!==this.end&&(i=Math.min(this.end-this.pos+1,i)),i<=0)return this.push(null);var s=this;this.sftp.readData(this.handle,F,F.used,i,this.pos,(function(e,t){if(e)s.autoClose&&s.destroy(),s.emit("error",e);else{var i=null;t>0&&(i=r.slice(n,n+t)),s.push(i)}})),this.pos+=i,F.used+=i}},M.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,Buffer.isBuffer(this.handle)&&this.close())},M.prototype.close=function(e){var t=this;if(e&&this.once("close",e),this.closed||!Buffer.isBuffer(this.handle))return Buffer.isBuffer(this.handle)?process.nextTick(this.emit.bind(this,"close")):void this.once("open",r);function r(e){t.sftp.close(e||t.handle,(function(e){e?t.emit("error",e):t.emit("close")})),t.handle=null}this.closed=!0,r()},c(q,s),q.prototype.open=function(){var e=this;this.sftp.open(this.path,this.flags,this.mode,(function(t,r){if(t)return e.emit("error",t),void(e.autoClose&&(e.destroyed=e.closed=!0,e.emit("close")));e.handle=r,e.sftp.fchmod(r,e.mode,(function t(i){i?e.sftp.chmod(e.path,e.mode,(function(e){t()})):"a"!==e.flags[0]?e.emit("open",r):e.sftp.fstat(r,(function t(i,n){i?e.sftp.stat(e.path,(function(r,n){if(r)return e.destroy(),void e.emit("error",i);t(null,n)})):(e.pos=n.size,e.emit("open",r))}))}))}))},q.prototype._write=function(e,t,r){if(!Buffer.isBuffer(e))return this.emit("error",new Error("Invalid data"));if(!Buffer.isBuffer(this.handle))return this.once("open",(function(){this._write(e,t,r)}));var i=this;this.sftp.writeData(this.handle,e,0,e.length,this.pos,(function(e,t){if(e)return i.autoClose&&i.destroy(),r(e);i.bytesWritten+=t,r()})),this.pos+=e.length},q.prototype._writev=function(e,t){if(!Buffer.isBuffer(this.handle))return this.once("open",(function(){this._writev(e,t)}));for(var r=this.sftp,i=this.handle,n=e.length,s=this,o=0;o<e.length;++o){var a=e[o].chunk;r.writeData(i,a,0,a.length,this.pos,c),this.pos+=a.length}function c(e,r){if(e)return s.destroy(),t(e);s.bytesWritten+=r,0==--n&&t()}},q.prototype.destroy=M.prototype.destroy,q.prototype.close=M.prototype.close,q.prototype.destroySoon=q.prototype.end,e.exports=N},558:function(e,t,r){var i=r(163),n=r(164),s=r(559),o=r(560);for(var a in e.exports={Reader:s,Writer:o},n)n.hasOwnProperty(a)&&(e.exports[a]=n[a]);for(var c in i)i.hasOwnProperty(c)&&(e.exports[c]=i[c])},559:function(e,t,r){var i=r(32),n=r(261).Buffer,s=r(164),o=r(163).newInvalidAsn1Error;function a(e){if(!e||!n.isBuffer(e))throw new TypeError("data must be a node Buffer");this._buf=e,this._size=e.length,this._len=0,this._offset=0}Object.defineProperty(a.prototype,"length",{enumerable:!0,get:function(){return this._len}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){return this._offset}}),Object.defineProperty(a.prototype,"remain",{get:function(){return this._size-this._offset}}),Object.defineProperty(a.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}}),a.prototype.readByte=function(e){if(this._size-this._offset<1)return null;var t=255&this._buf[this._offset];return e||(this._offset+=1),t},a.prototype.peek=function(){return this.readByte(!0)},a.prototype.readLength=function(e){if(void 0===e&&(e=this._offset),e>=this._size)return null;var t=255&this._buf[e++];if(null===t)return null;if(128==(128&t)){if(0===(t&=127))throw o("Indefinite length not supported");if(t>4)throw o("encoding too long");if(this._size-e<t)return null;this._len=0;for(var r=0;r<t;r++)this._len=(this._len<<8)+(255&this._buf[e++])}else this._len=t;return e},a.prototype.readSequence=function(e){var t=this.peek();if(null===t)return null;if(void 0!==e&&e!==t)throw o("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var r=this.readLength(this._offset+1);return null===r?null:(this._offset=r,t)},a.prototype.readInt=function(){return this._readTag(s.Integer)},a.prototype.readBoolean=function(){return 0!==this._readTag(s.Boolean)},a.prototype.readEnumeration=function(){return this._readTag(s.Enumeration)},a.prototype.readString=function(e,t){e||(e=s.OctetString);var r=this.peek();if(null===r)return null;if(r!==e)throw o("Expected 0x"+e.toString(16)+": got 0x"+r.toString(16));var i=this.readLength(this._offset+1);if(null===i)return null;if(this.length>this._size-i)return null;if(this._offset=i,0===this.length)return t?n.alloc(0):"";var a=this._buf.slice(this._offset,this._offset+this.length);return this._offset+=this.length,t?a:a.toString("utf8")},a.prototype.readOID=function(e){e||(e=s.OID);var t=this.readString(e,!0);if(null===t)return null;for(var r=[],i=0,n=0;n<t.length;n++){var o=255&t[n];i<<=7,i+=127&o,0==(128&o)&&(r.push(i),i=0)}return i=r.shift(),r.unshift(i%40),r.unshift(i/40>>0),r.join(".")},a.prototype._readTag=function(e){i.ok(void 0!==e);var t=this.peek();if(null===t)return null;if(t!==e)throw o("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var r=this.readLength(this._offset+1);if(null===r)return null;if(this.length>4)throw o("Integer too long: "+this.length);if(this.length>this._size-r)return null;this._offset=r;for(var n=this._buf[this._offset],s=0,a=0;a<this.length;a++)s<<=8,s|=255&this._buf[this._offset++];return 128==(128&n)&&4!==a&&(s-=1<<8*a),s>>0},e.exports=a},560:function(e,t,r){var i=r(32),n=r(261).Buffer,s=r(164),o=r(163).newInvalidAsn1Error,a={size:1024,growthFactor:8};function c(e){var t,r;t=a,r=e||{},i.ok(t),i.equal(typeof t,"object"),i.ok(r),i.equal(typeof r,"object"),Object.getOwnPropertyNames(t).forEach((function(e){if(!r[e]){var i=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,i)}})),e=r,this._buf=n.alloc(e.size||1024),this._size=this._buf.length,this._offset=0,this._options=e,this._seq=[]}Object.defineProperty(c.prototype,"buffer",{get:function(){if(this._seq.length)throw o(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}}),c.prototype.writeByte=function(e){if("number"!=typeof e)throw new TypeError("argument must be a Number");this._ensure(1),this._buf[this._offset++]=e},c.prototype.writeInt=function(e,t){if("number"!=typeof e)throw new TypeError("argument must be a Number");"number"!=typeof t&&(t=s.Integer);for(var r=4;(0==(4286578688&e)||-8388608==(4286578688&e))&&r>1;)r--,e<<=8;if(r>4)throw o("BER ints cannot be > 0xffffffff");for(this._ensure(2+r),this._buf[this._offset++]=t,this._buf[this._offset++]=r;r-- >0;)this._buf[this._offset++]=(4278190080&e)>>>24,e<<=8},c.prototype.writeNull=function(){this.writeByte(s.Null),this.writeByte(0)},c.prototype.writeEnumeration=function(e,t){if("number"!=typeof e)throw new TypeError("argument must be a Number");return"number"!=typeof t&&(t=s.Enumeration),this.writeInt(e,t)},c.prototype.writeBoolean=function(e,t){if("boolean"!=typeof e)throw new TypeError("argument must be a Boolean");"number"!=typeof t&&(t=s.Boolean),this._ensure(3),this._buf[this._offset++]=t,this._buf[this._offset++]=1,this._buf[this._offset++]=e?255:0},c.prototype.writeString=function(e,t){if("string"!=typeof e)throw new TypeError("argument must be a string (was: "+typeof e+")");"number"!=typeof t&&(t=s.OctetString);var r=n.byteLength(e);this.writeByte(t),this.writeLength(r),r&&(this._ensure(r),this._buf.write(e,this._offset),this._offset+=r)},c.prototype.writeBuffer=function(e,t){if("number"!=typeof t)throw new TypeError("tag must be a number");if(!n.isBuffer(e))throw new TypeError("argument must be a buffer");this.writeByte(t),this.writeLength(e.length),this._ensure(e.length),e.copy(this._buf,this._offset,0,e.length),this._offset+=e.length},c.prototype.writeStringArray=function(e){if(!e instanceof Array)throw new TypeError("argument must be an Array[String]");var t=this;e.forEach((function(e){t.writeString(e)}))},c.prototype.writeOID=function(e,t){if("string"!=typeof e)throw new TypeError("argument must be a string");if("number"!=typeof t&&(t=s.OID),!/^([0-9]+\.){3,}[0-9]+$/.test(e))throw new Error("argument is not a valid OID string");var r=e.split("."),i=[];i.push(40*parseInt(r[0],10)+parseInt(r[1],10)),r.slice(2).forEach((function(e){!function(e,t){t<128?e.push(t):t<16384?(e.push(t>>>7|128),e.push(127&t)):t<2097152?(e.push(t>>>14|128),e.push(255&(t>>>7|128)),e.push(127&t)):t<268435456?(e.push(t>>>21|128),e.push(255&(t>>>14|128)),e.push(255&(t>>>7|128)),e.push(127&t)):(e.push(255&(t>>>28|128)),e.push(255&(t>>>21|128)),e.push(255&(t>>>14|128)),e.push(255&(t>>>7|128)),e.push(127&t))}(i,parseInt(e,10))}));var n=this;this._ensure(2+i.length),this.writeByte(t),this.writeLength(i.length),i.forEach((function(e){n.writeByte(e)}))},c.prototype.writeLength=function(e){if("number"!=typeof e)throw new TypeError("argument must be a Number");if(this._ensure(4),e<=127)this._buf[this._offset++]=e;else if(e<=255)this._buf[this._offset++]=129,this._buf[this._offset++]=e;else if(e<=65535)this._buf[this._offset++]=130,this._buf[this._offset++]=e>>8,this._buf[this._offset++]=e;else{if(!(e<=16777215))throw o("Length too long (> 4 bytes)");this._buf[this._offset++]=131,this._buf[this._offset++]=e>>16,this._buf[this._offset++]=e>>8,this._buf[this._offset++]=e}},c.prototype.startSequence=function(e){"number"!=typeof e&&(e=s.Sequence|s.Constructor),this.writeByte(e),this._seq.push(this._offset),this._ensure(3),this._offset+=3},c.prototype.endSequence=function(){var e=this._seq.pop(),t=e+3,r=this._offset-t;if(r<=127)this._shift(t,r,-2),this._buf[e]=r;else if(r<=255)this._shift(t,r,-1),this._buf[e]=129,this._buf[e+1]=r;else if(r<=65535)this._buf[e]=130,this._buf[e+1]=r>>8,this._buf[e+2]=r;else{if(!(r<=16777215))throw o("Sequence too long");this._shift(t,r,1),this._buf[e]=131,this._buf[e+1]=r>>16,this._buf[e+2]=r>>8,this._buf[e+3]=r}},c.prototype._shift=function(e,t,r){i.ok(void 0!==e),i.ok(void 0!==t),i.ok(r),this._buf.copy(this._buf,e+r,e,e+t),this._offset+=r},c.prototype._ensure=function(e){if(i.ok(e),this._size-this._offset<e){var t=this._size*this._options.growthFactor;t-this._offset<e&&(t+=e);var r=n.alloc(t);this._buf.copy(r,0,0,this._offset),this._buf=r,this._size=t}},e.exports=c},561:function(e,t){function r(e,t,r){null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function i(){return new r(null)}r.prototype.am=function(e,t,r,i,n,s){for(var o=16383&t,a=t>>14;--s>=0;){var c=16383&this[e],u=this[e++]>>14,f=a*c+u*o;n=((c=o*c+((16383&f)<<14)+r[i]+n)>>28)+(f>>14)+a*u,r[i++]=268435455&c}return n},r.prototype.DB=28,r.prototype.DM=268435455,r.prototype.DV=1<<28;r.prototype.FV=Math.pow(2,52),r.prototype.F1=24,r.prototype.F2=4;var n,s,o=new Array;for(n="0".charCodeAt(0),s=0;s<=9;++s)o[n++]=s;for(n="a".charCodeAt(0),s=10;s<36;++s)o[n++]=s;for(n="A".charCodeAt(0),s=10;s<36;++s)o[n++]=s;function a(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function c(e,t){var r=o[e.charCodeAt(t)];return null==r?-1:r}function u(e){var t=i();return t.fromInt(e),t}function f(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function h(e){this.m=e}function p(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function l(e,t){return e&t}function d(e,t){return e|t}function E(e,t){return e^t}function g(e,t){return e&~t}function m(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function v(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function w(){}function y(e){return e}function _(e){this.r2=i(),this.q3=i(),r.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}h.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},h.prototype.revert=function(e){return e},h.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},h.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},h.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},p.prototype.convert=function(e){var t=i();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(r.ZERO)>0&&this.m.subTo(t,t),t},p.prototype.revert=function(e){var t=i();return e.copyTo(t),this.reduce(t),t},p.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e[t],i=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[r=t+this.m.t]+=this.m.am(0,i,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},p.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},p.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},r.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},r.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},r.prototype.fromString=function(e,t){var i;if(16==t)i=4;else if(8==t)i=3;else if(256==t)i=8;else if(2==t)i=1;else if(32==t)i=5;else{if(4!=t)return void this.fromRadix(e,t);i=2}this.t=0,this.s=0;for(var n=e.length,s=!1,o=0;--n>=0;){var a=8==i?255&e[n]:c(e,n);a<0?"-"==e.charAt(n)&&(s=!0):(s=!1,0==o?this[this.t++]=a:o+i>this.DB?(this[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this[this.t++]=a>>this.DB-o):this[this.t-1]|=a<<o,(o+=i)>=this.DB&&(o-=this.DB))}8==i&&0!=(128&e[0])&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),s&&r.ZERO.subTo(this,this)},r.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},r.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s},r.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s},r.prototype.lShiftTo=function(e,t){var r,i=e%this.DB,n=this.DB-i,s=(1<<n)-1,o=Math.floor(e/this.DB),a=this.s<<i&this.DM;for(r=this.t-1;r>=0;--r)t[r+o+1]=this[r]>>n|a,a=(this[r]&s)<<i;for(r=o-1;r>=0;--r)t[r]=0;t[o]=a,t.t=this.t+o+1,t.s=this.s,t.clamp()},r.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var i=e%this.DB,n=this.DB-i,s=(1<<i)-1;t[0]=this[r]>>i;for(var o=r+1;o<this.t;++o)t[o-r-1]|=(this[o]&s)<<n,t[o-r]=this[o]>>i;i>0&&(t[this.t-r-1]|=(this.s&s)<<n),t.t=this.t-r,t.clamp()}},r.prototype.subTo=function(e,t){for(var r=0,i=0,n=Math.min(e.t,this.t);r<n;)i+=this[r]-e[r],t[r++]=i&this.DM,i>>=this.DB;if(e.t<this.t){for(i-=e.s;r<this.t;)i+=this[r],t[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<e.t;)i-=e[r],t[r++]=i&this.DM,i>>=this.DB;i-=e.s}t.s=i<0?-1:0,i<-1?t[r++]=this.DV+i:i>0&&(t[r++]=i),t.t=r,t.clamp()},r.prototype.multiplyTo=function(e,t){var i=this.abs(),n=e.abs(),s=i.t;for(t.t=s+n.t;--s>=0;)t[s]=0;for(s=0;s<n.t;++s)t[s+i.t]=i.am(0,n[s],t,s,0,i.t);t.s=0,t.clamp(),this.s!=e.s&&r.ZERO.subTo(t,t)},r.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var i=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,i,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()},r.prototype.divRemTo=function(e,t,n){var s=e.abs();if(!(s.t<=0)){var o=this.abs();if(o.t<s.t)return null!=t&&t.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=i());var a=i(),c=this.s,u=e.s,h=this.DB-f(s[s.t-1]);h>0?(s.lShiftTo(h,a),o.lShiftTo(h,n)):(s.copyTo(a),o.copyTo(n));var p=a.t,l=a[p-1];if(0!=l){var d=l*(1<<this.F1)+(p>1?a[p-2]>>this.F2:0),E=this.FV/d,g=(1<<this.F1)/d,m=1<<this.F2,v=n.t,w=v-p,y=null==t?i():t;for(a.dlShiftTo(w,y),n.compareTo(y)>=0&&(n[n.t++]=1,n.subTo(y,n)),r.ONE.dlShiftTo(p,y),y.subTo(a,a);a.t<p;)a[a.t++]=0;for(;--w>=0;){var _=n[--v]==l?this.DM:Math.floor(n[v]*E+(n[v-1]+m)*g);if((n[v]+=a.am(0,_,n,w,0,p))<_)for(a.dlShiftTo(w,y),n.subTo(y,n);n[v]<--_;)n.subTo(y,n)}null!=t&&(n.drShiftTo(p,t),c!=u&&r.ZERO.subTo(t,t)),n.t=p,n.clamp(),h>0&&n.rShiftTo(h,n),c<0&&r.ZERO.subTo(n,n)}}},r.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},r.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},r.prototype.exp=function(e,t){if(e>4294967295||e<1)return r.ONE;var n=i(),s=i(),o=t.convert(this),a=f(e)-1;for(o.copyTo(n);--a>=0;)if(t.sqrTo(n,s),(e&1<<a)>0)t.mulTo(s,o,n);else{var c=n;n=s,s=c}return t.revert(n)},r.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,i=(1<<t)-1,n=!1,s="",o=this.t,c=this.DB-o*this.DB%t;if(o-- >0)for(c<this.DB&&(r=this[o]>>c)>0&&(n=!0,s=a(r));o>=0;)c<t?(r=(this[o]&(1<<c)-1)<<t-c,r|=this[--o]>>(c+=this.DB-t)):(r=this[o]>>(c-=t)&i,c<=0&&(c+=this.DB,--o)),r>0&&(n=!0),n&&(s+=a(r));return n?s:"0"},r.prototype.negate=function(){var e=i();return r.ZERO.subTo(this,e),e},r.prototype.abs=function(){return this.s<0?this.negate():this},r.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this[r]-e[r]))return t;return 0},r.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+f(this[this.t-1]^this.s&this.DM)},r.prototype.mod=function(e){var t=i();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(r.ZERO)>0&&e.subTo(t,t),t},r.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new h(t):new p(t),this.exp(e,r)},r.ZERO=u(0),r.ONE=u(1),w.prototype.convert=y,w.prototype.revert=y,w.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},w.prototype.sqrTo=function(e,t){e.squareTo(t)},_.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=i();return e.copyTo(t),this.reduce(t),t},_.prototype.revert=function(e){return e},_.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},_.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},_.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var b=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],B=(1<<26)/b[b.length-1];r.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},r.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=u(r),s=i(),o=i(),a="";for(this.divRemTo(n,s,o);s.signum()>0;)a=(r+o.intValue()).toString(e).substr(1)+a,s.divRemTo(n,s,o);return o.intValue().toString(e)+a},r.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var i=this.chunkSize(t),n=Math.pow(t,i),s=!1,o=0,a=0,u=0;u<e.length;++u){var f=c(e,u);f<0?"-"==e.charAt(u)&&0==this.signum()&&(s=!0):(a=t*a+f,++o>=i&&(this.dMultiply(n),this.dAddOffset(a,0),o=0,a=0))}o>0&&(this.dMultiply(Math.pow(t,o)),this.dAddOffset(a,0)),s&&r.ZERO.subTo(this,this)},r.prototype.fromNumber=function(e,t,i){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,i),this.testBit(e-1)||this.bitwiseTo(r.ONE.shiftLeft(e-1),d,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(r.ONE.shiftLeft(e-1),this);else{var n=new Array,s=7&e;n.length=1+(e>>3),t.nextBytes(n),s>0?n[0]&=(1<<s)-1:n[0]=0,this.fromString(n,256)}},r.prototype.bitwiseTo=function(e,t,r){var i,n,s=Math.min(e.t,this.t);for(i=0;i<s;++i)r[i]=t(this[i],e[i]);if(e.t<this.t){for(n=e.s&this.DM,i=s;i<this.t;++i)r[i]=t(this[i],n);r.t=this.t}else{for(n=this.s&this.DM,i=s;i<e.t;++i)r[i]=t(n,e[i]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},r.prototype.changeBit=function(e,t){var i=r.ONE.shiftLeft(e);return this.bitwiseTo(i,t,i),i},r.prototype.addTo=function(e,t){for(var r=0,i=0,n=Math.min(e.t,this.t);r<n;)i+=this[r]+e[r],t[r++]=i&this.DM,i>>=this.DB;if(e.t<this.t){for(i+=e.s;r<this.t;)i+=this[r],t[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<e.t;)i+=e[r],t[r++]=i&this.DM,i>>=this.DB;i+=e.s}t.s=i<0?-1:0,i>0?t[r++]=i:i<-1&&(t[r++]=this.DV+i),t.t=r,t.clamp()},r.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},r.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},r.prototype.multiplyLowerTo=function(e,t,r){var i,n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r[--n]=0;for(i=r.t-this.t;n<i;++n)r[n+this.t]=this.am(0,e[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e[n],r,n,0,t-n);r.clamp()},r.prototype.multiplyUpperTo=function(e,t,r){--t;var i=r.t=this.t+e.t-t;for(r.s=0;--i>=0;)r[i]=0;for(i=Math.max(t-this.t,0);i<e.t;++i)r[this.t+i-t]=this.am(t-i,e[i],r,0,0,this.t+i-t);r.clamp(),r.drShiftTo(1,r)},r.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this[0]%e;else for(var i=this.t-1;i>=0;--i)r=(t*r+this[i])%e;return r},r.prototype.millerRabin=function(e){var t=this.subtract(r.ONE),n=t.getLowestSetBit();if(n<=0)return!1;var s=t.shiftRight(n);(e=e+1>>1)>b.length&&(e=b.length);for(var o=i(),a=0;a<e;++a){o.fromInt(b[Math.floor(Math.random()*b.length)]);var c=o.modPow(s,this);if(0!=c.compareTo(r.ONE)&&0!=c.compareTo(t)){for(var u=1;u++<n&&0!=c.compareTo(t);)if(0==(c=c.modPowInt(2,this)).compareTo(r.ONE))return!1;if(0!=c.compareTo(t))return!1}}return!0},r.prototype.clone=function(){var e=i();return this.copyTo(e),e},r.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},r.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},r.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},r.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},r.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,i=this.DB-e*this.DB%8,n=0;if(e-- >0)for(i<this.DB&&(r=this[e]>>i)!=(this.s&this.DM)>>i&&(t[n++]=r|this.s<<this.DB-i);e>=0;)i<8?(r=(this[e]&(1<<i)-1)<<8-i,r|=this[--e]>>(i+=this.DB-8)):(r=this[e]>>(i-=8)&255,i<=0&&(i+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==n&&(128&this.s)!=(128&r)&&++n,(n>0||r!=this.s)&&(t[n++]=r);return t},r.prototype.equals=function(e){return 0==this.compareTo(e)},r.prototype.min=function(e){return this.compareTo(e)<0?this:e},r.prototype.max=function(e){return this.compareTo(e)>0?this:e},r.prototype.and=function(e){var t=i();return this.bitwiseTo(e,l,t),t},r.prototype.or=function(e){var t=i();return this.bitwiseTo(e,d,t),t},r.prototype.xor=function(e){var t=i();return this.bitwiseTo(e,E,t),t},r.prototype.andNot=function(e){var t=i();return this.bitwiseTo(e,g,t),t},r.prototype.not=function(){for(var e=i(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},r.prototype.shiftLeft=function(e){var t=i();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},r.prototype.shiftRight=function(e){var t=i();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},r.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+m(this[e]);return this.s<0?this.t*this.DB:-1},r.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=v(this[r]^t);return e},r.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)},r.prototype.setBit=function(e){return this.changeBit(e,d)},r.prototype.clearBit=function(e){return this.changeBit(e,g)},r.prototype.flipBit=function(e){return this.changeBit(e,E)},r.prototype.add=function(e){var t=i();return this.addTo(e,t),t},r.prototype.subtract=function(e){var t=i();return this.subTo(e,t),t},r.prototype.multiply=function(e){var t=i();return this.multiplyTo(e,t),t},r.prototype.divide=function(e){var t=i();return this.divRemTo(e,t,null),t},r.prototype.remainder=function(e){var t=i();return this.divRemTo(e,null,t),t},r.prototype.divideAndRemainder=function(e){var t=i(),r=i();return this.divRemTo(e,t,r),new Array(t,r)},r.prototype.modPow=function(e,t){var r,n,s=e.bitLength(),o=u(1);if(s<=0)return o;r=s<18?1:s<48?3:s<144?4:s<768?5:6,n=s<8?new h(t):t.isEven()?new _(t):new p(t);var a=new Array,c=3,l=r-1,d=(1<<r)-1;if(a[1]=n.convert(this),r>1){var E=i();for(n.sqrTo(a[1],E);c<=d;)a[c]=i(),n.mulTo(E,a[c-2],a[c]),c+=2}var g,m,v=e.t-1,w=!0,y=i();for(s=f(e[v])-1;v>=0;){for(s>=l?g=e[v]>>s-l&d:(g=(e[v]&(1<<s+1)-1)<<l-s,v>0&&(g|=e[v-1]>>this.DB+s-l)),c=r;0==(1&g);)g>>=1,--c;if((s-=c)<0&&(s+=this.DB,--v),w)a[g].copyTo(o),w=!1;else{for(;c>1;)n.sqrTo(o,y),n.sqrTo(y,o),c-=2;c>0?n.sqrTo(o,y):(m=o,o=y,y=m),n.mulTo(y,a[g],o)}for(;v>=0&&0==(e[v]&1<<s);)n.sqrTo(o,y),m=o,o=y,y=m,--s<0&&(s=this.DB-1,--v)}return n.revert(o)},r.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return r.ZERO;for(var i=e.clone(),n=this.clone(),s=u(1),o=u(0),a=u(0),c=u(1);0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),t?(s.isEven()&&o.isEven()||(s.addTo(this,s),o.subTo(e,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),t?(a.isEven()&&c.isEven()||(a.addTo(this,a),c.subTo(e,c)),a.rShiftTo(1,a)):c.isEven()||c.subTo(e,c),c.rShiftTo(1,c);i.compareTo(n)>=0?(i.subTo(n,i),t&&s.subTo(a,s),o.subTo(c,o)):(n.subTo(i,n),t&&a.subTo(s,a),c.subTo(o,c))}return 0!=n.compareTo(r.ONE)?r.ZERO:c.compareTo(e)>=0?c.subtract(e):c.signum()<0?(c.addTo(e,c),c.signum()<0?c.add(e):c):c},r.prototype.pow=function(e){return this.exp(e,new w)},r.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var i=t;t=r,r=i}var n=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;for(n<s&&(s=n),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));t.signum()>0;)(n=t.getLowestSetBit())>0&&t.rShiftTo(n,t),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r},r.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r[0]<=b[b.length-1]){for(t=0;t<b.length;++t)if(r[0]==b[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<b.length;){for(var i=b[t],n=t+1;n<b.length&&i<B;)i*=b[n++];for(i=r.modInt(i);t<n;)if(i%b[t++]==0)return!1}return r.millerRabin(e)},r.prototype.square=function(){var e=i();return this.squareTo(e),e},r.prototype.Barrett=_,e.exports=r},562:function(e,t,r){var i,n=r(260).Ber,s=r(262),o=/^PuTTY-User-Key-File-2: ssh-(rsa|dss)\r?\nEncryption: (aes256-cbc|none)\r?\nComment: ([^\r\n]*)\r?\nPublic-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-MAC: ([^\r\n]+)/,a=/^-----BEGIN (RSA|DSA|EC) PRIVATE KEY-----$/i,c=/^-----END (?:RSA|DSA|EC) PRIVATE KEY-----$/i,u=/^((?:(?:ssh-(rsa|dss))|ecdsa-sha2-nistp(256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z\/+=]+)(?:$|\s+([\S].*)?)$/i,f=/^---- BEGIN SSH2 PUBLIC KEY ----$/i,h=/^---- END SSH2 PUBLIC KEY ----$/i,p=/^([^:]+):\s*([\S].*)?$/i,l=/^([^:]+): (.*)?$/i;e.exports=function(e){if(Buffer.isBuffer(e))e=e.toString("utf8");else if("string"!=typeof e)return new Error("Key data must be a Buffer or string");var t,d,E,g={fulltype:void 0,type:void 0,curve:void 0,extra:void 0,comment:void 0,encryption:void 0,private:void 0,privateOrig:void 0,public:void 0,publicOrig:void 0};for(e=e.trim().split(/\r\n|\n/);!e[0].length;)e.shift();for(;!e.slice(-1)[0].length;)e.pop();var m=e.join("\n");if((t=a.exec(e[0]))&&c.test(e.slice(-1))){var v=t[1].toLowerCase();if("dsa"===v&&(v="dss"),"ec"===v&&s.lt(process.version,"5.2.0"))return new Error("EC private keys are not supported in this version of node");if(p.test(e[1])){for(d=1,E=e.length;d<E;++d)if(t=p.exec(e[d]))t[1]=t[1].toLowerCase(),"dek-info"===t[1]&&(t[2]=t[2].split(","),g.encryption=t[2][0].toLowerCase(),t[2].length>1&&(g.extra=t[2].slice(1)));else if(e[d].length)break;g.private=new Buffer(e.slice(d,-1).join(""),"base64")}else{var w=new Buffer(e.slice(1,-1).join(""),"base64");if("ec"!==v)g.fulltype="ssh-"+v;else{var y=new n.Reader(w);y.readSequence(),y.readInt(),y.readString(n.OctetString,!0),y.readByte();var _=y.readLength();if(null!==_)switch(y._offset=_,y.readOID()){case"1.2.840.10045.3.1.7":g.fulltype="ecdsa-sha2-nistp256";break;case"1.3.132.0.34":g.fulltype="ecdsa-sha2-nistp384";break;case"1.3.132.0.35":g.fulltype="ecdsa-sha2-nistp521"}if(void 0===g.fulltype)return new Error("Unsupported EC private key type")}g.private=w}g.type=v,g.privateOrig=new Buffer(m)}else if(t=u.exec(e[0]))g.fulltype=t[1],g.type=(t[2]||"ec").toLowerCase(),g.public=new Buffer(t[4],"base64"),g.publicOrig=new Buffer(m),g.comment=t[5],t[3]&&(g.curve="nistp"+t[3]);else if(f.test(e[0])&&h.test(e.slice(-1))){if(-1===e[1].indexOf(": "))g.public=new Buffer(e.slice(1,-1).join(""),"base64");else{for(d=1,E=e.length;d<E;++d)if(-1!==e[d].indexOf(": ")){for(;"\\"===e[d].substr(-1);){if(!(d+1<E))return new Error("RFC4716 public key missing header continuation line");e[d]=e[d].slice(0,-1)+e[d+1],e.splice(d+1,1),--E}if(!(t=l.exec(e[d])))return new Error("RFC4716 public key invalid header line");t[1]=t[1].toLowerCase(),"comment"===t[1]&&(g.comment=t[2]||"",'"'===g.comment[0]&&'"'===g.comment.substr(-1)&&(g.comment=g.comment.slice(1,-1)))}else if(e[d].length)break;g.public=new Buffer(e.slice(d,-1).join(""),"base64")}E=g.public.readUInt32BE(0,!0);var b=g.public.toString("ascii",4,4+E);if(g.fulltype=b,"ssh-dss"===b)g.type="dss";else{if("ssh-rsa"!==b)return new Error("Unsupported RFC4716 public key type: "+b);g.type="rsa"}g.public=g.public.slice(11),g.publicOrig=new Buffer(m)}else{if(!(t=o.exec(m)))return new Error("Unsupported key format");i||(i=r(72)),g.ppk=!0,g.type=t[1],g.fulltype="ssh-"+t[1],"none"!==t[2]&&(g.encryption=t[2]),g.comment=t[3],g.public=new Buffer(t[4].replace(/\r?\n/g,""),"base64");var B=new Buffer(t[5].replace(/\r?\n/g,""),"base64");if(!(g.privateMAC=t[6].replace(/\r?\n/g,""),g.encryption||i.verifyPPKMAC(g,void 0,B)))throw new Error("PPK MAC mismatch");var S=i.genPublicKey(g);g.public=S.public,g.publicOrig=S.publicOrig,g.private=B,g.encryption||i.convertPPKPrivate(g)}return g}},563:function(e,t,r){var i=r(2),n=r(21),s=r(1).Transform,o=r(0).inherits,a=r(0).inspect,c=r(16).kMaxLength,u=r(564),f=r(165),h=r(72),p=h.isStreamCipher,l=h.iv_inc,d=h.readString,E=h.readInt,g=h.DSASigBERToBare,m=h.DSASigBareToBER,v=h.ECDSASigSSHToASN1,w=h.ECDSASigASN1ToSSH,y=h.RSAKeySSHToASN1,_=h.DSAKeySSHToASN1,b=h.ECDSAKeySSHToASN1,B=f.MESSAGE,S=f.DYNAMIC_KEXDH_MESSAGE,U=f.KEXDH_MESSAGE,I=f.ALGORITHMS,A=f.DISCONNECT_REASON,T=f.CHANNEL_OPEN_FAILURE,N=f.SSH_TO_OPENSSL,k=f.TERMINAL_MODE,R=f.SIGNALS,C=f.BUGS,D=f.BUGGY_IMPLS,O=D.length,L=r(565).version,P=0,H=P++,x=P++,G=P++,K=P++,F=P++,M=P++,q=P++,W=P++,X=P++,j=P++,z=P++,V=n.Z_PARTIAL_FLUSH,Q={flush:V},Y=/-(.+)$/,$=/^gex-/,Z=/\x00/g,J=/^aes\d+-gcm/i,ee=new Buffer("SSH-"),te=new Buffer(0),re=new Buffer([B.GLOBAL_REQUEST,0,0,0,21,107,101,101,112,97,108,105,118,101,64,111,112,101,110,115,115,104,46,99,111,109,1]),ie=new Buffer([B.NEWKEYS]),ne=new Buffer([B.USERAUTH_SUCCESS]),se=new Buffer([B.REQUEST_SUCCESS]),oe=new Buffer([B.REQUEST_FAILURE]),ae=new Buffer([k.TTY_OP_END]),ce=new Buffer([B.KEXDH_GEX_REQUEST,0,0,4,0,0,0,16,0,0,0,32,0]);function ue(e){}function fe(e){"object"==typeof e&&null!==e||(e={}),s.call(this,{highWaterMark:"number"==typeof e.highWaterMark?e.highWaterMark:32768}),this._needContinue=!1,this.bytesSent=this.bytesReceived=0,this.debug="function"==typeof e.debug?e.debug:ue,this.server=!0===e.server,this.maxPacketSize="number"==typeof e.maxPacketSize?e.maxPacketSize:35e3,this.remoteBugs=0,this.server&&(this.remoteBugs=C.BAD_DHGEX);var t=this,r=e.hostKeys;if(this.server&&("object"!=typeof r||null===r))throw new Error("hostKeys must be an object keyed on host key type");if(this.config={hostKeys:r,ident:"SSH-2.0-"+(e.ident||"ssh2js"+L+(this.server?"srv":"")),algorithms:{kex:I.KEX,kexBuf:I.KEX_BUF,serverHostKey:I.SERVER_HOST_KEY,serverHostKeyBuf:I.SERVER_HOST_KEY_BUF,cipher:I.CIPHER,cipherBuf:I.CIPHER_BUF,hmac:I.HMAC,hmacBuf:I.HMAC_BUF,compress:I.COMPRESS,compressBuf:I.COMPRESS_BUF}},this.config.ident.replace(Z,""),this.config.ident.length+2>255)throw new Error("ident too long");if("object"==typeof e.algorithms&&null!==e.algorithms){var n=e.algorithms;Array.isArray(n.kex)&&n.kex.length>0&&(this.config.algorithms.kex=n.kex,Buffer.isBuffer(n.kexBuf)||(n.kexBuf=new Buffer(n.kex.join(","),"ascii")),this.config.algorithms.kexBuf=n.kexBuf),Array.isArray(n.serverHostKey)&&n.serverHostKey.length>0&&(this.config.algorithms.serverHostKey=n.serverHostKey,Buffer.isBuffer(n.serverHostKeyBuf)||(n.serverHostKeyBuf=new Buffer(n.serverHostKey.join(","),"ascii")),this.config.algorithms.serverHostKeyBuf=n.serverHostKeyBuf),Array.isArray(n.cipher)&&n.cipher.length>0&&(this.config.algorithms.cipher=n.cipher,Buffer.isBuffer(n.cipherBuf)||(n.cipherBuf=new Buffer(n.cipher.join(","),"ascii")),this.config.algorithms.cipherBuf=n.cipherBuf),Array.isArray(n.hmac)&&n.hmac.length>0&&(this.config.algorithms.hmac=n.hmac,Buffer.isBuffer(n.hmacBuf)||(n.hmacBuf=new Buffer(n.hmac.join(","),"ascii")),this.config.algorithms.hmacBuf=n.hmacBuf),Array.isArray(n.compress)&&n.compress.length>0&&(this.config.algorithms.compress=n.compress,Buffer.isBuffer(n.compressBuf)||(n.compressBuf=new Buffer(n.compress.join(","),"ascii")),this.config.algorithms.compressBuf=n.compressBuf)}this.reset(!0),this.on("end",(function(){t._state=void 0,t.reset(),t._state.incoming.hmac.bufCompute=void 0,t._state.outgoing.bufSeqno=void 0})),this.on("DISCONNECT",(function(e,r,i,n){!function(e,t,r,i,n){if(r!==A.BY_APPLICATION){var s=new Error(i||t);s.code=r,e.emit("error",s)}e.reset()}(t,e,r,i)})),this.on("KEXINIT",(function(e,r){!function(e,t,r){var n=e._state,s=n.outgoing;s.status===j?(e.debug("DEBUG: Received re-key request"),s.status=z,s.kexinit=void 0,ve(e,o)):o();function o(){if(!0===function(e,t,r){var n,s,o,a,c,u=e._state,f=u.incoming,h=u.outgoing,p=e.debug;p("DEBUG: Comparing KEXINITs ...");var l=e.config.algorithms,d=l.kex;if(e.remoteBugs&C.BAD_DHGEX)for(var E=!1,g=d.length-1;g>=0;--g)-1!==d[g].indexOf("group-exchange")&&(E||(d=d.slice(),E=!0),d.splice(g,1));p("DEBUG: (local) KEX algorithms: "+d),p("DEBUG: (remote) KEX algorithms: "+t.algorithms.kex),e.server?(n=d,s=t.algorithms.kex):(n=t.algorithms.kex,s=d);for(c=0,a=s.length;c<a&&-1===n.indexOf(s[c]);++c);if(c===a){return p("DEBUG: No matching key exchange algorithm"),(v=new Error("Handshake failed: no matching key exchange algorithm")).level="handshake",e.emit("error",v),e.disconnect(A.KEY_EXCHANGE_FAILED),!1}var m=s[c];p("DEBUG: KEX algorithm: "+m),!r||t.algorithms.kex.length&&m===t.algorithms.kex[0]||(f.ignoreNext=!0);p("DEBUG: (local) Host key formats: "+l.serverHostKey),p("DEBUG: (remote) Host key formats: "+t.algorithms.srvHostKey),e.server?(n=l.serverHostKey,s=t.algorithms.srvHostKey):(n=t.algorithms.srvHostKey,s=l.serverHostKey);for(c=0,a=s.length;c<a&&-1===n.indexOf(s[c]);++c);if(c===a){return p("DEBUG: No matching host key format"),(v=new Error("Handshake failed: no matching host key format")).level="handshake",e.emit("error",v),e.disconnect(A.KEY_EXCHANGE_FAILED),!1}u.hostkeyFormat=s[c],p("DEBUG: Host key format: "+u.hostkeyFormat),p("DEBUG: (local) Client->Server ciphers: "+l.cipher),p("DEBUG: (remote) Client->Server ciphers: "+t.algorithms.cs.encrypt),e.server?(n=l.cipher,s=t.algorithms.cs.encrypt):(n=t.algorithms.cs.encrypt,s=l.cipher);for(c=0,a=s.length;c<a&&-1===n.indexOf(s[c]);++c);if(c===a){return p("DEBUG: No matching Client->Server cipher"),(v=new Error("Handshake failed: no matching client->server cipher")).level="handshake",e.emit("error",v),e.disconnect(A.KEY_EXCHANGE_FAILED),!1}e.server?(o=f.decrypt.type=s[c],f.decrypt.isGCM=J.test(o)):(o=h.encrypt.type=s[c],h.encrypt.isGCM=J.test(o));p("DEBUG: Client->Server Cipher: "+o),p("DEBUG: (local) Server->Client ciphers: "+l.cipher),p("DEBUG: (remote) Server->Client ciphers: "+t.algorithms.sc.encrypt),e.server?(n=l.cipher,s=t.algorithms.sc.encrypt):(n=t.algorithms.sc.encrypt,s=l.cipher);for(c=0,a=s.length;c<a&&-1===n.indexOf(s[c]);++c);if(c===a){return p("DEBUG: No matching Server->Client cipher"),(v=new Error("Handshake failed: no matching server->client cipher")).level="handshake",e.emit("error",v),e.disconnect(A.KEY_EXCHANGE_FAILED),!1}e.server?(o=h.encrypt.type=s[c],h.encrypt.isGCM=J.test(o)):(o=f.decrypt.type=s[c],f.decrypt.isGCM=J.test(o));p("DEBUG: Server->Client Cipher: "+o),p("DEBUG: (local) Client->Server HMAC algorithms: "+l.hmac),p("DEBUG: (remote) Client->Server HMAC algorithms: "+t.algorithms.cs.mac),e.server?(n=l.hmac,s=t.algorithms.cs.mac):(n=t.algorithms.cs.mac,s=l.hmac);for(c=0,a=s.length;c<a&&-1===n.indexOf(s[c]);++c);if(c===a){return p("DEBUG: No matching Client->Server HMAC algorithm"),(v=new Error("Handshake failed: no matching client->server HMAC")).level="handshake",e.emit("error",v),e.disconnect(A.KEY_EXCHANGE_FAILED),!1}o=e.server?f.hmac.type=s[c]:h.hmac.type=s[c];p("DEBUG: Client->Server HMAC algorithm: "+o),p("DEBUG: (local) Server->Client HMAC algorithms: "+l.hmac),p("DEBUG: (remote) Server->Client HMAC algorithms: "+t.algorithms.sc.mac),e.server?(n=l.hmac,s=t.algorithms.sc.mac):(n=t.algorithms.sc.mac,s=l.hmac);for(c=0,a=s.length;c<a&&-1===n.indexOf(s[c]);++c);if(c===a){return p("DEBUG: No matching Server->Client HMAC algorithm"),(v=new Error("Handshake failed: no matching server->client HMAC")).level="handshake",e.emit("error",v),e.disconnect(A.KEY_EXCHANGE_FAILED),!1}o=e.server?h.hmac.type=s[c]:f.hmac.type=s[c];p("DEBUG: Server->Client HMAC algorithm: "+o),p("DEBUG: (local) Client->Server compression algorithms: "+l.compress),p("DEBUG: (remote) Client->Server compression algorithms: "+t.algorithms.cs.compress),e.server?(n=l.compress,s=t.algorithms.cs.compress):(n=t.algorithms.cs.compress,s=l.compress);for(c=0,a=s.length;c<a&&-1===n.indexOf(s[c]);++c);if(c===a){return p("DEBUG: No matching Client->Server compression algorithm"),(v=new Error("Handshake failed: no matching client->server compression algorithm")).level="handshake",e.emit("error",v),e.disconnect(A.KEY_EXCHANGE_FAILED),!1}o=e.server?f.decompress.type=s[c]:h.compress.type=s[c];p("DEBUG: Client->Server compression algorithm: "+o),p("DEBUG: (local) Server->Client compression algorithms: "+l.compress),p("DEBUG: (remote) Server->Client compression algorithms: "+t.algorithms.sc.compress),e.server?(n=l.compress,s=t.algorithms.sc.compress):(n=t.algorithms.sc.compress,s=l.compress);for(c=0,a=s.length;c<a&&-1===n.indexOf(s[c]);++c);if(c===a){var v;return p("DEBUG: No matching Server->Client compression algorithm"),(v=new Error("Handshake failed: no matching server->client compression algorithm")).level="handshake",e.emit("error",v),e.disconnect(A.KEY_EXCHANGE_FAILED),!1}o=e.server?h.compress.type=s[c]:f.decompress.type=s[c];switch(p("DEBUG: Server->Client compression algorithm: "+o),m){case"diffie-hellman-group1-sha1":u.kexdh="group",u.kex=i.getDiffieHellman("modp2");break;case"diffie-hellman-group14-sha1":u.kexdh="group",u.kex=i.getDiffieHellman("modp14");break;case"ecdh-sha2-nistp256":u.kexdh="ec-sha256",u.kex=i.createECDH(N[m]);break;case"ecdh-sha2-nistp384":u.kexdh="ec-sha384",u.kex=i.createECDH(N[m]);break;case"ecdh-sha2-nistp521":u.kexdh="ec-sha512",u.kex=i.createECDH(N[m]);break;default:"diffie-hellman-group-exchange-sha1"===m?u.kexdh="gex-sha1":"diffie-hellman-group-exchange-sha256"===m&&(u.kexdh="gex-sha256"),u.kex=void 0}if(u.kex){h.pubkey=u.kex.generateKeys();var w=0;for(a=h.pubkey.length;0===h.pubkey[w];)++w,--a;if(128&h.pubkey[w]){var y=new Buffer(a+1);y[0]=0,h.pubkey.copy(y,1,w),h.pubkey=y}}return!0}(e,t,r)){var s=$.test(n.kexdh);e.server?n.incoming.expectedPacket=s?"KEXDH_GEX_REQ":"KEXDH_INIT":s?function(e){e._state.incoming.expectedPacket="KEXDH_GEX_GROUP",e.debug("DEBUG: Outgoing: Writing KEXDH_GEX_REQUEST"),ye(e,ce,void 0,!0)}(e):we(e)}}}(t,e,r)})),this.on("NEWKEYS",(function(){he(t)})),this.server?this.on("KEXDH_INIT",(function(e){!function(e,t){!function(e,t){for(var r=e._state,n=r.outgoing,s=r.incoming,o=e.config.hostKeys[r.hostkeyFormat],a=o.publicKey.public,c=o.publicKey.fulltype,u=o.privateKey.privateOrig,f=-1,h=0,p=t.length;h<p&&0===t[h];++h)++f;f>-1&&(t=t.slice(f+1));var l,d=be(r.kex,t);if(d instanceof Error)return d.message="Error while computing DH secret ("+r.kexdh+"): "+d.message,d.level="handshake",e.emit("error",d),e.disconnect(A.KEY_EXCHANGE_FAILED),!1;l="group"===r.kexdh?"sha1":Y.exec(r.kexdh)[1];var E=i.createHash(l),m=Buffer.byteLength(s.identRaw),v=Buffer.byteLength(e.config.ident),y=s.kexinit.length,_=n.kexinit.length,b=a.length,S=t.length,U=n.pubkey.length,I=d.length,T=0,N=0;for(;0===n.pubkey[T];)++T,--U;for(;0===d[N];)++N,--I;128&t[0]&&++S;128&n.pubkey[T]&&++U;128&d[N]&&++I;var k,R,C=m+v+y+_+b+S+U+I+32,D=$.test(r.kexdh),O=0,L=0,P=0,H=0;if(D){for(k=r.kex.getPrime(),R=r.kex.getGenerator(),O=k.length,L=R.length;0===k[P];)++P,--O;for(;0===R[H];)++H,--L;128&k[P]&&++O,128&R[H]&&++L,C+=12,C+=8,C+=O,C+=L}var x,G=0,K=new Buffer(C);K.writeUInt32BE(m,G,!0),G+=4,K.write(s.identRaw,G,"utf8"),G+=m,K.writeUInt32BE(v,G,!0),G+=4,K.write(e.config.ident,G,"utf8"),G+=v,K.writeUInt32BE(y,G,!0),G+=4,s.kexinit.copy(K,G),G+=y,s.kexinit=void 0,K.writeUInt32BE(_,G,!0),G+=4,n.kexinit.copy(K,G),G+=_,n.kexinit=void 0,K.writeUInt32BE(b,G,!0),G+=4,a.copy(K,G),G+=b,D&&(ce.slice(1).copy(K,G),G+=12,K.writeUInt32BE(O,G,!0),G+=4,128&k[P]&&(K[G++]=0),k.copy(K,G,P),G+=O-(128&k[P]?1:0),K.writeUInt32BE(L,G,!0),G+=4,128&R[H]&&(K[G++]=0),R.copy(K,G,H),G+=L-(128&R[H]?1:0));K.writeUInt32BE(S,G,!0),G+=4,128&t[0]&&(K[G++]=0);t.copy(K,G),G+=S-(128&t[0]?1:0),K.writeUInt32BE(U,G,!0),G+=4,128&n.pubkey[T]&&(K[G++]=0);n.pubkey.copy(K,G,T),G+=U-(128&n.pubkey[T]?1:0),K.writeUInt32BE(I,G,!0),G+=4,128&d[N]&&(K[G++]=0);d.copy(K,G,N),n.exchangeHash=E.update(K).digest(),void 0===n.sessionId&&(n.sessionId=n.exchangeHash);switch(n.kexsecret=d,c){case"ssh-rsa":x="RSA-SHA1";break;case"ssh-dss":x="DSA-SHA1";break;case"ecdsa-sha2-nistp256":x="sha256";break;case"ecdsa-sha2-nistp384":x="sha384";break;case"ecdsa-sha2-nistp521":x="sha512"}var F,M=i.createSign(x);if(M.update(n.exchangeHash),(F=function(e,t){try{return e.sign(t)}catch(e){return e}}(M,u))instanceof Error)return F.message="Error while signing data with host key ("+c+"): "+F.message,F.level="handshake",e.emit("error",F),e.disconnect(A.KEY_EXCHANGE_FAILED),!1;"DSA-SHA1"===x?F=g(F):"RSA-SHA1"!==x&&(F=w(F));var q=4+c.length+4+F.length,W=new Buffer(5+b+4+U+4+q);W[G=0]=D?B.KEXDH_GEX_REPLY:B.KEXDH_REPLY,++G,W.writeUInt32BE(b,G,!0),G+=4,a.copy(W,G),G+=b,W.writeUInt32BE(U,G,!0),G+=4,128&n.pubkey[T]&&(W[G++]=0);n.pubkey.copy(W,G,T),G+=U-(128&n.pubkey[T]?1:0),W.writeUInt32BE(q,G,!0),G+=4,W.writeUInt32BE(c.length,G,!0),G+=4,W.write(c,G,c.length,"ascii"),G+=c.length,W.writeUInt32BE(F.length,G,!0),G+=4,F.copy(W,G),r.incoming.expectedPacket="NEWKEYS",D?e.debug("DEBUG: Outgoing: Writing KEXDH_GEX_REPLY"):"group"!==r.kexdh?e.debug("DEBUG: Outgoing: Writing KEXECDH_REPLY"):e.debug("DEBUG: Outgoing: Writing KEXDH_REPLY");ye(e,W,void 0,!0),n.sentNEWKEYS=!0,e.debug("DEBUG: Outgoing: Writing NEWKEYS"),ye(e,ie,void 0,!0)}(e,t)}(t,e)})):this.on("KEXDH_REPLY",(function(e){!function e(t,r,n){var s,o,a=t._state,c=a.incoming,u=a.outgoing,f=t.debug;if(void 0===n){c.expectedPacket="NEWKEYS",u.sentNEWKEYS=!1,f("DEBUG: Checking host key format");var h=d(r.hostkey,0,"ascii",t);if(!1===h)return!1;if(r.hostkey_format!==a.hostkeyFormat||r.hostkey_format!==h)return f("DEBUG: Host key format mismatch"),t.disconnect(A.KEY_EXCHANGE_FAILED),t.reset(),(re=new Error("Handshake failed: host key format mismatch")).level="handshake",t.emit("error",re),!1;f("DEBUG: Checking signature format");var p=d(r.sig,0,"ascii",t);if(!1===p)return!1;if(r.sig_format!==p)return f("DEBUG: Signature format mismatch"),t.disconnect(A.KEY_EXCHANGE_FAILED),t.reset(),(re=new Error("Handshake failed: signature format mismatch")).level="handshake",t.emit("error",re),!1}if(u.status===X){if(void 0===n){f("DEBUG: Verifying host fingerprint");var l=!0,E=t.emit("fingerprint",r.hostkey,(function(i){void 0===n&&(n=!!i,l||e(t,r,n))}));if(l=!1,E&&void 0===n)return}if(void 0===n)f("DEBUG: Host accepted by default (no verification)");else{if(!0!==n)return f("DEBUG: Host denied via fingerprint verification"),t.disconnect(A.KEY_EXCHANGE_FAILED),t.reset(),(re=new Error("Handshake failed: host fingerprint verification failed")).level="handshake",t.emit("error",re),!1;f("DEBUG: Host accepted (verified)")}}var g,w=-1;for(o=0,s=r.pubkey.length;o<s&&0===r.pubkey[o];++o)++w;w>-1&&(r.pubkey=r.pubkey.slice(w+1));if(r.secret=be(a.kex,r.pubkey),r.secret instanceof Error)return r.secret.message="Error while computing DH secret ("+a.kexdh+"): "+r.secret.message,r.secret.level="handshake",t.emit("error",r.secret),t.disconnect(A.KEY_EXCHANGE_FAILED),!1;g="group"===a.kexdh?"sha1":Y.exec(a.kexdh)[1];var B=i.createHash(g),S=Buffer.byteLength(t.config.ident),U=Buffer.byteLength(c.identRaw),I=u.kexinit.length,T=c.kexinit.length,N=r.hostkey.length,k=u.pubkey.length,R=r.pubkey.length,C=r.secret.length,D=0,O=0,L=0;for(;0===u.pubkey[D];)++D,--k;for(;0===r.pubkey[O];)++O,--R;for(;0===r.secret[L];)++L,--C;128&u.pubkey[D]&&++k;128&r.pubkey[O]&&++R;128&r.secret[L]&&++C;var P,H,x=S+U+I+T+N+k+R+C+32,G=$.test(a.kexdh),K=0,F=0,M=0,q=0;if(G){for(P=a.kex.getPrime(),H=a.kex.getGenerator(),K=P.length,F=H.length;0===P[M];)++M,--K;for(;0===H[q];)++q,--F;128&P[M]&&++K,128&H[q]&&++F,x+=12,x+=8,x+=K,x+=F}var W=0,j=new Buffer(x);j.writeUInt32BE(S,W,!0),W+=4,j.write(t.config.ident,W,"utf8"),W+=S,j.writeUInt32BE(U,W,!0),W+=4,j.write(c.identRaw,W,"utf8"),W+=U,j.writeUInt32BE(I,W,!0),W+=4,u.kexinit.copy(j,W),W+=I,u.kexinit=void 0,j.writeUInt32BE(T,W,!0),W+=4,c.kexinit.copy(j,W),W+=T,c.kexinit=void 0,j.writeUInt32BE(N,W,!0),W+=4,r.hostkey.copy(j,W),W+=N,G&&(ce.slice(1).copy(j,W),W+=12,j.writeUInt32BE(K,W,!0),W+=4,128&P[M]&&(j[W++]=0),P.copy(j,W,M),W+=K-(128&P[M]?1:0),j.writeUInt32BE(F,W,!0),W+=4,128&H[q]&&(j[W++]=0),H.copy(j,W,q),W+=F-(128&H[q]?1:0));j.writeUInt32BE(k,W,!0),W+=4,128&u.pubkey[D]&&(j[W++]=0);u.pubkey.copy(j,W,D),W+=k-(128&u.pubkey[D]?1:0),j.writeUInt32BE(R,W,!0),W+=4,128&r.pubkey[O]&&(j[W++]=0);r.pubkey.copy(j,W,O),W+=R-(128&r.pubkey[O]?1:0),j.writeUInt32BE(C,W,!0),W+=4,128&r.secret[L]&&(j[W++]=0);r.secret.copy(j,W,L),u.exchangeHash=B.update(j).digest();var V,Q=d(r.sig,r.sig._pos,t);if(!1===Q)return!1;switch(r.sig_format){case"ssh-rsa":V="RSA-SHA1";break;case"ssh-dss":V="DSA-SHA1";break;case"ecdsa-sha2-nistp256":V="sha256";break;case"ecdsa-sha2-nistp384":V="sha384";break;case"ecdsa-sha2-nistp521":V="sha512";break;default:return f("DEBUG: Signature format unsupported: "+r.sig_format),t.disconnect(A.KEY_EXCHANGE_FAILED),t.reset(),(re=new Error("Handshake failed: signature format unsupported: "+r.sig_format)).level="handshake",t.emit("error",re),!1}var Z,J=i.createVerify(V);J.update(u.exchangeHash),"RSA-SHA1"===V?Z=y(r.hostkey,t):"DSA-SHA1"===V?(Z=_(r.hostkey,t),Q=m(Q)):(Z=b(r.hostkey,t),Q=v(Q,t));if(!Z||!Q)return!1;f("DEBUG: Verifying signature");var ee=Z.toString("base64").replace(/(.{64})/g,"$1\n"),te="-----BEGIN PUBLIC KEY-----\n"+ee+("\n"===ee[ee.length-1]?"":"\n")+"-----END PUBLIC KEY-----";if(!J.verify(te,Q)){var re;return f("DEBUG: Signature verification failed"),t.disconnect(A.KEY_EXCHANGE_FAILED),t.reset(),(re=new Error("Handshake failed: signature verification failed")).level="handshake",t.emit("error",re),!1}void 0===u.sessionId&&(u.sessionId=u.exchangeHash);u.kexsecret=r.secret,f("DEBUG: Outgoing: Writing NEWKEYS"),u.status===z?ye(t,ie,void 0,!0):ye(t,ie);u.sentNEWKEYS=!0,void 0!==n&&void 0===c.expectedPacket&&he(t)}(t,e)})).on("KEXDH_GEX_GROUP",(function(e,r){!function(e,t,r){var n=e._state,s=n.outgoing;n.kex=i.createDiffieHellman(t,r),s.pubkey=n.kex.generateKeys();var o=0,a=s.pubkey.length;for(;0===s.pubkey[o];)++o,--a;if(128&s.pubkey[o]){var c=new Buffer(a+1);c[0]=0,s.pubkey.copy(c,1,o),s.pubkey=c}we(e)}(t,e,r)})),this.server&&("string"==typeof e.greeting&&e.greeting.length&&("\r\n"===e.greeting.slice(-2)?this.push(e.greeting):this.push(e.greeting+"\r\n")),"string"==typeof e.banner&&e.banner.length&&("\r\n"===e.banner.slice(-2)?this.banner=e.banner:this.banner=e.banner+"\r\n")),this.debug("DEBUG: Local ident: "+a(this.config.ident)),this.push(this.config.ident+"\r\n"),this._state.incoming.expectedPacket="KEXINIT"}function he(e){var t=e._state,r=t.outgoing,s=t.incoming;if(s.expectedPacket=void 0,r.sentNEWKEYS){for(var o=0,a=r.kexsecret.length;0===r.kexsecret[o];)++o,--a;var c,u=8,f=0,h=0;c="group"===t.kexdh?"sha1":Y.exec(t.kexdh)[1];var l,d,E=(128&r.kexsecret[o]?1:0)+a,g=new Buffer(4+E);if(t.authsQueue=[],g.writeUInt32BE(E,h,!0),h+=4,128&r.kexsecret[o]&&(g[h++]=0),r.kexsecret.copy(g,h,o),r.kexsecret=void 0,p(r.encrypt.type))r.encrypt.size=u,l=te;else{switch(l=i.createHash(c).update(g).update(r.exchangeHash).update(e.server?"B":"A","ascii").update(r.sessionId).digest(),r.encrypt.type){case"aes128-gcm":case"aes256-gcm":case"aes128-gcm@openssh.com":case"aes256-gcm@openssh.com":u=12;break;case"aes256-cbc":case"aes192-cbc":case"aes128-cbc":case"aes256-ctr":case"aes192-ctr":case"aes128-ctr":u=16}for(r.encrypt.size=u;u>l.length;)l=Buffer.concat([l,i.createHash(c).update(g).update(r.exchangeHash).update(l).digest()]);l=l.slice(0,u)}switch(r.encrypt.type){case"aes256-gcm":case"aes256-gcm@openssh.com":case"aes256-cbc":case"aes256-ctr":case"arcfour256":f=32;break;case"3des-cbc":case"3des-ctr":case"aes192-cbc":case"aes192-ctr":f=24;break;case"aes128-gcm":case"aes128-gcm@openssh.com":case"aes128-cbc":case"aes128-ctr":case"cast128-cbc":case"blowfish-cbc":case"arcfour":case"arcfour128":f=16}for(d=i.createHash(c).update(g).update(r.exchangeHash).update(e.server?"D":"C","ascii").update(r.sessionId).digest();f>d.length;)d=Buffer.concat([d,i.createHash(c).update(g).update(r.exchangeHash).update(d).digest()]);if(d=d.slice(0,f),r.encrypt.isGCM)r.encrypt.size=16,r.encrypt.iv=l,r.encrypt.key=d,r.encrypt.instance=!0;else{var m=N[r.encrypt.type];r.encrypt.instance=i.createCipheriv(m,d,l),r.encrypt.instance.setAutoPadding(!1)}if(u=8,f=0,p(s.decrypt.type))s.decrypt.size=u,l=te;else{switch(l=i.createHash(c).update(g).update(r.exchangeHash).update(e.server?"A":"B","ascii").update(r.sessionId).digest(),s.decrypt.type){case"aes128-gcm":case"aes256-gcm":case"aes128-gcm@openssh.com":case"aes256-gcm@openssh.com":u=12;break;case"aes256-cbc":case"aes192-cbc":case"aes128-cbc":case"aes256-ctr":case"aes192-ctr":case"aes128-ctr":u=16}for(s.decrypt.isGCM?s.decrypt.size=16:s.decrypt.size=u;u>l.length;)l=Buffer.concat([l,i.createHash(c).update(g).update(r.exchangeHash).update(l).digest()]);l=l.slice(0,u)}switch(s.decrypt.buf=new Buffer(s.decrypt.size),s.decrypt.type){case"aes256-gcm":case"aes256-gcm@openssh.com":case"aes256-cbc":case"aes256-ctr":case"arcfour256":f=32;break;case"3des-cbc":case"3des-ctr":case"aes192-cbc":case"aes192-ctr":f=24;break;case"aes128-gcm":case"aes128-gcm@openssh.com":case"aes128-cbc":case"aes128-ctr":case"cast128-cbc":case"blowfish-cbc":case"arcfour":case"arcfour128":f=16}for(d=i.createHash(c).update(g).update(r.exchangeHash).update(e.server?"C":"D","ascii").update(r.sessionId).digest();f>d.length;)d=Buffer.concat([d,i.createHash(c).update(g).update(r.exchangeHash).update(d).digest()]);d=d.slice(0,f);var v,w=N[s.decrypt.type];s.decrypt.instance=i.createDecipheriv(w,d,l),s.decrypt.instance.setAutoPadding(!1),s.decrypt.iv=l,s.decrypt.key=d,"arcfour"===r.encrypt.type.substr(0,7)&&((v=new Buffer(1536)).fill(0),r.encrypt.instance.update(v)),"arcfour"===s.decrypt.type.substr(0,7)&&((v=new Buffer(1536)).fill(0),s.decrypt.instance.update(v));var y=0,_=0;switch(r.hmac.type){case"hmac-ripemd160":case"hmac-sha1":y=20,r.hmac.size=20;break;case"hmac-sha1-96":y=20,r.hmac.size=12;break;case"hmac-sha2-256":y=32,r.hmac.size=32;break;case"hmac-sha2-256-96":y=32,r.hmac.size=12;break;case"hmac-sha2-512":y=64,r.hmac.size=64;break;case"hmac-sha2-512-96":y=64,r.hmac.size=12;break;case"hmac-md5":y=16,r.hmac.size=16;break;case"hmac-md5-96":y=16,r.hmac.size=12}switch(s.hmac.type){case"hmac-ripemd160":case"hmac-sha1":_=20,s.hmac.size=20;break;case"hmac-sha1-96":_=20,s.hmac.size=12;break;case"hmac-sha2-256":_=32,s.hmac.size=32;break;case"hmac-sha2-256-96":_=32,s.hmac.size=12;break;case"hmac-sha2-512":_=64,s.hmac.size=64;break;case"hmac-sha2-512-96":_=64,s.hmac.size=12;break;case"hmac-md5":_=16,s.hmac.size=16;break;case"hmac-md5-96":_=16,s.hmac.size=12}if(r.encrypt.isGCM)r.hmac.key=void 0;else{for(d=i.createHash(c).update(g).update(r.exchangeHash).update(e.server?"F":"E","ascii").update(r.sessionId).digest();y>d.length;)d=Buffer.concat([d,i.createHash(c).update(g).update(r.exchangeHash).update(d).digest()]);r.hmac.key=d.slice(0,y)}if(s.decrypt.isGCM)s.hmac.key=void 0,s.hmac.size=16;else{for(d=i.createHash(c).update(g).update(r.exchangeHash).update(e.server?"E":"F","ascii").update(r.sessionId).digest();_>d.length;)d=Buffer.concat([d,i.createHash(c).update(g).update(r.exchangeHash).update(d).digest()]);s.hmac.key=d.slice(0,_)}if(r.exchangeHash=void 0,s.hmac.buf&&s.hmac.buf.length===s.hmac.size||(s.hmac.buf=new Buffer(s.hmac.size)),"zlib"===r.compress.type?r.compress.instance=n.createDeflate(Q):"none"===r.compress.type&&(r.compress.instance=!1),"zlib"===s.decompress.type?s.decompress.instance=n.createInflate(Q):"none"===s.decompress.type&&(s.decompress.instance=!1),e.bytesSent=e.bytesReceived=0,r.status===z){r.status=j;var b=r.rekeyQueue,B=b.length,S=0;for(r.rekeyQueue=[];S<B;++S)Buffer.isBuffer(b[S])?ye(e,b[S]):ye(e,b[S][0],b[S][1]);B=(b=s.rekeyQueue).length,S=0,s.rekeyQueue=[];for(var U=s.seqno;S<B;++S){if(s.seqno=b[S][0],s.payload=b[S][1],!1===pe(e))return;if(s.status===H)return}s.seqno=U}else r.status=j,s.status===F&&(e.debug("DEBUG: Parser: IN_PACKETBEFORE (update) (expecting "+s.decrypt.size+")"),ge(e,2,s.decrypt.size,s.decrypt.buf)),e.emit("ready")}}function pe(e,t){var r,i,s,o,a,c,u,f,h,p,l,g,w,y,_=e._state.incoming,b=e._state.outgoing,I=_.payload,N=_.seqno;if(++_.seqno>4294967295&&(_.seqno=0),_.ignoreNext)return e.debug("DEBUG: Parser: Packet ignored"),void(_.ignoreNext=!1);var R=I[0];if(void 0===R)return!1;if(b.status!==j&&B[R]!==_.expectedPacket&&R<1&&R>4){e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, expected: "+_.expectedPacket+" but got: "+B[R]),e.disconnect(A.PROTOCOL_ERROR);var D=new Error("Received unexpected packet");return D.level="protocol",e.emit("error",D),!1}if(R===B.CHANNEL_DATA){if(!1===(a=E(I,1,e,t)))return!1;if(!1===(c=d(I,5,e,t,32768)))return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_DATA ("+a+")"),e.emit("CHANNEL_DATA:"+a,c)}else if(R===B.CHANNEL_EXTENDED_DATA){if(!1===(a=E(I,1,e,t)))return!1;var O=E(I,5,e,t);if(!1===O)return!1;if(!1===(c=d(I,9,e,t)))return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_EXTENDED_DATA ("+a+")"),e.emit("CHANNEL_EXTENDED_DATA:"+a,O,c)}else if(R===B.CHANNEL_WINDOW_ADJUST){if(!1===(a=E(I,1,e,t)))return!1;var L=E(I,5,e,t);if(!1===L)return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_WINDOW_ADJUST ("+a+", "+L+")"),e.emit("CHANNEL_WINDOW_ADJUST:"+a,L)}else if(R===B.CHANNEL_SUCCESS){if(!1===(a=E(I,1,e,t)))return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_SUCCESS ("+a+")"),e.emit("CHANNEL_SUCCESS:"+a)}else if(R===B.CHANNEL_FAILURE){if(!1===(a=E(I,1,e,t)))return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_FAILURE ("+a+")"),e.emit("CHANNEL_FAILURE:"+a)}else if(R===B.CHANNEL_EOF){if(!1===(a=E(I,1,e,t)))return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_EOF ("+a+")"),e.emit("CHANNEL_EOF:"+a)}else if(R===B.CHANNEL_OPEN){var P,H=d(I,1,"ascii",e,t);if(!1===H)return!1;if(!1===(h=E(I,I._pos,e,t)))return!1;if(!1===(p=E(I,I._pos+=4,e,t)))return!1;if(!1===(l=E(I,I._pos+=4,e,t)))return!1;if(e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_OPEN ("+h+", "+H+")"),"forwarded-tcpip"===H||"direct-tcpip"===H){var x=d(I,I._pos+=4,"ascii",e,t);if(!1===x)return!1;var G=E(I,I._pos,e,t);if(!1===G)return!1;if(!1===(u=d(I,I._pos+=4,"ascii",e,t)))return!1;if(!1===(f=E(I,I._pos,e,t)))return!1;P={type:H,sender:h,window:p,packetSize:l,data:{destIP:x,destPort:G,srcIP:u,srcPort:f}}}else if("forwarded-streamlocal@openssh.com"===H||"direct-streamlocal@openssh.com"===H){if(!1===(y=d(I,I._pos+=4,"utf8",e,t)))return!1;P={type:H,sender:h,window:p,packetSize:l,data:{socketPath:y}}}else if("x11"===H){if(!1===(u=d(I,I._pos+=4,"ascii",e,t)))return!1;if(!1===(f=E(I,I._pos,e,t)))return!1;P={type:H,sender:h,window:p,packetSize:l,data:{srcIP:u,srcPort:f}}}else P={type:H,sender:h,window:p,packetSize:l,data:{}};e.emit("CHANNEL_OPEN",P)}else if(R===B.CHANNEL_OPEN_CONFIRMATION){if(!1===(g=E(I,1,e,t)))return!1;if(!1===(h=E(I,5,e,t)))return!1;if(!1===(p=E(I,9,e,t)))return!1;if(!1===(l=E(I,13,e,t)))return!1;o={recipient:g,sender:h,window:p,packetSize:l},I.length>17&&(o.data=I.slice(17)),e.emit("CHANNEL_OPEN_CONFIRMATION:"+o.recipient,o)}else if(R===B.CHANNEL_OPEN_FAILURE){if(!1===(g=E(I,1,e,t)))return!1;var K=E(I,5,e,t);if(!1===K)return!1;if(!1===(w=d(I,9,"utf8",e,t)))return!1;if(!1===(i=d(I,I._pos,"utf8",e,t)))return!1;I._pos=9,o={recipient:g,reasonCode:K,reason:T[K],description:w,lang:i},e.emit("CHANNEL_OPEN_FAILURE:"+o.recipient,o)}else if(R===B.CHANNEL_CLOSE){if(!1===(a=E(I,1,e,t)))return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_CLOSE ("+a+")"),e.emit("CHANNEL_CLOSE:"+a)}else if(R===B.IGNORE);else if(R===B.DISCONNECT){var F=E(I,1,e,t);if(!1===F)return!1;var M=A[F];if(!1===(w=d(I,5,"utf8",e,t)))return!1;I._pos<I.length&&(i=d(I,I._pos,"ascii",e,t)),e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: DISCONNECT ("+M+")"),e.emit("DISCONNECT",M,F,w,i)}else if(R===B.DEBUG){if(!1===(s=d(I,2,"utf8",e,t)))return!1;if(!1===(i=d(I,I._pos,"ascii",e,t)))return!1;e.emit("DEBUG",s,i)}else if(R===B.NEWKEYS)e.emit("NEWKEYS");else if(R===B.SERVICE_REQUEST){if(!1===(r=d(I,1,"ascii",e,t)))return!1;e.emit("SERVICE_REQUEST",r)}else if(R===B.SERVICE_ACCEPT){if(!1===(r=d(I,1,"ascii",e,t)))return!1;e.emit("SERVICE_ACCEPT",r)}else if(R===B.USERAUTH_REQUEST){var q=d(I,1,"utf8",e,t);if(!1===q)return!1;var W=d(I,I._pos,"ascii",e,t);if(!1===W)return!1;var X,z=d(I,I._pos,"ascii",e,t);if(!1===z)return!1;if("password"===z){if(!1===(X=d(I,I._pos+1,"utf8",e,t)))return!1}else if("publickey"===z||"hostbased"===z){var V,Y,Z,J,ee,te,re;if("publickey"===z){if(void 0===(V=I[I._pos++]))return!1;V=0!==V}if(!1===(Y=d(I,I._pos,"ascii",e,t)))return!1;if(!1===(Z=d(I,I._pos,e,t)))return!1;if(V||"hostbased"===z){if("hostbased"===z){if(!1===(te=d(I,I._pos,"ascii",e,t)))return!1;if(!1===(re=d(I,I._pos,"utf8",e,t)))return!1}var ie=I._pos;if(!1===(J=d(I,ie,e,t)))return!1;if(J.length>4+Y.length+4&&J.toString("ascii",4,4+Y.length)===Y&&(J=J.slice(4+Y.length+4)),"ssh-dss"===Y)J=m(J);else if("ssh-rsa"!==Y&&"ssh-dss"!==Y&&!1===(J=v(J,e,t)))return!1;(ee=new Buffer(4+b.sessionId.length+ie)).writeUInt32BE(b.sessionId.length,0,!0),b.sessionId.copy(ee,4),I.copy(ee,4+b.sessionId.length,0,ie)}X={keyAlgo:Y,key:Z,signature:J,blob:ee,localHostname:te,localUsername:re}}else if("keyboard-interactive"===z){var ne=E(I,I._pos,e,t);if(!1===ne)return!1;if(!1===(X=d(I,I._pos+4+ne,"utf8",e,t)))return!1}else"none"!==z&&(X=I.slice(I._pos));e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: USERAUTH_REQUEST ("+z+")"),e._state.authsQueue.push(z),e.emit("USERAUTH_REQUEST",q,W,z,X)}else if(R===B.USERAUTH_SUCCESS)"zlib@openssh.com"===b.compress.type&&(b.compress.instance=n.createDeflate(Q)),"zlib@openssh.com"===_.decompress.type&&(_.decompress.instance=n.createInflate(Q)),e._state.authsQueue.shift(),e.emit("USERAUTH_SUCCESS");else if(R===B.USERAUTH_FAILURE){var se=d(I,1,"ascii",e,t);if(!1===se)return!1;var oe=I[I._pos];if(void 0===oe)return!1;oe=0!==oe,se=se.split(","),e._state.authsQueue.shift(),e.emit("USERAUTH_FAILURE",se,oe)}else if(R===B.USERAUTH_BANNER){if(!1===(s=d(I,1,"utf8",e,t)))return!1;if(!1===(i=d(I,I._pos,"utf8",e,t)))return!1;e.emit("USERAUTH_BANNER",s,i)}else if(R===B.GLOBAL_REQUEST){var ae=d(I,1,"ascii",e,t);if(!1===ae)return e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: GLOBAL_REQUEST"),!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: GLOBAL_REQUEST ("+ae+")");var ce,ue=I[I._pos++];if(void 0===ue)return!1;if(ue=0!==ue,"tcpip-forward"===ae||"cancel-tcpip-forward"===ae){var fe=d(I,I._pos,"ascii",e,t);if(!1===fe)return!1;var he=E(I,I._pos,e,t);if(!1===he)return!1;ce={bindAddr:fe,bindPort:he}}else if("streamlocal-forward@openssh.com"===ae||"cancel-streamlocal-forward@openssh.com"===ae){if(!1===(y=d(I,I._pos,"utf8",e,t)))return!1;ce={socketPath:y}}else"no-more-sessions@openssh.com"===ae||(ce=I.slice(I._pos));e.emit("GLOBAL_REQUEST",ae,ue,ce)}else if(R===B.REQUEST_SUCCESS)I.length>1?e.emit("REQUEST_SUCCESS",I.slice(1)):e.emit("REQUEST_SUCCESS");else if(R===B.REQUEST_FAILURE)e.emit("REQUEST_FAILURE");else if(R===B.UNIMPLEMENTED);else{if(R===B.KEXINIT)return function(e,t){var r,i=e._state.incoming,n=i.payload,s={algorithms:{kex:void 0,srvHostKey:void 0,cs:{encrypt:void 0,mac:void 0,compress:void 0},sc:{encrypt:void 0,mac:void 0,compress:void 0}},languages:{cs:void 0,sc:void 0}};if(!1===(r=me(n,17,e,t)))return!1;if(s.algorithms.kex=r,!1===(r=me(n,n._pos,e,t)))return!1;if(s.algorithms.srvHostKey=r,!1===(r=me(n,n._pos,e,t)))return!1;if(s.algorithms.cs.encrypt=r,!1===(r=me(n,n._pos,e,t)))return!1;if(s.algorithms.sc.encrypt=r,!1===(r=me(n,n._pos,e,t)))return!1;if(s.algorithms.cs.mac=r,!1===(r=me(n,n._pos,e,t)))return!1;if(s.algorithms.sc.mac=r,!1===(r=me(n,n._pos,e,t)))return!1;if(s.algorithms.cs.compress=r,!1===(r=me(n,n._pos,e,t)))return!1;if(s.algorithms.sc.compress=r,!1===(r=me(n,n._pos,e,t)))return!1;if(s.languages.cs=r,!1===(r=me(n,n._pos,e,t)))return!1;s.languages.sc=r;var o=n._pos<n.length&&1===n[n._pos];i.kexinit=n,e.emit("KEXINIT",s,o)}(e,t);if(R===B.CHANNEL_REQUEST)return function(e,t){var r,i,n,s,o,a,c,u=e._state.incoming.payload,f=E(u,1,e,t);if(!1===f)return!1;var h=d(u,5,"ascii",e,t);if(!1===h)return!1;if("exit-status"===h){var p=E(u,++u._pos,e,t);if(!1===p)return!1;r={recipient:f,request:h,wantReply:!1,code:p}}else if("exit-signal"===h){var l;if(e.remoteBugs&C.OLD_EXIT){if(!1===(c=E(u,++u._pos,e,t)))return!1;switch(c){case 1:c="HUP";break;case 2:c="INT";break;case 3:c="QUIT";break;case 6:c="ABRT";break;case 9:c="KILL";break;case 14:c="ALRM";break;case 15:c="TERM";break;default:c="UNKNOWN ("+c+")"}l=!1}else{if(!1===(c=d(u,++u._pos,"ascii",e,t)))return!1;if(void 0===(l=u[u._pos++]))return!1;l=0!==l}var g=d(u,u._pos,"utf8",e,t);if(!1===g)return!1;var m=d(u,u._pos,"utf8",e,t);if(!1===m)return!1;r={recipient:f,request:h,wantReply:!1,signal:c,coredump:l,description:g,lang:m}}else if("pty-req"===h){if(void 0===(a=u[u._pos++]))return!1;a=0!==a;var v=d(u,u._pos,"ascii",e,t);if(!1===v)return!1;if(!1===(i=E(u,u._pos,e,t)))return!1;if(!1===(n=E(u,u._pos+=4,e,t)))return!1;if(!1===(s=E(u,u._pos+=4,e,t)))return!1;if(!1===(o=E(u,u._pos+=4,e,t)))return!1;var w=d(u,u._pos+=4,e,t);if(!1===w)return!1;w=function(e){for(var t,r={},i=0,n=e.length;i<n&&!((t=e[i])===k.TTY_OP_END||void 0===k[t]||i+5>n);i+=5)r[k[t]]=e.readUInt32BE(i+1,!0);return r}(w),r={recipient:f,request:h,wantReply:a,term:v,cols:i,rows:n,width:s,height:o,modes:w}}else if("window-change"===h){if(!1===(i=E(u,++u._pos,e,t)))return!1;if(!1===(n=E(u,u._pos+=4,e,t)))return!1;if(!1===(s=E(u,u._pos+=4,e,t)))return!1;if(!1===(o=E(u,u._pos+=4,e,t)))return!1;r={recipient:f,request:h,wantReply:!1,cols:i,rows:n,width:s,height:o}}else if("x11-req"===h){if(void 0===(a=u[u._pos++]))return!1;a=0!==a;var y=u[u._pos++];if(void 0===y)return!1;y=0!==y;var _=d(u,u._pos,"ascii",e,t);if(!1===_)return!1;var b=d(u,u._pos,"hex",e,t);if(!1===b)return!1;var B=E(u,u._pos,e,t);if(!1===B)return!1;r={recipient:f,request:h,wantReply:a,single:y,protocol:_,cookie:b,screen:B}}else if("env"===h){if(void 0===(a=u[u._pos++]))return!1;a=0!==a;var S=d(u,u._pos,"utf8",e,t);if(!1===S)return!1;var U=d(u,u._pos,"utf8",e,t);if(!1===U)return!1;r={recipient:f,request:h,wantReply:a,key:S,val:U}}else if("shell"===h){if(void 0===(a=u[u._pos]))return!1;r={recipient:f,request:h,wantReply:a=0!==a}}else if("exec"===h){if(void 0===(a=u[u._pos++]))return!1;a=0!==a;var I=d(u,u._pos,"utf8",e,t);if(!1===I)return!1;r={recipient:f,request:h,wantReply:a,command:I}}else if("subsystem"===h){if(void 0===(a=u[u._pos++]))return!1;a=0!==a;var A=d(u,u._pos,"utf8",e,t);if(!1===A)return!1;r={recipient:f,request:h,wantReply:a,subsystem:A}}else if("signal"===h){if(!1===(c=d(u,++u._pos,"ascii",e,t)))return!1;r={recipient:f,request:h,wantReply:!1,signal:"SIG"+c}}else if("xon-xoff"===h){var T=u[++u._pos];if(void 0===T)return!1;r={recipient:f,request:h,wantReply:!1,clientControl:T=0!==T}}else if("auth-agent-req@openssh.com"===h){if(void 0===(a=u[u._pos]))return!1;r={recipient:f,request:h,wantReply:a=0!==a}}else{if(void 0===(a=u[u._pos]))return!1;r={recipient:f,request:h,wantReply:a=0!==a}}e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_REQUEST ("+f+", "+h+")"),e.emit("CHANNEL_REQUEST:"+f,r)}(e,t);if(R>=30&&R<=49)return function(e,t,r){var i=e._state,n=i.incoming,s=n.payload,o=$.test(i.kexdh)?S[t]:U[t];if(i.outgoing.status===j||n.expectedPacket!==o){return e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, expected: "+n.expectedPacket+" but got: "+o),e.disconnect(A.PROTOCOL_ERROR),(a=new Error("Received unexpected packet")).level="protocol",e.emit("error",a),!1}if($.test(i.kexdh)){var a;if(e.server)return e.disconnect(A.PROTOCOL_ERROR),(a=new Error("DH group exchange not supported by server")).level="handshake",e.emit("error",a),!1;if(t===B.KEXDH_GEX_GROUP){var c=d(s,1,e,r);if(!1===c)return!1;var u=d(s,s._pos,e,r);if(!1===u)return!1;e.emit("KEXDH_GEX_GROUP",c,u)}else if(t===B.KEXDH_GEX_REPLY)return le(e,r)}else if(t===B.KEXDH_INIT){var f=d(s,1,e,r);if(!1===f)return!1;e.emit("KEXDH_INIT",f)}else if(t===B.KEXDH_REPLY)return le(e,r)}(e,R,t);if(R>=60&&R<=70)return function(e,t,r){var i,n,s,o=e._state,a=o.authsQueue[0],c=o.incoming.payload;if("password"===a){if(t===B.USERAUTH_PASSWD_CHANGEREQ){if(!1===(i=d(c,1,"utf8",e,r)))return!1;if(!1===(n=d(c,c._pos,"utf8",e,r)))return!1;e.emit("USERAUTH_PASSWD_CHANGEREQ",i,n)}}else if("keyboard-interactive"===a){if(t===B.USERAUTH_INFO_REQUEST){var u,f,h;if(!1===(u=d(c,1,"utf8",e,r)))return!1;if(!1===(f=d(c,c._pos,"utf8",e,r)))return!1;if(!1===(n=d(c,c._pos,"utf8",e,r)))return!1;if(!1===(h=E(c,c._pos,e,r)))return!1;c._pos+=4;for(var p=[],l=0;l<h;++l){if(!1===(s=d(c,c._pos,"utf8",e,r)))return!1;var g=c[c._pos++];if(void 0===g)return!1;g=0!==g,p.push({prompt:s,echo:g})}e.emit("USERAUTH_INFO_REQUEST",u,f,n,p)}else if(t===B.USERAUTH_INFO_RESPONSE){var m=E(c,1,e,r);if(!1===m)return!1;c._pos=5;for(var v=[],w=0;w<m;++w){if(!1===(s=d(c,c._pos,"utf8",e,r)))return!1;v.push(s)}e.emit("USERAUTH_INFO_RESPONSE",v)}}else if("publickey"===a){if(t===B.USERAUTH_PK_OK){var y=e._state.authsQueue;if(!y.length||"publickey"!==y[0])return;y.shift(),e.emit("USERAUTH_PK_OK")}}else if(void 0!==a){e.disconnect(A.PROTOCOL_ERROR);var _=new Error("Invalid authentication method: "+a);_.level="protocol",e.emit("error",_)}}(e,R,t);var pe=new Buffer(5);pe[0]=B.UNIMPLEMENTED,pe.writeUInt32BE(N,1,!0),ye(e,pe)}}function le(e,t){var r=e._state.incoming.payload,i=d(r,1,e,t);if(!1===i)return!1;var n=d(r,r._pos,e,t);if(!1===n)return!1;var s=d(r,r._pos,e,t);if(!1===s)return!1;var o={hostkey:i,hostkey_format:void 0,pubkey:n,sig:s,sig_format:void 0},a=d(i,0,"ascii",e,t);if(!1===a)return!1;o.hostkey_format=a;var c=d(s,0,"ascii",e,t);if(!1===c)return!1;o.sig_format=c,e.emit("KEXDH_REPLY",o)}function de(e,t){var r=e._state.incoming,n=r.hmac;if(e.debug("DEBUG: Parser: Verifying MAC"),r.decrypt.isGCM){var s=r.decrypt,o=s.instance;o.setAuthTag(t);var a=o.update(r.packet);return r.payload=a.slice(1,r.packet.length+4-a[0]),l(s.iv),s.instance=i.createDecipheriv(N[s.type],s.key,s.iv),s.instance.setAutoPadding(!1),!0}var c=i.createHmac(N[n.type],n.key);n.bufCompute.writeUInt32BE(r.seqno,0,!0),n.bufCompute.writeUInt32BE(r.pktLen,4,!0),n.bufCompute[8]=r.padLen,c.update(n.bufCompute),c.update(r.packet);var u=c.digest("binary");return u.length>r.hmac.size&&(u=u.slice(0,r.hmac.size)),u===t.toString("binary")}function Ee(e,t){var r=e._state.incoming.decrypt.instance;return e.debug("DEBUG: Parser: Decrypting"),r.update(t)}function ge(e,t,r,i){var n=e._state.incoming.expect;n.amount=r,n.type=t,n.ptr=0,i&&e[i]?n.buf=e[i]:r&&(n.buf=new Buffer(r))}function me(e,t,r,i){var n=d(e,t,"ascii",r,i);return!1!==n&&(n.length?n.split(","):[])}function ve(e,t){return function(e,t){i.randomBytes(e,(function r(n,s){if(n)return i.randomBytes(e,r);t&&t(s)}))}(16,(function(r){var i=e.config.algorithms,n=i.kexBuf;if(e.remoteBugs&C.BAD_DHGEX){for(var s=!1,o=i.kex,a=o.length-1;a>=0;--a)-1!==o[a].indexOf("group-exchange")&&(s||(o=o.slice(),s=!0),o.splice(a,1));s&&(n=new Buffer(o.join(",")))}var c=i.serverHostKeyBuf,u=21+n.length+4+c.length+2*(4+i.cipherBuf.length)+2*(4+i.hmacBuf.length)+2*(4+i.compressBuf.length)+8+1+4,f=new Buffer(u),h=17;f.fill(0),f[0]=B.KEXINIT,!1!==r&&r.copy(f,1),f.writeUInt32BE(n.length,h,!0),h+=4,n.copy(f,h),h+=n.length,f.writeUInt32BE(c.length,h,!0),h+=4,c.copy(f,h),h+=c.length,f.writeUInt32BE(i.cipherBuf.length,h,!0),h+=4,i.cipherBuf.copy(f,h),h+=i.cipherBuf.length,f.writeUInt32BE(i.cipherBuf.length,h,!0),h+=4,i.cipherBuf.copy(f,h),h+=i.cipherBuf.length,f.writeUInt32BE(i.hmacBuf.length,h,!0),h+=4,i.hmacBuf.copy(f,h),h+=i.hmacBuf.length,f.writeUInt32BE(i.hmacBuf.length,h,!0),h+=4,i.hmacBuf.copy(f,h),h+=i.hmacBuf.length,f.writeUInt32BE(i.compressBuf.length,h,!0),h+=4,i.compressBuf.copy(f,h),h+=i.compressBuf.length,f.writeUInt32BE(i.compressBuf.length,h,!0),h+=4,i.compressBuf.copy(f,h),h+=i.compressBuf.length,e.debug("DEBUG: Outgoing: Writing KEXINIT"),e._state.incoming.expectedPacket="KEXINIT";var p=e._state.outgoing;p.kexinit=f,p.status===j&&(p.status=z),ye(e,f,t,!0)})),!0}function we(e){var t=e._state,r=t.outgoing,i=new Buffer(5+r.pubkey.length);return $.test(t.kexdh)?(t.incoming.expectedPacket="KEXDH_GEX_REPLY",i[0]=B.KEXDH_GEX_INIT,e.debug("DEBUG: Outgoing: Writing KEXDH_GEX_INIT")):(t.incoming.expectedPacket="KEXDH_REPLY",i[0]=B.KEXDH_INIT,"group"!==t.kexdh?e.debug("DEBUG: Outgoing: Writing KEXECDH_INIT"):e.debug("DEBUG: Outgoing: Writing KEXDH_INIT")),i.writeUInt32BE(r.pubkey.length,1,!0),r.pubkey.copy(i,5),ye(e,i,void 0,!0)}function ye(e,t,r,i){var n=e._state;if(!n)return!1;var s=n.outgoing;if(s.status===z&&!i)return"function"==typeof r?s.rekeyQueue.push([t,r]):s.rekeyQueue.push(t),!1;if(e._readableState.ended||e._writableState.ended)return!1;var o=s.compress.instance;return o?(o.write(t),o.flush(V,(function(){e._readableState.ended||e._writableState.ended||_e(e,o.read(),r)})),!0):_e(e,t,r)}function _e(e,t,r){var n,s,o,a,c,u=e._state.outgoing,f=u.encrypt,h=u.hmac;if(n=t.length+9,!1!==f.instance&&f.isGCM){for(var p=1+t.length+4;p%f.size!=0;)++p;s=p-1-t.length,n=4+p}else s=(n+=(f.size-1)*n%f.size)-t.length-5;(o=new Buffer(n)).writeUInt32BE(n-4,0,!0),o[4]=s,t.copy(o,5),i.randomBytes(s).copy(o,5+t.length),!1!==h.type&&h.key&&(a=i.createHmac(N[h.type],h.key),u.bufSeqno.writeUInt32BE(u.seqno,0,!0),a.update(u.bufSeqno),a.update(o),(a=a.digest()).length>u.hmac.size&&(a=a.slice(0,u.hmac.size)));var d,E=0;if(!1!==f.instance)if(f.isGCM){var g=i.createCipheriv(N[f.type],f.key,f.iv);g.setAutoPadding(!1);var m=o.slice(0,4);g.setAAD(m),e.push(m),E+=m,d=g.update(o.slice(4)),e.push(d),E+=d.length;var v=g.final();v.length&&(e.push(v),E+=v.length);var w=g.getAuthTag();c=e.push(w),E+=w.length,l(f.iv)}else d=f.instance.update(o),e.push(d),E+=d.length,c=e.push(a),E+=a.length;else c=e.push(o),E=o.length;return e.bytesSent+=E,++u.seqno>4294967295&&(u.seqno=0),r&&r(),c}function be(e,t){try{return e.computeSecret(t)}catch(e){return e}}o(fe,s),fe.prototype.__read=s.prototype._read,fe.prototype._read=function(e){return this._needContinue&&(this._needContinue=!1,this.emit("continue")),this.__read(e)},fe.prototype.__push=s.prototype.push,fe.prototype.push=function(e,t){var r=this.__push(e,t);return this._needContinue=!1===r,r},fe.prototype._cleanup=function(e){this.reset(),this.debug("DEBUG: Parser: Malformed packet"),e&&e(new Error("Malformed packet"))},fe.prototype._transform=function(e,t,r,i){var n,s,o,c=!1,f=!1,h=this._state,p=h.incoming,l=h.outgoing,d=p.expect,g=p.decrypt,m=p.decompress,v=e.length,w=0,y=this.debug,_=this,b=0,S=b;for(this.bytesReceived+=v;;){if(void 0!==d.type){if(b>=v)break;if(2===d.type){w=v-b;var U=d.buf.length-d.ptr;U<=w?(e.copy(d.buf,d.ptr,b,b+U),b+=U,n=d.buf,d.buf=void 0,d.ptr=0,d.type=void 0):(e.copy(d.buf,d.ptr,b),d.ptr+=w,b+=w);continue}if(0===d.type){if(b+=p.search.push(e),void 0!==d.type)continue}else if(1===d.type){if(4+ ++d.ptr>255)return this.reset(),y("DEBUG: Parser: Identification string exceeded 255 characters"),r(new Error("Max identification string size exceeded"));if(10!==e[b]){++b===v&&S<b&&(void 0===d.buf?d.buf=e.toString("ascii",S,b):d.buf+=e.toString("ascii",S,b));continue}d.type=void 0,S<b&&(void 0===d.buf?d.buf=e.toString("ascii",S,b):d.buf+=e.toString("ascii",S,b)),n=d.buf,d.buf=void 0,++b}}if(p.status===H)if(this.server)if(n){if(83!==n[0]||83!==n[1]||72!==n[2]||45!==n[3])return this.reset(),y("DEBUG: Parser: Bad identification start"),r(new Error("Bad identification start"));p.status=x,y("DEBUG: Parser: IN_INIT (waiting for rest of identification)")}else y("DEBUG: Parser: IN_INIT (waiting for identification begin)"),ge(this,2,4);else{y("DEBUG: Parser: IN_INIT");var I=p.search=new u(ee);I.on("info",(function e(t,r,i,n){r&&(void 0===p.greeting?p.greeting=r.toString("binary",i,n):p.greeting+=r.toString("binary",i,n)),t&&(d.type=void 0,p.search.removeListener("info",e))})),I.maxMatches=1,ge(this,0),p.status=x}else if(p.status===x)y("DEBUG: Parser: IN_GREETING"),p.search=void 0,S=b,ge(this,1),p.status=G;else{if(p.status===G){y("DEBUG: Parser: IN_HEADER"),13===n.charCodeAt(n.length-1)&&(n=n.slice(0,-1));var T=n.indexOf("-"),N=n.indexOf(" "),k={greeting:p.greeting,identRaw:"SSH-"+n,versions:{protocol:n.substr(0,T),software:-1===N?n.substring(T+1):n.substring(T+1,N)},comments:N>-1?n.substring(N+1):void 0};if(p.greeting=void 0,"1.99"!==k.versions.protocol&&"2.0"!==k.versions.protocol)return this.reset(),y("DEBUG: Parser: protocol version not supported: "+k.versions.protocol),r(new Error("Protocol version not supported"));if(this.emit("header",k),p.status===H)return;var R=k.identRaw,C=k.versions.software;this.debug("DEBUG: Remote ident: "+a(R));for(var L,P=0;P<O;++P)"string"==typeof(L=D[P])[0]?C===L[0]&&(this.remoteBugs|=L[1]):L[0].test(C)&&(this.remoteBugs|=L[1]);return p.identRaw=R,this.bytesReceived-=v-b,ve(this,(function(){b===v?r():_._transform(e.slice(b),t,r)})),void(p.status=K)}if(p.status===K)y("DEBUG: Parser: IN_PACKETBEFORE (expecting "+g.size+")"),ge(this,2,g.size,g.buf),p.status=F;else if(p.status===F){if(y("DEBUG: Parser: IN_PACKET"),f=g.instance&&g.isGCM,g.instance&&!g.isGCM&&(n=Ee(this,n)),!1===(o=E(n,0,this,r)))return;var X=p.hmac.size||0,Q=o+4+X,Y=this.maxPacketSize;if(m.instance&&(Y+=5*(this.maxPacketSize/16384+1)+6),o>Y||Q<16+X||(o+(f?0:4))%g.size!=0)return this.disconnect(A.PROTOCOL_ERROR),y("DEBUG: Parser: Bad packet length ("+Q+")"),r(new Error("Bad packet length"));p.pktLen=o;var $=p.pktLen+4-g.size;if(f?(g.instance.setAAD(n.slice(0,4)),y("DEBUG: Parser: pktLen:"+p.pktLen+",remainLen:"+$)):(p.padLen=n[4],y("DEBUG: Parser: pktLen:"+p.pktLen+",padLen:"+p.padLen+",remainLen:"+$)),$>0)p.pktExtra=f?n.slice(4):n.slice(5),ge(this,2,$),p.status=M;else{if(!($<0)){c=!0,p.status=M;continue}p.status=K}}else if(p.status===M){y("DEBUG: Parser: IN_PACKETDATA"),f=g.instance&&g.isGCM,!g.instance||c||f?c&&(c=!1):n=Ee(this,n);var Z=p.pktLen-p.padLen-1;p.pktExtra?(s=new Buffer(p.pktExtra.length+n.length),p.pktExtra.copy(s),n.copy(s,p.pktExtra.length),p.payload=s.slice(0,Z)):(s=f?n.slice(4):n.slice(5),p.payload=n.slice(5,5+Z)),void 0!==p.hmac.size?(y("DEBUG: Parser: HMAC size:"+p.hmac.size),ge(this,2,p.hmac.size,p.hmac.buf),p.status=q,p.packet=s):p.status=W,p.pktExtra=void 0,s=void 0}else if(p.status===q){if(y("DEBUG: Parser: IN_PACKETDATAVERIFY"),!de(this,n))return this.reset(),y("DEBUG: Parser: IN_PACKETDATAVERIFY (Invalid HMAC)"),r(new Error("Invalid HMAC"));y("DEBUG: Parser: IN_PACKETDATAVERIFY (Valid HMAC)"),p.status=W,p.packet=void 0}else if(p.status===W){if(m.instance){if(!i){y("DEBUG: Parser: Decompressing"),m.instance.write(p.payload);var J=[],re=0;return void m.instance.on("readable",(function(){for(var e;e=this.read();)J.push(e),re+=e.length})).flush(V,(function(){var i;m.instance.removeAllListeners("readable"),1===J.length?p.payload=J[0]:p.payload=Buffer.concat(J,re),J=null,i=b===v?te:e.slice(b),_._transform(i,t,r,!0)}))}i=!1}this.emit("packet");var ie=p.payload[0];if(y!==ue){var ne="DEBUG: Parser: IN_PACKETDATAAFTER, packet: ",se=h.kexdh,oe=h.authsQueue[0],ae=null;l.status!==z||ie<=4||ie>=20&&ie<=49||(ne+="(enqueued) "),ie===B.KEXDH_INIT?ae="group"===se?"KEXDH_INIT":"e"===se[0]?"KEXECDH_INIT":"KEXDH_GEX_REQUEST":ie===B.KEXDH_REPLY?ae="group"===se?"KEXDH_REPLY":"e"===se[0]?"KEXECDH_REPLY":"KEXDH_GEX_GROUP":ie===B.KEXDH_GEX_GROUP?ae="KEXDH_GEX_GROUP":ie===B.KEXDH_GEX_REPLY?ae="KEXDH_GEX_REPLY":60===ie?ae="password"===oe?"USERAUTH_PASSWD_CHANGEREQ":"keyboard-interactive"===oe?"USERAUTH_INFO_REQUEST":"publickey"===oe?"USERAUTH_PK_OK":"UNKNOWN PACKET 60":61===ie&&(ae="keyboard-interactive"===oe?"USERAUTH_INFO_RESPONSE":"UNKNOWN PACKET 61"),null===ae&&(ae=B[ie]),ie!==B.CHANNEL_OPEN&&ie!==B.CHANNEL_REQUEST&&ie!==B.CHANNEL_SUCCESS&&ie!==B.CHANNEL_FAILURE&&ie!==B.CHANNEL_EOF&&ie!==B.CHANNEL_CLOSE&&ie!==B.CHANNEL_DATA&&ie!==B.CHANNEL_EXTENDED_DATA&&ie!==B.CHANNEL_WINDOW_ADJUST&&ie!==B.DISCONNECT&&ie!==B.USERAUTH_REQUEST&&ie!==B.GLOBAL_REQUEST&&y(ne+ae)}if(l.status===j||ie<=4||ie>=20&&ie<=49){if(!1===pe(this,r))return;if(p.status===H)return}else if(l.status===z){if(50===p.rekeyQueue.length)return y("DEBUG: Parser: Max incoming re-key queue length reached"),this.disconnect(A.PROTOCOL_ERROR),r(new Error("Incoming re-key queue length limit reached"));var ce=p.seqno;++p.seqno>4294967295&&(p.seqno=0),p.rekeyQueue.push(ce,p.payload)}p.status=K,p.payload=void 0}}void 0!==n&&(n=void 0)}r()},fe.prototype.reset=function(e){if(this._state){var t=this._state;t.incoming.status=H,t.outgoing.status=X}else this._state={authsQueue:[],hostkeyFormat:void 0,kex:void 0,kexdh:void 0,incoming:{status:H,expectedPacket:void 0,search:void 0,greeting:void 0,seqno:0,pktLen:void 0,padLen:void 0,pktExtra:void 0,payload:void 0,packet:void 0,kexinit:void 0,identRaw:void 0,rekeyQueue:[],ignoreNext:!1,expect:{amount:void 0,type:void 0,ptr:0,buf:void 0},decrypt:{instance:!1,size:8,isGCM:!1,iv:void 0,key:void 0,buf:void 0,type:void 0},hmac:{size:void 0,key:void 0,buf:void 0,bufCompute:new Buffer(9),type:!1},decompress:{instance:!1,type:!1}},outgoing:{status:X,seqno:0,bufSeqno:new Buffer(4),rekeyQueue:[],kexinit:void 0,kexsecret:void 0,pubkey:void 0,exchangeHash:void 0,sessionId:void 0,sentNEWKEYS:!1,encrypt:{instance:!1,size:8,isGCM:!1,iv:void 0,key:void 0,type:void 0},hmac:{size:void 0,key:void 0,buf:void 0,type:!1},compress:{instance:!1,type:!1}}};e||this.readable&&this.push(null)},fe.prototype.disconnect=function(e){var t=new Buffer(13);return t.fill(0),t[0]=B.DISCONNECT,void 0===A[e]&&(e=A.BY_APPLICATION),t.writeUInt32BE(e,1,!0),this.debug("DEBUG: Outgoing: Writing DISCONNECT ("+A[e]+")"),ye(this,t),this.reset(),!1},fe.prototype.ping=function(){return this.debug("DEBUG: Outgoing: Writing ping (GLOBAL_REQUEST: keepalive@openssh.com)"),ye(this,re)},fe.prototype.rekey=function(){var e=this._state.outgoing.status;if(e===z)throw new Error("A re-key is already in progress");if(e!==j)throw new Error("Cannot re-key yet");return this.debug("DEBUG: Outgoing: Starting re-key"),ve(this)},fe.prototype.requestSuccess=function(e){var t;return Buffer.isBuffer(e)?((t=new Buffer(1+e.length))[0]=B.REQUEST_SUCCESS,e.copy(t,1)):t=se,this.debug("DEBUG: Outgoing: Writing REQUEST_SUCCESS"),ye(this,t)},fe.prototype.requestFailure=function(){return this.debug("DEBUG: Outgoing: Writing REQUEST_FAILURE"),ye(this,oe)},fe.prototype.channelSuccess=function(e){var t=new Buffer(5);return t[0]=B.CHANNEL_SUCCESS,t.writeUInt32BE(e,1,!0),this.debug("DEBUG: Outgoing: Writing CHANNEL_SUCCESS ("+e+")"),ye(this,t)},fe.prototype.channelFailure=function(e){var t=new Buffer(5);return t[0]=B.CHANNEL_FAILURE,t.writeUInt32BE(e,1,!0),this.debug("DEBUG: Outgoing: Writing CHANNEL_FAILURE ("+e+")"),ye(this,t)},fe.prototype.channelEOF=function(e){var t=new Buffer(5);return t[0]=B.CHANNEL_EOF,t.writeUInt32BE(e,1,!0),this.debug("DEBUG: Outgoing: Writing CHANNEL_EOF ("+e+")"),ye(this,t)},fe.prototype.channelClose=function(e){var t=new Buffer(5);return t[0]=B.CHANNEL_CLOSE,t.writeUInt32BE(e,1,!0),this.debug("DEBUG: Outgoing: Writing CHANNEL_CLOSE ("+e+")"),ye(this,t)},fe.prototype.channelWindowAdjust=function(e,t){var r=new Buffer(9);return r[0]=B.CHANNEL_WINDOW_ADJUST,r.writeUInt32BE(e,1,!0),r.writeUInt32BE(t,5,!0),this.debug("DEBUG: Outgoing: Writing CHANNEL_WINDOW_ADJUST ("+e+", "+t+")"),ye(this,r)},fe.prototype.channelData=function(e,t){var r=Buffer.isBuffer(t),i=r?t.length:Buffer.byteLength(t),n=new Buffer(9+i);return n[0]=B.CHANNEL_DATA,n.writeUInt32BE(e,1,!0),n.writeUInt32BE(i,5,!0),r?t.copy(n,9):n.write(t,9,i,"utf8"),this.debug("DEBUG: Outgoing: Writing CHANNEL_DATA ("+e+")"),ye(this,n)},fe.prototype.channelExtData=function(e,t,r){var i=Buffer.isBuffer(t),n=i?t.length:Buffer.byteLength(t),s=new Buffer(13+n);return s[0]=B.CHANNEL_EXTENDED_DATA,s.writeUInt32BE(e,1,!0),s.writeUInt32BE(r,5,!0),s.writeUInt32BE(n,9,!0),i?t.copy(s,13):s.write(t,13,n,"utf8"),this.debug("DEBUG: Outgoing: Writing CHANNEL_EXTENDED_DATA ("+e+")"),ye(this,s)},fe.prototype.channelOpenConfirm=function(e,t,r,i){var n=new Buffer(17);return n[0]=B.CHANNEL_OPEN_CONFIRMATION,n.writeUInt32BE(e,1,!0),n.writeUInt32BE(t,5,!0),n.writeUInt32BE(r,9,!0),n.writeUInt32BE(i,13,!0),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN_CONFIRMATION (r:"+e+", l:"+t+")"),ye(this,n)},fe.prototype.channelOpenFail=function(e,t,r,i){"string"!=typeof r&&(r=""),"string"!=typeof i&&(i="");var n=Buffer.byteLength(r),s=Buffer.byteLength(i),o=9,a=new Buffer(13+n+4+s);return a[0]=B.CHANNEL_OPEN_FAILURE,a.writeUInt32BE(e,1,!0),a.writeUInt32BE(t,5,!0),a.writeUInt32BE(n,o,!0),o+=4,n&&(a.write(r,o,n,"utf8"),o+=n),a.writeUInt32BE(s,o,!0),s&&a.write(i,o+=4,s,"ascii"),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN_FAILURE ("+e+")"),ye(this,a)},fe.prototype.service=function(e){if(this.server)throw new Error("Client-only method called in server mode");var t=Buffer.byteLength(e),r=new Buffer(5+t);return r[0]=B.SERVICE_REQUEST,r.writeUInt32BE(t,1,!0),r.write(e,5,t,"ascii"),this.debug("DEBUG: Outgoing: Writing SERVICE_REQUEST ("+e+")"),ye(this,r)},fe.prototype.tcpipForward=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=Buffer.byteLength(e),n=new Buffer(23+i+4);return n[0]=B.GLOBAL_REQUEST,n.writeUInt32BE(13,1,!0),n.write("tcpip-forward",5,13,"ascii"),n[18]=void 0===r||!0===r?1:0,n.writeUInt32BE(i,19,!0),n.write(e,23,i,"ascii"),n.writeUInt32BE(t,23+i,!0),this.debug("DEBUG: Outgoing: Writing GLOBAL_REQUEST (tcpip-forward)"),ye(this,n)},fe.prototype.cancelTcpipForward=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=Buffer.byteLength(e),n=new Buffer(30+i+4);return n[0]=B.GLOBAL_REQUEST,n.writeUInt32BE(20,1,!0),n.write("cancel-tcpip-forward",5,20,"ascii"),n[25]=void 0===r||!0===r?1:0,n.writeUInt32BE(i,26,!0),n.write(e,30,i,"ascii"),n.writeUInt32BE(t,30+i,!0),this.debug("DEBUG: Outgoing: Writing GLOBAL_REQUEST (cancel-tcpip-forward)"),ye(this,n)},fe.prototype.openssh_streamLocalForward=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=Buffer.byteLength(e),i=new Buffer(41+r);return i[0]=B.GLOBAL_REQUEST,i.writeUInt32BE(31,1,!0),i.write("streamlocal-forward@openssh.com",5,31,"ascii"),i[36]=void 0===t||!0===t?1:0,i.writeUInt32BE(r,37,!0),i.write(e,41,r,"utf8"),this.debug("DEBUG: Outgoing: Writing GLOBAL_REQUEST (streamlocal-forward@openssh.com)"),ye(this,i)},fe.prototype.openssh_cancelStreamLocalForward=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=Buffer.byteLength(e),i=new Buffer(48+r);return i[0]=B.GLOBAL_REQUEST,i.writeUInt32BE(38,1,!0),i.write("cancel-streamlocal-forward@openssh.com",5,38,"ascii"),i[43]=void 0===t||!0===t?1:0,i.writeUInt32BE(r,44,!0),i.write(e,48,r,"utf8"),this.debug("DEBUG: Outgoing: Writing GLOBAL_REQUEST (cancel-streamlocal-forward@openssh.com)"),ye(this,i)},fe.prototype.directTcpip=function(e,t,r,i){if(this.server)throw new Error("Client-only method called in server mode");var n=Buffer.byteLength(i.srcIP),s=Buffer.byteLength(i.dstIP),o=29,a=new Buffer(33+n+4+4+s+4);return a[0]=B.CHANNEL_OPEN,a.writeUInt32BE(12,1,!0),a.write("direct-tcpip",5,12,"ascii"),a.writeUInt32BE(e,17,!0),a.writeUInt32BE(t,21,!0),a.writeUInt32BE(r,25,!0),a.writeUInt32BE(s,o,!0),a.write(i.dstIP,o+=4,s,"ascii"),a.writeUInt32BE(i.dstPort,o+=s,!0),a.writeUInt32BE(n,o+=4,!0),a.write(i.srcIP,o+=4,n,"ascii"),a.writeUInt32BE(i.srcPort,o+=n,!0),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN ("+e+", direct-tcpip)"),ye(this,a)},fe.prototype.openssh_directStreamLocal=function(e,t,r,i){if(this.server)throw new Error("Client-only method called in server mode");var n=Buffer.byteLength(i.socketPath),s=47,o=new Buffer(51+n+4+4);return o[0]=B.CHANNEL_OPEN,o.writeUInt32BE(30,1,!0),o.write("direct-streamlocal@openssh.com",5,30,"ascii"),o.writeUInt32BE(e,35,!0),o.writeUInt32BE(t,39,!0),o.writeUInt32BE(r,43,!0),o.writeUInt32BE(n,s,!0),o.write(i.socketPath,s+=4,n,"utf8"),o.fill(0,o.length-8),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN ("+e+", direct-streamlocal@openssh.com)"),ye(this,o)},fe.prototype.openssh_noMoreSessions=function(e){if(this.server)throw new Error("Client-only method called in server mode");var t=new Buffer(34);return t[0]=B.GLOBAL_REQUEST,t.writeUInt32BE(28,1,!0),t.write("no-more-sessions@openssh.com",5,28,"ascii"),t[33]=void 0===e||!0===e?1:0,this.debug("DEBUG: Outgoing: Writing GLOBAL_REQUEST (no-more-sessions@openssh.com)"),ye(this,t)},fe.prototype.session=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=new Buffer(24);return i[0]=B.CHANNEL_OPEN,i.writeUInt32BE(7,1,!0),i.write("session",5,7,"ascii"),i.writeUInt32BE(e,12,!0),i.writeUInt32BE(t,16,!0),i.writeUInt32BE(r,20,!0),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN ("+e+", session)"),ye(this,i)},fe.prototype.windowChange=function(e,t,r,i,n){if(this.server)throw new Error("Client-only method called in server mode");var s=new Buffer(39);return s[0]=B.CHANNEL_REQUEST,s.writeUInt32BE(e,1,!0),s.writeUInt32BE(13,5,!0),s.write("window-change",9,13,"ascii"),s[22]=0,s.writeUInt32BE(r,23,!0),s.writeUInt32BE(t,27,!0),s.writeUInt32BE(n,31,!0),s.writeUInt32BE(i,35,!0),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", window-change)"),ye(this,s)},fe.prototype.pty=function(e,t,r,i,n,s,o,a){if(this.server)throw new Error("Client-only method called in server mode");s&&s.length||(s="vt100"),!o||Buffer.isBuffer(o)||Array.isArray(o)||"object"!=typeof o||(o=function(e){for(var t,r,i,n=/^\d+$/,s=Object.keys(e),o=0,a=[],c=0,u=s.length;c<u;++c)t=s[c],(r=k[t])&&!n.test(t)&&"number"==typeof e[t]&&"TTY_OP_END"!==t&&(i=e[t],a[o++]=r,a[o++]=i>>>24&255,a[o++]=i>>>16&255,a[o++]=i>>>8&255,a[o++]=255&i);return a[o]=k.TTY_OP_END,a}(o)),o&&o.length||(o=ae);var c=s.length,u=o.length,f=21,h=new Buffer(21+c+4+4+4+4+4+u);if(h[0]=B.CHANNEL_REQUEST,h.writeUInt32BE(e,1,!0),h.writeUInt32BE(7,5,!0),h.write("pty-req",9,7,"ascii"),h[16]=void 0===a||!0===a?1:0,h.writeUInt32BE(c,17,!0),h.write(s,21,c,"utf8"),h.writeUInt32BE(r,f+=c,!0),h.writeUInt32BE(t,f+=4,!0),h.writeUInt32BE(n,f+=4,!0),h.writeUInt32BE(i,f+=4,!0),h.writeUInt32BE(u,f+=4,!0),f+=4,Array.isArray(o))for(var p=0;p<u;++p)h[f++]=o[p];else Buffer.isBuffer(o)&&o.copy(h,f);return this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", pty-req)"),ye(this,h)},fe.prototype.shell=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=new Buffer(15);return r[0]=B.CHANNEL_REQUEST,r.writeUInt32BE(e,1,!0),r.writeUInt32BE(5,5,!0),r.write("shell",9,5,"ascii"),r[14]=void 0===t||!0===t?1:0,this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", shell)"),ye(this,r)},fe.prototype.exec=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=Buffer.isBuffer(t)?t.length:Buffer.byteLength(t),n=new Buffer(18+i);return n[0]=B.CHANNEL_REQUEST,n.writeUInt32BE(e,1,!0),n.writeUInt32BE(4,5,!0),n.write("exec",9,4,"ascii"),n[13]=void 0===r||!0===r?1:0,n.writeUInt32BE(i,14,!0),Buffer.isBuffer(t)?t.copy(n,18):n.write(t,18,i,"utf8"),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", exec)"),ye(this,n)},fe.prototype.signal=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");if("SIG"===(t=t.toUpperCase()).slice(0,3)&&(t=t.substring(3)),-1===R.indexOf(t))throw new Error("Invalid signal: "+t);var r=t.length,i=new Buffer(20+r);return i[0]=B.CHANNEL_REQUEST,i.writeUInt32BE(e,1,!0),i.writeUInt32BE(6,5,!0),i.write("signal",9,6,"ascii"),i[15]=0,i.writeUInt32BE(r,16,!0),i.write(t,20,r,"ascii"),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", signal)"),ye(this,i)},fe.prototype.env=function(e,t,r,i){if(this.server)throw new Error("Client-only method called in server mode");var n=Buffer.byteLength(t),s=Buffer.isBuffer(r)?r.length:Buffer.byteLength(r),o=new Buffer(17+n+4+s);return o[0]=B.CHANNEL_REQUEST,o.writeUInt32BE(e,1,!0),o.writeUInt32BE(3,5,!0),o.write("env",9,3,"ascii"),o[12]=void 0===i||!0===i?1:0,o.writeUInt32BE(n,13,!0),o.write(t,17,n,"ascii"),o.writeUInt32BE(s,17+n,!0),Buffer.isBuffer(r)?r.copy(o,17+n+4):o.write(r,17+n+4,s,"utf8"),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", env)"),ye(this,o)},fe.prototype.x11Forward=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=Buffer.byteLength(t.protocol),n=Buffer.byteLength(t.cookie),s=new Buffer(22+i+4+n+4);s[0]=B.CHANNEL_REQUEST,s.writeUInt32BE(e,1,!0),s.writeUInt32BE(7,5,!0),s.write("x11-req",9,7,"ascii"),s[16]=void 0===r||!0===r?1:0,s[17]=t.single?1:0,s.writeUInt32BE(i,18,!0);var o=22;return Buffer.isBuffer(t.protocol)?t.protocol.copy(s,o):s.write(t.protocol,o,i,"utf8"),o+=i,s.writeUInt32BE(n,o,!0),o+=4,Buffer.isBuffer(t.cookie)?t.cookie.copy(s,o):s.write(t.cookie,o,n,"utf8"),o+=n,s.writeUInt32BE(t.screen||0,o,!0),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", x11-req)"),ye(this,s)},fe.prototype.subsystem=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=Buffer.byteLength(t),n=new Buffer(23+i);return n[0]=B.CHANNEL_REQUEST,n.writeUInt32BE(e,1,!0),n.writeUInt32BE(9,5,!0),n.write("subsystem",9,9,"ascii"),n[18]=void 0===r||!0===r?1:0,n.writeUInt32BE(i,19,!0),n.write(t,23,i,"ascii"),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", subsystem: "+t+")"),ye(this,n)},fe.prototype.openssh_agentForward=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=new Buffer(36);return r[0]=B.CHANNEL_REQUEST,r.writeUInt32BE(e,1,!0),r.writeUInt32BE(26,5,!0),r.write("auth-agent-req@openssh.com",9,26,"ascii"),r[35]=void 0===t||!0===t?1:0,this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", auth-agent-req@openssh.com)"),ye(this,r)},fe.prototype.authPassword=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=Buffer.byteLength(e),i=Buffer.byteLength(t),n=0,s=new Buffer(5+r+4+14+4+8+1+4+i);return s[n]=B.USERAUTH_REQUEST,s.writeUInt32BE(r,++n,!0),s.write(e,n+=4,r,"utf8"),s.writeUInt32BE(14,n+=r,!0),s.write("ssh-connection",n+=4,14,"ascii"),s.writeUInt32BE(8,n+=14,!0),s.write("password",n+=4,8,"ascii"),s[n+=8]=0,s.writeUInt32BE(i,++n,!0),s.write(t,n+=4,i,"utf8"),this._state.authsQueue.push("password"),this.debug("DEBUG: Outgoing: Writing USERAUTH_REQUEST (password)"),ye(this,s)},fe.prototype.authPK=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i,n=this,s=this._state.outgoing;t.public?(i=t.fulltype,t=t.public):i=t.toString("ascii",4,4+t.readUInt32BE(0,!0));var o=Buffer.byteLength(e),a=Buffer.byteLength(i),c=t.length,u=s.sessionId.length,f=0,h=new Buffer((r?4+u:0)+1+4+o+4+14+4+9+1+4+a+4+c);return r?(h.writeUInt32BE(u,f,!0),s.sessionId.copy(h,f+=4),h[f+=u]=B.USERAUTH_REQUEST):h[f]=B.USERAUTH_REQUEST,h.writeUInt32BE(o,++f,!0),h.write(e,f+=4,o,"utf8"),h.writeUInt32BE(14,f+=o,!0),h.write("ssh-connection",f+=4,14,"ascii"),h.writeUInt32BE(9,f+=14,!0),h.write("publickey",f+=4,9,"ascii"),h[f+=9]=r?1:0,h.writeUInt32BE(a,++f,!0),h.write(i,f+=4,a,"ascii"),h.writeUInt32BE(c,f+=a,!0),t.copy(h,f+=4),r?(r(h,(function(r){"ssh-dss"===i?r=g(r):"ssh-rsa"!==i&&(r=w(r));var s=r.length,u=new Buffer(5+o+4+14+4+9+1+4+a+4+c+4+4+a+4+s);return u[f=0]=B.USERAUTH_REQUEST,u.writeUInt32BE(o,++f,!0),u.write(e,f+=4,o,"utf8"),u.writeUInt32BE(14,f+=o,!0),u.write("ssh-connection",f+=4,14,"ascii"),u.writeUInt32BE(9,f+=14,!0),u.write("publickey",f+=4,9,"ascii"),u[f+=9]=1,u.writeUInt32BE(a,++f,!0),u.write(i,f+=4,a,"ascii"),u.writeUInt32BE(c,f+=a,!0),t.copy(u,f+=4),u.writeUInt32BE(4+a+4+s,f+=c,!0),u.writeUInt32BE(a,f+=4,!0),u.write(i,f+=4,a,"ascii"),u.writeUInt32BE(s,f+=a,!0),r.copy(u,f+=4),n._state.authsQueue.push("publickey"),n.debug("DEBUG: Outgoing: Writing USERAUTH_REQUEST (publickey)"),ye(n,u)})),!0):(this._state.authsQueue.push("publickey"),this.debug("DEBUG: Outgoing: Writing USERAUTH_REQUEST (publickey -- check)"),ye(this,h))},fe.prototype.authHostbased=function(e,t,r,i,n){if(this.server)throw new Error("Client-only method called in server mode");var s,o=this,a=this._state.outgoing;t.public?(s=t.fulltype,t=t.public):s=t.toString("ascii",4,4+t.readUInt32BE(0,!0));var c=Buffer.byteLength(e),u=Buffer.byteLength(s),f=t.length,h=a.sessionId.length,p=Buffer.byteLength(r),l=Buffer.byteLength(i),d=0,E=new Buffer(4+h+1+4+c+4+14+4+9+4+u+4+f+4+p+4+l);return E.writeUInt32BE(h,d,!0),a.sessionId.copy(E,d+=4),E[d+=h]=B.USERAUTH_REQUEST,E.writeUInt32BE(c,++d,!0),E.write(e,d+=4,c,"utf8"),E.writeUInt32BE(14,d+=c,!0),E.write("ssh-connection",d+=4,14,"ascii"),E.writeUInt32BE(9,d+=14,!0),E.write("hostbased",d+=4,9,"ascii"),E.writeUInt32BE(u,d+=9,!0),E.write(s,d+=4,u,"ascii"),E.writeUInt32BE(f,d+=u,!0),t.copy(E,d+=4),E.writeUInt32BE(p,d+=f,!0),E.write(r,d+=4,p,"ascii"),E.writeUInt32BE(l,d+=p,!0),E.write(i,d+=4,l,"utf8"),n(E,(function(e){"ssh-dss"===s?e=g(e):"ssh-rsa"!==s&&(e=w(e));var t=e.length,r=new Buffer(E.length-h+t);return E.copy(r,0,4+h),r.writeUInt32BE(t,r.length-t-4,!0),e.copy(r,r.length-t),o._state.authsQueue.push("hostbased"),o.debug("DEBUG: Outgoing: Writing USERAUTH_REQUEST (hostbased)"),ye(o,r)})),!0},fe.prototype.authKeyboard=function(e){if(this.server)throw new Error("Client-only method called in server mode");var t=Buffer.byteLength(e),r=0,i=new Buffer(5+t+4+14+4+20+4+4);return i[r]=B.USERAUTH_REQUEST,i.writeUInt32BE(t,++r,!0),i.write(e,r+=4,t,"utf8"),i.writeUInt32BE(14,r+=t,!0),i.write("ssh-connection",r+=4,14,"ascii"),i.writeUInt32BE(20,r+=14,!0),i.write("keyboard-interactive",r+=4,20,"ascii"),i.writeUInt32BE(0,r+=20,!0),i.writeUInt32BE(0,r+=4,!0),this._state.authsQueue.push("keyboard-interactive"),this.debug("DEBUG: Outgoing: Writing USERAUTH_REQUEST (keyboard-interactive)"),ye(this,i)},fe.prototype.authNone=function(e){if(this.server)throw new Error("Client-only method called in server mode");var t=Buffer.byteLength(e),r=0,i=new Buffer(5+t+4+14+4+4);return i[r]=B.USERAUTH_REQUEST,i.writeUInt32BE(t,++r,!0),i.write(e,r+=4,t,"utf8"),i.writeUInt32BE(14,r+=t,!0),i.write("ssh-connection",r+=4,14,"ascii"),i.writeUInt32BE(4,r+=14,!0),i.write("none",r+=4,4,"ascii"),this._state.authsQueue.push("none"),this.debug("DEBUG: Outgoing: Writing USERAUTH_REQUEST (none)"),ye(this,i)},fe.prototype.authInfoRes=function(e){if(this.server)throw new Error("Client-only method called in server mode");var t,r,i,n=0,s=0;if(e)for(i=0,r=e.length;i<r;++i)n+=4+Buffer.byteLength(e[i]);var o=new Buffer(5+n);if(o[s++]=B.USERAUTH_INFO_RESPONSE,o.writeUInt32BE(e?e.length:0,s,!0),e)for(s+=4,i=0,r=e.length;i<r;++i)t=Buffer.byteLength(e[i]),o.writeUInt32BE(t,s,!0),s+=4,t&&(o.write(e[i],s,t,"utf8"),s+=t);return this.debug("DEBUG: Outgoing: Writing USERAUTH_INFO_RESPONSE"),ye(this,o)},fe.prototype.serviceAccept=function(e){if(!this.server)throw new Error("Server-only method called in client mode");var t=e.length,r=new Buffer(5+t);if(r[0]=B.SERVICE_ACCEPT,r.writeUInt32BE(t,1,!0),r.write(e,5,t,"ascii"),this.debug("DEBUG: Outgoing: Writing SERVICE_ACCEPT ("+e+")"),ye(this,r),this.server&&this.banner&&"ssh-userauth"===e){var i=Buffer.byteLength(this.banner),n=5+i+4;n>c&&(i-=9,n-=9);var s=new Buffer(n);s[0]=B.USERAUTH_BANNER,s.writeUInt32BE(i,1,!0),s.write(this.banner,5,i,"utf8"),s.fill(0,n-4),this.debug("DEBUG: Outgoing: Writing USERAUTH_BANNER"),ye(this,s),this.banner=void 0}},fe.prototype.forwardedTcpip=function(e,t,r,i){if(!this.server)throw new Error("Server-only method called in client mode");var n=Buffer.byteLength(i.boundAddr),s=Buffer.byteLength(i.remoteAddr),o=36+n,a=new Buffer(36+n+4+4+s+4);return a[0]=B.CHANNEL_OPEN,a.writeUInt32BE(15,1,!0),a.write("forwarded-tcpip",5,15,"ascii"),a.writeUInt32BE(e,20,!0),a.writeUInt32BE(t,24,!0),a.writeUInt32BE(r,28,!0),a.writeUInt32BE(n,32,!0),a.write(i.boundAddr,36,n,"ascii"),a.writeUInt32BE(i.boundPort,o,!0),a.writeUInt32BE(s,o+=4,!0),a.write(i.remoteAddr,o+=4,s,"ascii"),a.writeUInt32BE(i.remotePort,o+=s,!0),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN ("+e+", forwarded-tcpip)"),ye(this,a)},fe.prototype.x11=function(e,t,r,i){if(!this.server)throw new Error("Server-only method called in client mode");var n=Buffer.byteLength(i.originAddr),s=24+n,o=new Buffer(24+n+4);return o[0]=B.CHANNEL_OPEN,o.writeUInt32BE(3,1,!0),o.write("x11",5,3,"ascii"),o.writeUInt32BE(e,8,!0),o.writeUInt32BE(t,12,!0),o.writeUInt32BE(r,16,!0),o.writeUInt32BE(n,20,!0),o.write(i.originAddr,24,n,"ascii"),o.writeUInt32BE(i.originPort,s,!0),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN ("+e+", x11)"),ye(this,o)},fe.prototype.openssh_forwardedStreamLocal=function(e,t,r,i){if(!this.server)throw new Error("Server-only method called in client mode");var n=Buffer.byteLength(i.socketPath),s=new Buffer(54+n+4);return s[0]=B.CHANNEL_OPEN,s.writeUInt32BE(33,1,!0),s.write("forwarded-streamlocal@openssh.com",5,33,"ascii"),s.writeUInt32BE(e,38,!0),s.writeUInt32BE(t,42,!0),s.writeUInt32BE(r,46,!0),s.writeUInt32BE(n,50,!0),s.write(i.socketPath,54,n,"utf8"),s.writeUInt32BE(0,54+n,!0),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN ("+e+", forwarded-streamlocal@openssh.com)"),ye(this,s)},fe.prototype.exitStatus=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");var r=new Buffer(25);return r[0]=B.CHANNEL_REQUEST,r.writeUInt32BE(e,1,!0),r.writeUInt32BE(11,5,!0),r.write("exit-status",9,11,"ascii"),r[20]=0,r.writeUInt32BE(t,21,!0),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", exit-status)"),ye(this,r)},fe.prototype.exitSignal=function(e,t,r,i){if(!this.server)throw new Error("Server-only method called in client mode");var n=Buffer.byteLength(t),s=i?Buffer.byteLength(i):0,o=25+n,a=new Buffer(25+n+1+4+s+4);return a[0]=B.CHANNEL_REQUEST,a.writeUInt32BE(e,1,!0),a.writeUInt32BE(11,5,!0),a.write("exit-signal",9,11,"ascii"),a[20]=0,a.writeUInt32BE(n,21,!0),a.write(t,25,n,"utf8"),a[o++]=r?1:0,a.writeUInt32BE(s,o,!0),o+=4,s&&(a.write(i,o,s,"utf8"),o+=s),a.writeUInt32BE(0,o,!0),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", exit-signal)"),ye(this,a)},fe.prototype.authFailure=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");var r;if(!this._state.authsQueue.length)throw new Error("No auth in progress");if("boolean"==typeof e&&(t=e,e=void 0),e){r=[];for(var i=0,n=e.length;i<n;++i)"none"!==e[i].toLowerCase()&&r.push(e[i]);r=r.join(",")}else r="";var s=r.length,o=new Buffer(5+s+1);return o[0]=B.USERAUTH_FAILURE,o.writeUInt32BE(s,1,!0),o.write(r,5,s,"ascii"),o[5+s]=!0===t?1:0,this._state.authsQueue.shift(),this.debug("DEBUG: Outgoing: Writing USERAUTH_FAILURE"),ye(this,o)},fe.prototype.authSuccess=function(){if(!this.server)throw new Error("Server-only method called in client mode");if(!this._state.authsQueue.length)throw new Error("No auth in progress");return this._state.authsQueue.shift(),this.debug("DEBUG: Outgoing: Writing USERAUTH_SUCCESS"),ye(this,ne)},fe.prototype.authPKOK=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");var r=this._state.authsQueue;if(!r.length||"publickey"!==r[0])throw new Error('"publickey" auth not in progress');var i=e.length,n=t.length,s=new Buffer(5+i+4+n);return s[0]=B.USERAUTH_PK_OK,s.writeUInt32BE(i,1,!0),s.write(e,5,i,"ascii"),s.writeUInt32BE(n,5+i,!0),t.copy(s,5+i+4),this._state.authsQueue.shift(),this.debug("DEBUG: Outgoing: Writing USERAUTH_PK_OK"),ye(this,s)},fe.prototype.authPasswdChg=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");var r=Buffer.byteLength(e),i=t?t.length:0,n=0,s=new Buffer(5+r+4+i);return s[n]=B.USERAUTH_PASSWD_CHANGEREQ,s.writeUInt32BE(r,++n,!0),s.write(e,n+=4,r,"utf8"),s.writeUInt32BE(i,n+=r,!0),i&&s.write(t,n+=4,i,"ascii"),this.debug("DEBUG: Outgoing: Writing USERAUTH_PASSWD_CHANGEREQ"),ye(this,s)},fe.prototype.authInfoReq=function(e,t,r){if(!this.server)throw new Error("Server-only method called in client mode");var i,n,s,o,a=0,c=e?Buffer.byteLength(e):0,u=t?Buffer.byteLength(t):0,f=0;for(o=0,s=r.length;o<s;++o)a+=4+Buffer.byteLength(r[o].prompt)+1;var h=new Buffer(5+c+4+u+4+4+a);for(h[f++]=B.USERAUTH_INFO_REQUEST,h.writeUInt32BE(c,f,!0),f+=4,e&&(h.write(e,f,c,"utf8"),f+=c),h.writeUInt32BE(u,f,!0),f+=4,t&&(h.write(t,f,u,"utf8"),f+=u),h.writeUInt32BE(0,f,!0),f+=4,h.writeUInt32BE(r.length,f,!0),f+=4,o=0,s=r.length;o<s;++o)n=r[o],i=Buffer.byteLength(n.prompt),h.writeUInt32BE(i,f,!0),f+=4,i&&(h.write(n.prompt,f,i,"utf8"),f+=i),h[f++]=n.echo?1:0;return this.debug("DEBUG: Outgoing: Writing USERAUTH_INFO_REQUEST"),ye(this,h)},e.exports=fe,e.exports._send=ye},564:function(e,t,r){var i=r(4).EventEmitter;function n(e,t,r,i,n){for(var s=0;s<n;++s,++t,++i)if(e[t]!==r[i])return!1;return!0}function s(e){"string"==typeof e&&(e=new Buffer(e));var t,r,i=e.length;for(this.maxMatches=1/0,this.matches=0,this._occ=new Array(256),this._lookbehind_size=0,this._needle=e,this._bufpos=0,this._lookbehind=new Buffer(i),r=0;r<256;++r)this._occ[r]=i;if(i>=1)for(t=0;t<i-1;++t)this._occ[e[t]]=i-1-t}(0,r(0).inherits)(s,i),s.prototype.reset=function(){this._lookbehind_size=0,this.matches=0,this._bufpos=0},s.prototype.push=function(e,t){var r,i;for(Buffer.isBuffer(e)||(e=new Buffer(e,"binary")),i=e.length,this._bufpos=t||0;r!==i&&this.matches<this.maxMatches;)r=this._sbmh_feed(e);return r},s.prototype._sbmh_feed=function(e){var t=e.length,r=this._needle,i=r.length,s=-this._lookbehind_size,o=r[i-1],a=this._occ,c=this._lookbehind;if(s<0){for(;s<0&&s<=t-i;){if((f=this._sbmh_lookup_char(e,s+i-1))===o&&this._sbmh_memcmp(e,s,i-1))return this._lookbehind_size=0,++this.matches,s>-this._lookbehind_size?this.emit("info",!0,c,0,this._lookbehind_size+s):this.emit("info",!0),this._bufpos=s+i,s+i;s+=a[f]}if(s<0)for(;s<0&&!this._sbmh_memcmp(e,s,t-s);)s++;if(!(s>=0)){var u=this._lookbehind_size+s;return u>0&&this.emit("info",!1,c,0,u),c.copy(c,0,u,this._lookbehind_size-u),this._lookbehind_size-=u,e.copy(c,this._lookbehind_size),this._lookbehind_size+=t,this._bufpos=t,t}this.emit("info",!1,c,0,this._lookbehind_size),this._lookbehind_size=0}for(s>=0&&(s+=this._bufpos);s<=t-i;){var f;if((f=e[s+i-1])===o&&e[s]===r[0]&&n(r,0,e,s,i-1))return++this.matches,s>0?this.emit("info",!0,e,this._bufpos,s):this.emit("info",!0),this._bufpos=s+i,s+i;s+=a[f]}if(s<t){for(;s<t&&(e[s]!==r[0]||!n(e,s,r,0,t-s));)++s;s<t&&(e.copy(c,0,s,s+(t-s)),this._lookbehind_size=t-s)}return s>0&&this.emit("info",!1,e,this._bufpos,s<t?s:t),this._bufpos=t,t},s.prototype._sbmh_lookup_char=function(e,t){return t<0?this._lookbehind[this._lookbehind_size+t]:e[t]},s.prototype._sbmh_memcmp=function(e,t,r){for(var i=0;i<r;){if(this._sbmh_lookup_char(e,t+i)!==this._needle[i])return!1;++i}return!0},e.exports=s},565:function(e){e.exports=JSON.parse('{"_from":"ssh2-streams@~0.1.15","_id":"ssh2-streams@0.1.20","_inBundle":false,"_integrity":"sha1-URGNFUVV31Rp7h9n4M8efoosDjo=","_location":"/ssh2/ssh2-streams","_phantomChildren":{},"_requested":{"type":"range","registry":true,"raw":"ssh2-streams@~0.1.15","name":"ssh2-streams","escapedName":"ssh2-streams","rawSpec":"~0.1.15","saveSpec":null,"fetchSpec":"~0.1.15"},"_requiredBy":["/ssh2"],"_resolved":"https://registry.npm.taobao.org/ssh2-streams/download/ssh2-streams-0.1.20.tgz","_shasum":"51118d154555df5469ee1f67e0cf1e7e8a2c0e3a","_spec":"ssh2-streams@~0.1.15","_where":"D:\\\\git\\\\vscode-mysql\\\\node_modules\\\\ssh2","author":{"name":"Brian White","email":"mscdex@mscdex.net"},"bugs":{"url":"https://github.com/mscdex/ssh2-streams/issues"},"bundleDependencies":false,"dependencies":{"asn1":"~0.2.0","semver":"^5.1.0","streamsearch":"~0.1.2"},"deprecated":false,"description":"SSH2 and SFTP(v3) client/server protocol streams for node.js","engines":{"node":">=0.10.0"},"homepage":"https://github.com/mscdex/ssh2-streams#readme","keywords":["ssh","ssh2","sftp","secure","protocol","streams","client","server"],"licenses":[{"type":"MIT","url":"http://github.com/mscdex/ssh2-streams/raw/master/LICENSE"}],"main":"./index","name":"ssh2-streams","repository":{"type":"git","url":"git+ssh://git@github.com/mscdex/ssh2-streams.git"},"scripts":{"test":"node test/test.js"},"version":"0.1.20"}')},566:function(e,t,r){(function(t){var i=r(18).Socket,n=r(4).EventEmitter,s=r(0).inherits,o=r(47),a=r(19),c=r(133),u=/^\!<socket >(\d+) s ([A-Z0-9]{8}\-[A-Z0-9]{8}\-[A-Z0-9]{8}\-[A-Z0-9]{8})/;if(e.exports=function(e,t,r,n,s){var o,f,h,l,d,E,g,m,v=0,w=Buffer.isBuffer(t),y=0,_=0,b=0,B=0,S=!1;function U(){var e;if(w){var r=9;(e=new Buffer(9+v+4+l+4)).writeUInt32BE(e.length-4,0,!0),e[4]=13,e.writeUInt32BE(v,5,!0),t.copy(e,r),e.writeUInt32BE(l,r+=v,!0),n.copy(e,r+=4),e.writeUInt32BE(0,r+=l,!0),o.write(e)}else o.write(new Buffer([0,0,0,1,11]))}function I(e){for(var r=0,i=e.length;r<i;++r)if(void 0===d)5==++y&&(d=e[r],y=0);else if(14===d)if(h){if(h[y]=e[r],++y===_)return o.removeAllListeners("data"),o.destroy()}else _<<=8,_+=e[r],4==++y&&(h=new Buffer(_),y=0);else if(12===d)if(void 0===E){if(b<<=8,b+=e[r],4==++y&&(E=new Array(b),y=0,0===b))return o.removeAllListeners("data"),o.destroy()}else if(t)if(!1===S){if(t[y]=e[r],++y===v&&(E[b-1]=t,v=0,y=0,S=!0,0==--b))return t=void 0,o.removeAllListeners("data"),o.destroy()}else!0===S?(B<<=8,B+=e[r],4==++y&&(y=0,B>0?S=B:(t=void 0,S=!1),B=0)):++y===S&&(S=!1,y=0,t=void 0);else v<<=8,v+=e[r],4==++y&&(t=new Buffer(v),y=0);else if(5===d)return f=w?new Error("Agent unable to sign data"):new Error("Unable to retrieve list of keys from agent"),o.removeAllListeners("data"),o.destroy()}function A(e){f=e}function T(){f?s(f):w&&!h||!w&&!E?s(new Error("Unexpected disconnection from agent")):w&&h?s(void 0,h):!w&&E&&s(void 0,E)}if("function"==typeof t&&"function"==typeof r?(g=t,m=r):w?(v=t.length,l=n.length):(s=t,t=void 0),"win32"===process.platform){if("pageant"!==e){var N=!1;return void a.readFile(e,(function t(r,n){if(r)return N?s(new Error("Invalid cygwin unix socket path")):void c.exec('cygpath -w "'+e+'"',(function(r,i,n){if(r||0===i.length)return s(new Error("Invalid cygwin unix socket path"));N=!0,e=i.toString().replace(/[\r\n]/g,""),a.readFile(e,t)}));var f;if(f=u.exec(n.toString("ascii"))){var h,p,l,d,E,g,m=0,v=!1,w=[],y=new Buffer(12);for(y.fill(0),h=parseInt(f[1],10),p=f[2].replace(/\-/g,""),l=new Buffer(16),E=0,g=0;g<32;++E,g+=2)l[E]=parseInt(p.substring(g,g+2),16);for(E=0;E<16;E+=4)l.writeUInt32LE(l.readUInt32BE(E,!0),E,!0);function _(){m=0,d="secret",o.write(l)}function b(e){m+=e.length,"secret"===d?16===m&&(m=0,d="creds",o.write(y)):"creds"===d&&(v||w.push(e),12===m&&(o.removeListener("connect",_),o.removeListener("data",b),o.removeListener("close",B),v?(k(),o.emit("connect")):(v=!0,(y=Buffer.concat(w)).writeUInt32LE(process.pid,0,!0),o.destroy(),S())))}function B(){s(new Error("Problem negotiating cygwin unix socket security"))}function S(){(o=new i).once("connect",_),o.on("data",b),o.once("close",B),o.connect(h)}S()}else s(new Error("Malformed cygwin unix socket file"))}))}o=new p}else o=new i;function k(){var e;g||m?(o.once("connect",(function(){e=g();var t=!1;function r(){t||(o.destroy(),t=!0)}e.once("end",r).once("close",r).on("data",(function(e){o.write(e)})),o.on("data",(function(t){e.write(t)}))})),o.once("close",(function(){e||m()}))):(o.once("connect",U),o.on("data",I),o.once("error",A),o.once("close",T))}k(),o.connect(e)},"win32"===process.platform){var f={},h=o.resolve(t,"..","util/pagent.exe");function p(){this.proc=void 0,this.buffer=null}f[10]=new Error("Invalid pagent.exe arguments"),f[11]=new Error("Pageant is not running"),f[12]=new Error("pagent.exe could not create an mmap"),f[13]=new Error("pagent.exe could not set mode for stdin"),f[14]=new Error("pagent.exe could not set mode for stdout"),f[15]=new Error("pagent.exe did not get expected input payload"),s(p,n),p.prototype.write=function(e){if(null===this.buffer?this.buffer=e:this.buffer=Buffer.concat([this.buffer,e],this.buffer.length+e.length),!(this.buffer.length<4)){var t=this.buffer.readUInt32BE(0,!0);if(!(this.buffer.length-4<t)){e=this.buffer.slice(0,4+t),this.buffer.length>4+t?this.buffer=this.buffer.slice(4+t):this.buffer=null;var r,i=this,n=!1;(r=this.proc=c.spawn(h,[e.length])).stdout.on("data",(function(e){i.emit("data",e)})),r.once("error",(function(e){n||(n=!0,i.emit("error",e))})),r.once("close",(function(e){i.proc=void 0,f[e]&&!n&&(n=!0,i.emit("error",f[e])),i.emit("close",n)})),r.stdin.end(e)}}},p.prototype.end=p.prototype.destroy=function(){this.buffer=null,this.proc&&(this.proc.kill(),this.proc=void 0)},p.prototype.connect=function(){this.emit("connect")}}}).call(this,"node_modules\\ssh2\\lib")},567:function(e,t,r){var i=r(0).inherits,n=r(4).EventEmitter;function s(e){var t=this;n.call(this),this._stream=e,e.on("error",(function(e){t.emit("error",e)})).on("end",(function(){t.emit("end")})).on("close",(function(){t.emit("close")})).on("continue",(function(){t.emit("continue")}))}i(s,n),s.prototype.end=function(){return this._stream.end()},s.prototype.createReadStream=function(e,t){return this._stream.createReadStream(e,t)},s.prototype.createWriteStream=function(e,t){return this._stream.createWriteStream(e,t)},s.prototype.open=function(e,t,r,i){return this._stream.open(e,t,r,i)},s.prototype.close=function(e,t){return this._stream.close(e,t)},s.prototype.read=function(e,t,r,i,n,s){return this._stream.readData(e,t,r,i,n,s)},s.prototype.write=function(e,t,r,i,n,s){return this._stream.writeData(e,t,r,i,n,s)},s.prototype.fastGet=function(e,t,r,i){return this._stream.fastGet(e,t,r,i)},s.prototype.fastPut=function(e,t,r,i){return this._stream.fastPut(e,t,r,i)},s.prototype.readFile=function(e,t,r){return this._stream.readFile(e,t,r)},s.prototype.writeFile=function(e,t,r,i){return this._stream.writeFile(e,t,r,i)},s.prototype.appendFile=function(e,t,r,i){return this._stream.appendFile(e,t,r,i)},s.prototype.exists=function(e,t){return this._stream.exists(e,t)},s.prototype.unlink=function(e,t){return this._stream.unlink(e,t)},s.prototype.rename=function(e,t,r){return this._stream.rename(e,t,r)},s.prototype.mkdir=function(e,t,r){return this._stream.mkdir(e,t,r)},s.prototype.rmdir=function(e,t){return this._stream.rmdir(e,t)},s.prototype.readdir=function(e,t,r){return this._stream.readdir(e,t,r)},s.prototype.fstat=function(e,t){return this._stream.fstat(e,t)},s.prototype.stat=function(e,t){return this._stream.stat(e,t)},s.prototype.lstat=function(e,t){return this._stream.lstat(e,t)},s.prototype.opendir=function(e,t){return this._stream.opendir(e,t)},s.prototype.setstat=function(e,t,r){return this._stream.setstat(e,t,r)},s.prototype.fsetstat=function(e,t,r){return this._stream.fsetstat(e,t,r)},s.prototype.futimes=function(e,t,r,i){return this._stream.futimes(e,t,r,i)},s.prototype.utimes=function(e,t,r,i){return this._stream.utimes(e,t,r,i)},s.prototype.fchown=function(e,t,r,i){return this._stream.fchown(e,t,r,i)},s.prototype.chown=function(e,t,r,i){return this._stream.chown(e,t,r,i)},s.prototype.fchmod=function(e,t,r){return this._stream.fchmod(e,t,r)},s.prototype.chmod=function(e,t,r){return this._stream.chmod(e,t,r)},s.prototype.readlink=function(e,t){return this._stream.readlink(e,t)},s.prototype.symlink=function(e,t,r){return this._stream.symlink(e,t,r)},s.prototype.realpath=function(e,t){return this._stream.realpath(e,t)},s.prototype.ext_openssh_rename=function(e,t,r){return this._stream.ext_openssh_rename(e,t,r)},s.prototype.ext_openssh_statvfs=function(e,t){return this._stream.ext_openssh_statvfs(e,t)},s.prototype.ext_openssh_fstatvfs=function(e,t){return this._stream.ext_openssh_fstatvfs(e,t)},s.prototype.ext_openssh_hardlink=function(e,t,r){return this._stream.ext_openssh_hardlink(e,t,r)},s.prototype.ext_openssh_fsync=function(e,t){return this._stream.ext_openssh_fsync(e,t)},e.exports=s},568:function(e,t,r){var i,n=r(18),s=r(4).EventEmitter,o=s.listenerCount,a=r(0).inherits,c=r(162),u=c.utils.parseKey,f=c.utils.genPublicKey,h=c.utils.decryptKey,p=c.SSH2Stream,l=c.SFTPStream,d=c.constants,E=d.DISCONNECT_REASON,g=d.CHANNEL_OPEN_FAILURE,m=d.ALGORITHMS,v=r(263),w=r(569),y=Math.pow(2,32)-1;function _(e,t){if(!(this instanceof _))return new _(e,t);var r,a={"ssh-rsa":null,"ssh-dss":null,"ecdsa-sha2-nistp256":null,"ecdsa-sha2-nistp384":null,"ecdsa-sha2-nistp521":null},c=e.hostKeys;if(!Array.isArray(c))throw new Error("hostKeys must be an array");for(r=0;r<c.length;++r){var l;if((l=Buffer.isBuffer(c[r])||"string"==typeof c[r]?u(c[r]):u(c[r].key))instanceof Error)throw new Error("Cannot parse privateKey: "+l.message);if(!l.private)throw new Error("privateKey value contains an invalid private key");if(!a[l.fulltype]){if(l.encryption){if("string"!=typeof c[r].passphrase)throw new Error("Missing passphrase for encrypted private key");h(l,c[r].passphrase)}a[l.fulltype]={privateKey:l,publicKey:f(l)}}}var d={kex:void 0,kexBuf:void 0,cipher:void 0,cipherBuf:void 0,serverHostKey:void 0,serverHostKeyBuf:void 0,hmac:void 0,hmacBuf:void 0,compress:void 0,compressBuf:void 0};if("object"==typeof e.algorithms&&null!==e.algorithms){var g,v;if(v=e.algorithms.kex,Array.isArray(v)&&v.length>0){for(g=m.SUPPORTED_KEX,r=0;r<v.length;++r)if(-1===g.indexOf(v[r]))throw new Error("Unsupported key exchange algorithm: "+v[r]);d.kex=v}if(v=e.algorithms.cipher,Array.isArray(v)&&v.length>0){for(g=m.SUPPORTED_CIPHER,r=0;r<v.length;++r)if(-1===g.indexOf(v[r]))throw new Error("Unsupported cipher algorithm: "+v[r]);d.cipher=v}v=e.algorithms.serverHostKey;var y=!1;if(Array.isArray(v)&&v.length>0){for(g=m.SUPPORTED_SERVER_HOST_KEY,r=v.length-1;r>=0;--r){if(-1===g.indexOf(v[r]))throw new Error("Unsupported server host key algorithm: "+v[r]);a[v[r]]||(y||(v=v.slice(),y=!0),v.splice(r,1))}v.length>0&&(d.serverHostKey=v)}if(v=e.algorithms.hmac,Array.isArray(v)&&v.length>0){for(g=m.SUPPORTED_HMAC,r=0;r<v.length;++r)if(-1===g.indexOf(v[r]))throw new Error("Unsupported HMAC algorithm: "+v[r]);d.hmac=v}if(v=e.algorithms.compress,Array.isArray(v)&&v.length>0){for(g=m.SUPPORTED_COMPRESS,r=0;r<v.length;++r)if(-1===g.indexOf(v[r]))throw new Error("Unsupported compression algorithm: "+v[r]);d.compress=v}}if(void 0===d.serverHostKey){var B=Object.keys(a);for(r=B.length-1;r>=0;--r)a[B[r]]||B.splice(r,1);d.serverHostKey=B}!i&&_.KEEPALIVE_INTERVAL>0&&_.KEEPALIVE_CLIENT_INTERVAL>0&&_.KEEPALIVE_CLIENT_COUNT_MAX>=0&&(i=new w(_.KEEPALIVE_INTERVAL,_.KEEPALIVE_CLIENT_INTERVAL,_.KEEPALIVE_CLIENT_COUNT_MAX));var S=this;s.call(this),"function"==typeof t&&S.on("connection",t);var U,I,A={algorithms:d,hostKeys:a,server:!0};for(r=0,I=(U=Object.keys(e)).length;r<I;++r){var T=U[r];"privateKey"!==T&&"publicKey"!==T&&"passphrase"!==T&&"algorithms"!==T&&"hostKeys"!==T&&"server"!==T&&(A[T]=e[T])}if("function"==typeof A.debug)var N=A.debug,k=Object.keys(A);this._srv=new n.Server((function(e){if(S._connections>=S.maxConnections)e.destroy();else{++S._connections,e.once("close",(function(e){--S._connections,s.read()})).on("error",(function(e){s.reset(),s.emit("error",e)}));var t=A;if(N){t={};for(var r,i=0;i<k.length;++i)t[r=k[i]]=A[r];var n="["+process.hrtime().join(".")+"] ";t.debug=function(e){N(n+e)}}var s=new p(t),a=new b(s,e);e.pipe(s).pipe(e),a.on("error",c),s.once("header",(function(t){if(!s._readableState.ended){if(!o(S,"connection"))return s.disconnect(E.BY_APPLICATION);a.removeListener("error",c),S.emit("connection",a,{ip:e.remoteAddress,header:t})}}))}function c(e){}})).on("error",(function(e){S.emit("error",e)})).on("listening",(function(){S.emit("listening")})).on("close",(function(){S.emit("close")})),this._connections=0,this.maxConnections=1/0}function b(e,t){s.call(this);var r=this;this._sshstream=e;var n=this._channels={};this._curChan=-1,this._sock=t,this.noMoreSessions=!1,this.authenticated=!1,e.on("end",(function(){r.emit("end")})).on("close",(function(e){r.emit("close",e)})).on("error",(function(e){r.emit("error",e)})).on("drain",(function(){r.emit("drain")})).on("continue",(function(){r.emit("continue")}));var a,c=0,u=!1,f=[];function h(t,i,n,s){if(0===c||a&&(a.username!==t||a.service!==i)||"password"!==n&&"publickey"!==n&&"hostbased"!==n&&"keyboard-interactive"!==n&&"none"!==n||10===f.length)return e.disconnect(E.PROTOCOL_ERROR);if("ssh-connection"!==i)return e.disconnect(E.SERVICE_NOT_AVAILABLE);var u;if(e._state.authMethod=n,"keyboard-interactive"===n?u=new I(e,t,i,n,s,p):"publickey"===n?u=new A(e,t,i,n,s,p):"hostbased"===n?u=new T(e,t,i,n,s,p):"password"===n?u=new N(e,t,i,n,s,p):"none"===n&&(u=new S(e,t,i,n,p)),a){if(!a._initialResponse)return f.push(u);a._multistep&&!this._finalResponse&&(a._cleanup&&a._cleanup(),a.emit("abort"))}a=u,o(r,"authentication")?r.emit("authentication",a):a.reject()}function p(t,i,n,s){a!==t||r.authenticated||(i?(e.removeListener("USERAUTH_REQUEST",h),a=void 0,r.authenticated=!0,e.authSuccess(),f=[],r.emit("ready")):(e.authFailure(n,s),f.length&&(a=f.pop(),o(r,"authentication")?r.emit("authentication",a):a.reject())))}e.on("SERVICE_REQUEST",(function(t){if(0===c||u||r.authenticated||"ssh-userauth"!==t)return e.disconnect(E.SERVICE_NOT_AVAILABLE);u=!0,e.serviceAccept(t)})).on("USERAUTH_REQUEST",h);var l=[];e.on("GLOBAL_REQUEST",(function(t,i,n){var s={type:null,buf:null};function a(t,r){s.type=t,s.buf=r,function(){for(var t;l.length>0&&l[0].type;)"SUCCESS"===(t=l.shift()).type&&e.requestSuccess(t.buf),"FAILURE"===t.type&&e.requestFailure()}()}if(i&&l.push(s),("tcpip-forward"===t||"cancel-tcpip-forward"===t||"no-more-sessions@openssh.com"===t||"streamlocal-forward@openssh.com"===t||"cancel-streamlocal-forward@openssh.com"===t)&&o(r,"request")&&r.authenticated){var c,u;if(i){var f=!1;c=function(e){var r;f||(f=!0,"tcpip-forward"===t&&0===n.bindPort&&"number"==typeof e&&(r=new Buffer(4)).writeUInt32BE(e,0,!0),a("SUCCESS",r))},u=function(){f||(f=!0,a("FAILURE"))}}if("no-more-sessions@openssh.com"===t)return r.noMoreSessions=!0,void(c&&c());r.emit("request",c,u,t,n)}else i&&a("FAILURE")})),e.on("CHANNEL_OPEN",(function(t){if("session"===t.type&&r.noMoreSessions||!r.authenticated){var i=g.ADMINISTRATIVELY_PROHIBITED;return e.channelOpenFail(t.sender,i)}var s,a,c=R(r),u=!1;if(!1===c)return e.channelOpenFail(t.sender,g.RESOURCE_SHORTAGE);switch(n[c]=!0,a=function(){if(!u){u=!0,delete n[c];var r=g.ADMINISTRATIVELY_PROHIBITED;return e.channelOpenFail(t.sender,r)}},t.type){case"session":o(r,"session")?(s=function(){if(!u)return u=!0,e.channelOpenConfirm(t.sender,c,v.MAX_WINDOW,v.PACKET_SIZE),new B(r,t,c)},r.emit("session",s,a)):a();break;case"direct-tcpip":o(r,"tcpip")?(s=function(){if(!u){u=!0,e.channelOpenConfirm(t.sender,c,v.MAX_WINDOW,v.PACKET_SIZE);var i={type:void 0,incoming:{id:c,window:v.MAX_WINDOW,packetSize:v.PACKET_SIZE,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};return new v(i,r)}},r.emit("tcpip",s,a,t.data)):a();break;case"direct-streamlocal@openssh.com":o(r,"openssh.streamlocal")?(s=function(){if(!u){u=!0,e.channelOpenConfirm(t.sender,c,v.MAX_WINDOW,v.PACKET_SIZE);var i={type:void 0,incoming:{id:c,window:v.MAX_WINDOW,packetSize:v.PACKET_SIZE,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};return new v(i,r)}},r.emit("openssh.streamlocal",s,a,t.data)):a();break;default:a()}})),e.on("NEWKEYS",(function(){++c>1&&r.emit("rekey")})),i&&this.once("ready",(function(){i.add(e)}))}function B(e,t,r){this.subtype=void 0;var i,n=!1,s=this,a=t.sender,c={type:"session",incoming:{id:r,window:v.MAX_WINDOW,packetSize:v.PACKET_SIZE,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};e._sshstream.on("CHANNEL_REQUEST:"+r,(function(t){var r,u,f=!1;if(t.wantReply&&("shell"!==t.request&&"exec"!==t.request&&"subsystem"!==t.request&&(r=function(){if(!(f||n||i))return f=!0,e._sshstream.channelSuccess(a)}),u=function(){if(!(f||n||i))return f=!0,e._sshstream.channelFailure(a)}),n)u&&u();else switch(t.request){case"env":o(s,"env")?s.emit("env",r,u,{key:t.key,val:t.val}):u&&u();break;case"pty-req":o(s,"pty")?s.emit("pty",r,u,{cols:t.cols,rows:t.rows,width:t.width,height:t.height,term:t.term,modes:t.modes}):u&&u();break;case"window-change":o(s,"window-change")?s.emit("window-change",r,u,{cols:t.cols,rows:t.rows,width:t.width,height:t.height}):u&&u();break;case"x11-req":o(s,"x11")?s.emit("x11",r,u,{single:t.single,protocol:t.protocol,cookie:t.cookie,screen:t.screen}):u&&u();break;case"signal":o(s,"signal")?s.emit("signal",r,u,{name:t.signal}):u&&u();break;case"auth-agent-req@openssh.com":o(s,"auth-agent")?s.emit("auth-agent",r,u):u&&u();break;case"shell":o(s,"shell")?(r=function(){if(!(f||n||i))return f=!0,t.wantReply&&e._sshstream.channelSuccess(a),(i=new v(c,e,{server:!0})).subtype=s.subtype=t.request,i},s.emit("shell",r,u)):u&&u();break;case"exec":o(s,"exec")?(r=function(){if(!(f||n||i))return f=!0,t.wantReply&&e._sshstream.channelSuccess(a),(i=new v(c,e,{server:!0})).subtype=s.subtype=t.request,i},s.emit("exec",r,u,{command:t.command})):u&&u();break;case"subsystem":r=function(){if(!(f||n||i)){if(f=!0,t.wantReply&&e._sshstream.channelSuccess(a),(i=new v(c,e,{server:!0})).subtype=s.subtype=t.request+":"+t.subsystem,"sftp"===t.subsystem){var r=new l({server:!0,debug:e._sshstream.debug});return i.pipe(r).pipe(i),r}return i}},"sftp"===t.subsystem&&o(s,"sftp")?s.emit("sftp",r,u):"sftp"!==t.subsystem&&o(s,"subsystem")?s.emit("subsystem",r,u,{name:t.subsystem}):u&&u();break;default:u&&u()}})).once("CHANNEL_EOF:"+r,(function(){n=!0,s.emit("eof"),s.emit("end")})).once("CHANNEL_CLOSE:"+r,(function(){n=!0,s.emit("close")}))}function S(e,t,r,i,n){s.call(this);var o=this;this.username=this.user=t,this.service=r,this.method=i,this._initialResponse=!1,this._finalResponse=!1,this._multistep=!1,this._cbfinal=function(e,t,r){o._finalResponse||(o._finalResponse=!0,n(o,e,t,r))},this._stream=e}a(_,s),_.prototype.listen=function(){return this._srv.listen.apply(this._srv,arguments),this},_.prototype.address=function(){return this._srv.address()},_.prototype.getConnections=function(e){this._srv.getConnections(e)},_.prototype.close=function(e){return this._srv.close(e),this},_.prototype.ref=function(){this._srv.ref()},_.prototype.unref=function(){this._srv.unref()},a(b,s),b.prototype.end=function(){return this._sshstream.disconnect(E.BY_APPLICATION)},b.prototype.x11=function(e,t,r){return k(this,"x11",{originAddr:e,originPort:t},r)},b.prototype.forwardOut=function(e,t,r,i,n){return k(this,"forwarded-tcpip",{boundAddr:e,boundPort:t,remoteAddr:r,remotePort:i},n)},b.prototype.openssh_forwardOutStreamLocal=function(e,t){return k(this,"forwarded-streamlocal@openssh.com",{socketPath:e},t)},b.prototype.rekey=function(e){var t,r=this._sshstream,i=!0;try{i=r.rekey()}catch(e){t=e}return"function"==typeof e&&(t?process.nextTick((function(){e(t)})):this.once("rekey",e)),i},a(B,s),a(S,s),S.prototype.accept=function(){this._cleanup&&this._cleanup(),this._initialResponse=!0,this._cbfinal(!0)},S.prototype.reject=function(e,t){this._cleanup&&this._cleanup(),this._initialResponse=!0,this._cbfinal(!1,e,t)};var U=/[ \t\r\n]*,[ \t\r\n]*/g;function I(e,t,r,i,n,s){S.call(this,e,t,r,i,s),this._multistep=!0;var o=this;this._cb=void 0,this._onInfoResponse=function(e){if(o._cb){var t=o._cb;o._cb=void 0,t(e)}},this.submethods=n.split(U),this.on("abort",(function(){o._cb&&o._cb(new Error("Authentication request aborted"))}))}function A(e,t,r,i,n,s){var o;if(S.call(this,e,t,r,i,s),this.key={algo:n.keyAlgo,data:n.key},this.signature=n.signature,this.signature)switch(n.keyAlgo){case"ssh-rsa":o="RSA-SHA1";break;case"ssh-dss":o="DSA-SHA1";break;case"ecdsa-sha2-nistp256":o="sha256";break;case"ecdsa-sha2-nistp384":o="sha384";break;case"ecdsa-sha2-nistp521":o="sha512"}this.sigAlgo=o,this.blob=n.blob}function T(e,t,r,i,n,s){var o;if(S.call(this,e,t,r,i,s),this.key={algo:n.keyAlgo,data:n.key},this.signature=n.signature,this.signature)switch(n.keyAlgo){case"ssh-rsa":o="RSA-SHA1";break;case"ssh-dss":o="DSA-SHA1";break;case"ecdsa-sha2-nistp256":o="sha256";break;case"ecdsa-sha2-nistp384":o="sha384";break;case"ecdsa-sha2-nistp521":o="sha512"}this.sigAlgo=o,this.blob=n.blob,this.localHostname=n.localHostname,this.localUsername=n.localUsername}function N(e,t,r,i,n,s){S.call(this,e,t,r,i,s),this.password=n}function k(e,t,r,i){var n=R(e),s=v.MAX_WINDOW,o=v.PACKET_SIZE,a=!0;if(!1===n)return i(new Error("No free channels available"));"function"==typeof r&&(i=r,r={}),e._channels[n]=!0;var c=e._sshstream;return c.once("CHANNEL_OPEN_CONFIRMATION:"+n,(function(r){c.removeAllListeners("CHANNEL_OPEN_FAILURE:"+n);var a={type:t,incoming:{id:n,window:s,packetSize:o,state:"open"},outgoing:{id:r.sender,window:r.window,packetSize:r.packetSize,state:"open"}};i(void 0,new v(a,e,{server:!0}))})).once("CHANNEL_OPEN_FAILURE:"+n,(function(t){c.removeAllListeners("CHANNEL_OPEN_CONFIRMATION:"+n),delete e._channels[n];var r=new Error("(SSH) Channel open failure: "+t.description);r.reason=t.reason,r.lang=t.lang,i(r)})),"forwarded-tcpip"===t?a=c.forwardedTcpip(n,s,o,r):"x11"===t?a=c.x11(n,s,o,r):"forwarded-streamlocal@openssh.com"===t&&(a=c.openssh_forwardedStreamLocal(n,s,o,r)),a}function R(e){if(e._curChan<y)return++e._curChan;for(var t=0,r=e._channels;t<y;++t)if(!r[t])return t;return!1}a(I,S),I.prototype._cleanup=function(){this._stream.removeListener("USERAUTH_INFO_RESPONSE",this._onInfoResponse)},I.prototype.prompt=function(e,t,r,i){Array.isArray(e)||(e=[e]),"function"==typeof t?(i=t,t=r=void 0):"function"==typeof r&&(i=r,r=void 0);for(var n=0;n<e.length;++n)"string"==typeof e[n]&&(e[n]={prompt:e[n],echo:!0});return this._cb=i,this._initialResponse=!0,this._stream.once("USERAUTH_INFO_RESPONSE",this._onInfoResponse),this._stream.authInfoReq(t,r,e)},a(A,S),A.prototype.accept=function(){this.signature?S.prototype.accept.call(this):(this._initialResponse=!0,this._stream.authPKOK(this.key.algo,this.key.data))},a(T,S),a(N,S),_.createServer=function(e,t){return new _(e,t)},_.KEEPALIVE_INTERVAL=1e3,_.KEEPALIVE_CLIENT_INTERVAL=15e3,_.KEEPALIVE_CLIENT_COUNT_MAX=3,e.exports=_},569:function(e,t,r){var i=r(570).spliceOne;function n(e,t,r){var n=this._streams=[];this._timer=void 0,this._timerInterval=e,this._timerfn=function(){for(var e,s,o=Date.now(),a=0,c=n.length;a<c;++a)if((s=(e=n[a])._kalast)&&o-s>=t)if(++e._kacnt>r){var u=new Error("Keepalive timeout");u.level="client-timeout",e.emit("error",u),e.disconnect(),i(n,a),--a,c=n.length}else e._kalast=o,e.ping()}}n.prototype.start=function(){this._timer&&this.stop(),this._timer=setInterval(this._timerfn,this._timerInterval)},n.prototype.stop=function(){this._timer&&(clearInterval(this._timer),this._timer=void 0)},n.prototype.add=function(e){var t=this._streams,r=this;function i(){e._kalast=Date.now(),e._kacnt=0}e.once("end",(function(){r.remove(e)})).on("packet",i),t[t.length]=e,i(),this._timer||this.start()},n.prototype.remove=function(e){var t=this._streams,r=t.indexOf(e);r>-1&&i(t,r),t.length||this.stop()},e.exports=n},570:function(e,t){t.spliceOne=function(e,t){for(var r=t,i=r+1,n=e.length;i<n;r+=1,i+=1)e[r]=e[i];e.pop()}},571:function(e,t,r){var i=r(0),n=r(572),s=r(258)("tunnel-ssh-config"),o=function(e,t){Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message=e,this.extra=t};i.inherits(o,Error),e.exports=function(e){var t,r=process.env;if(n(e||{},{username:r.TUNNELSSH_USER||r.USER||r.USERNAME||"root",port:22,host:null,srcPort:0,srcHost:"127.0.0.1",dstPort:null,dstHost:"127.0.0.1",localHost:"127.0.0.1",localPort:e.dstPort,agent:process.env.SSH_AUTH_SOCK}),!e.host)throw new o("host not set");if(!e.dstPort)throw new o("dstPort not set");return s("ssh-config",(t=["password","privateKey"],Object.keys(e).reduce((function(r,i){return-1===t.indexOf(i)?r[i]=e[i]:r[i]="***HIDDEN***",r}),{}))),e}},572:function(e,t){var r=/^(?:0|[1-9]\d*)$/;function i(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var n=Object.prototype,s=n.hasOwnProperty,o=n.toString,a=n.propertyIsEnumerable,c=Math.max;function u(e,t){var r=g(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&m(e)}(e)&&s.call(e,"callee")&&(!a.call(e,"callee")||"[object Arguments]"==o.call(e))}(e)?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],i=r.length,n=!!i;for(var c in e)!t&&!s.call(e,c)||n&&("length"==c||d(c,i))||r.push(c);return r}function f(e,t,r,i){return void 0===e||E(e,n[r])&&!s.call(i,r)?t:e}function h(e,t,r){var i=e[t];s.call(e,t)&&E(i,r)&&(void 0!==r||t in e)||(e[t]=r)}function p(e){if(!v(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t,r,i,o=(r=(t=e)&&t.constructor,i="function"==typeof r&&r.prototype||n,t===i),a=[];for(var c in e)("constructor"!=c||!o&&s.call(e,c))&&a.push(c);return a}function l(e,t){return t=c(void 0===t?e.length-1:t,0),function(){for(var r=arguments,n=-1,s=c(r.length-t,0),o=Array(s);++n<s;)o[n]=r[t+n];n=-1;for(var a=Array(t+1);++n<t;)a[n]=r[n];return a[t]=o,i(e,this,a)}}function d(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||r.test(e))&&e>-1&&e%1==0&&e<t}function E(e,t){return e===t||e!=e&&t!=t}var g=Array.isArray;function m(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!function(e){var t=v(e)?o.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)}function v(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var w,y=(w=function(e,t,r,i){!function(e,t,r,i){r||(r={});for(var n=-1,s=t.length;++n<s;){var o=t[n],a=i?i(r[o],e[o],o,r,e):void 0;h(r,o,void 0===a?e[o]:a)}}(t,function(e){return m(e)?u(e,!0):p(e)}(t),e,i)},l((function(e,t){var r=-1,i=t.length,n=i>1?t[i-1]:void 0,s=i>2?t[2]:void 0;for(n=w.length>3&&"function"==typeof n?(i--,n):void 0,s&&function(e,t,r){if(!v(r))return!1;var i=typeof t;return!!("number"==i?m(r)&&d(t,r.length):"string"==i&&t in r)&&E(r[t],e)}(t[0],t[1],s)&&(n=i<3?void 0:n,i=1),e=Object(e);++r<i;){var o=t[r];o&&w(e,o,r,n)}return e}))),_=l((function(e){return e.push(void 0,f),i(y,void 0,e)}));e.exports=_},72:function(e,t,r){var i=r(2),n=r(260).Ber,s=r(561),o=r(165).SSH_TO_OPENSSL,a=/^arcfour/i,c=/(.{64})/g,u=new Buffer([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function f(e,t,r){var i=E(e,e._pos,t,r);if(!1===i)return!1;var s=E(e,e._pos,t,r);if(!1===s)return!1;var o=new n.Writer;return o.startSequence(),o.startSequence(),o.writeOID("1.2.840.113549.1.1.1"),o.writeNull(),o.endSequence(),o.startSequence(n.BitString),o.writeByte(0),o.startSequence(),o.writeBuffer(s,n.Integer),o.writeBuffer(i,n.Integer),o.endSequence(),o.endSequence(),o.endSequence(),o.buffer}function h(e,t,r){var i=E(e,e._pos,t,r);if(!1===i)return!1;var s=E(e,e._pos,t,r);if(!1===s)return!1;var o=E(e,e._pos,t,r);if(!1===o)return!1;var a=E(e,e._pos,t,r);if(!1===a)return!1;var c=new n.Writer;return c.startSequence(),c.startSequence(),c.writeOID("1.2.840.10040.4.1"),c.startSequence(),c.writeBuffer(i,n.Integer),c.writeBuffer(s,n.Integer),c.writeBuffer(o,n.Integer),c.endSequence(),c.endSequence(),c.startSequence(n.BitString),c.writeByte(0),c.writeBuffer(a,n.Integer),c.endSequence(),c.endSequence(),c.buffer}function p(e,t,r){var i=E(e,e._pos,t,r);if(!1===i)return!1;var s,o=E(e,e._pos,t,r);if(!1===o)return!1;switch(i.toString("ascii")){case"nistp256":s="1.2.840.10045.3.1.7";break;case"nistp384":s="1.3.132.0.34";break;case"nistp521":s="1.3.132.0.35";break;default:return!1}var a=new n.Writer;return a.startSequence(),a.startSequence(),a.writeOID("1.2.840.10045.2.1"),a.writeOID(s),a.endSequence(),a.startSequence(n.BitString),a.writeByte(0),a._ensure(o.length),o.copy(a._buf,a._offset,0,o.length),a._offset+=o.length,a.endSequence(),a.endSequence(),a.buffer}function l(e,t,r){if(void 0!==e._macresult)return e._macresult;if(!e.ppk)throw new Error("Key isn't a PPK");if(!e.privateMAC)throw new Error("Missing MAC");if(!r)throw new Error("Missing raw private key data");if(e.encryption&&"string"!=typeof t)throw new Error("Missing passphrase for encrypted PPK");if(e.encryption&&!e._decrypted)throw new Error("PPK must be decrypted before verifying MAC");var n=e.privateMAC,s=e.fulltype.length,o=e.encryption?"aes256-cbc":"none",a=o.length,c=Buffer.byteLength(e.comment),u=e.public,f=u.length,h=r.length,p=new Buffer(4+s+4+a+4+c+4+f+4+h),l=0;p.writeUInt32BE(s,l,!0),p.write(e.fulltype,l+=4,s,"ascii"),p.writeUInt32BE(a,l+=s,!0),p.write(o,l+=4,a,"ascii"),p.writeUInt32BE(c,l+=a,!0),p.write(e.comment,l+=4,c,"utf8"),p.writeUInt32BE(f,l+=c,!0),u.copy(p,l+=4),p.writeUInt32BE(h,l+=f,!0),r.copy(p,l+=4),"string"!=typeof t&&(t="");var d=i.createHash("sha1").update("putty-private-key-file-mac-key","ascii").update(t,"utf8").digest(),E=i.createHmac("sha1",d).update(p).digest("hex");return e._macresult=E===n}function d(e){if(!(e.ppk&&e.public&&e.private))throw new Error("Key isn't a PPK");if(e._converted)return!1;var t,r,i=e.public,o=e.private,a=new n.Writer;if("rsa"===e.type){var u=E(i,11),f=E(i,i._pos),h=E(o,0);t=E(o,o._pos),r=E(o,o._pos);var p=E(o,o._pos),l=new s(t,256),d=new s(r,256),g=new s(h,256),m=new s(h,256);g=new Buffer(g.mod(l.subtract(s.ONE)).toByteArray()),m=new Buffer(m.mod(d.subtract(s.ONE)).toByteArray()),a.startSequence(),a.writeInt(0,n.Integer),a.writeBuffer(f,n.Integer),a.writeBuffer(u,n.Integer),a.writeBuffer(h,n.Integer),a.writeBuffer(t,n.Integer),a.writeBuffer(r,n.Integer),a.writeBuffer(g,n.Integer),a.writeBuffer(m,n.Integer),a.writeBuffer(p,n.Integer),a.endSequence()}else{t=E(i,11),r=E(i,i._pos);var v=E(i,i._pos),w=E(i,i._pos),y=E(o,0);a.startSequence(),a.writeInt(0,n.Integer),a.writeBuffer(t,n.Integer),a.writeBuffer(r,n.Integer),a.writeBuffer(v,n.Integer),a.writeBuffer(w,n.Integer),a.writeBuffer(y,n.Integer),a.endSequence()}var _=a.buffer.toString("base64").replace(c,"$1\n"),b="-----BEGIN "+("rsa"===e.type?"RSA":"DSA")+" PRIVATE KEY-----\n"+_+("\n"===_[_.length-1]?"":"\n")+"-----END "+("rsa"===e.type?"RSA":"DSA")+" PRIVATE KEY-----";return e.private=a.buffer,e.privateOrig=new Buffer(b),e._converted=!0,!0}function E(e,t,r,i,n,s){r&&!Buffer.isBuffer(r)&&"string"!=typeof r&&("number"==typeof n&&(s=n),n=i,i=r,r=void 0),t||(t=0);var o,a,c=e.length,u=c-t;return t<0||t>=c||u<4||(o=e.readUInt32BE(t,!0))>(s||1/0)||u<4+o?(i&&i._cleanup(n),!1):(a=(t+=4)+o,e._pos=a,r?Buffer.isBuffer(r)?(e.copy(r,0,t,a),r):e.toString(r,t,a):e.slice(t,a))}e.exports={iv_inc:function(e){var t=12,r=0;do{if(--t,255!==(r=e[t]))return void(e[t]=++r);e[t]=0}while(t>4)},isStreamCipher:function(e){return a.test(e)},readInt:function(e,t,r,i){var n=e.length;if(t<0||t>=n||n-t<4)return r&&r._cleanup(i),!1;return e.readUInt32BE(t,!0)},readString:E,parseKey:r(562),genPublicKey:function(e){var t,r,s,o,a,u,l,d,E,g,m,v,w,y;if(e.private){var _,b=e.private,B=new n.Reader(b);if(null===B.readSequence())throw _="Malformed private key (expected sequence)",e._decrypted&&(_+=". Bad passphrase?"),new Error(_);if(null===B.readInt())throw _="Malformed private key (expected version)",e._decrypted&&(_+=". Bad passphrase?"),new Error(_);if("rsa"===e.type){if(null===(s=B.readString(n.Integer,!0)))throw _="Malformed private key (expected RSA n value)",e._decrypted&&(_+=". Bad passphrase?"),new Error(_);if(null===(o=B.readString(n.Integer,!0)))throw _="Malformed private key (expected RSA e value)",e._decrypted&&(_+=". Bad passphrase?"),new Error(_);(t=new Buffer(15+s.length+4+o.length)).writeUInt32BE(7,0,!0),t.write("ssh-rsa",4,7,"ascii"),r=11,t.writeUInt32BE(o.length,r,!0),o.copy(t,r+=4),t.writeUInt32BE(s.length,r+=o.length,!0),s.copy(t,r+=4)}else if("dss"===e.type){if(null===(a=B.readString(n.Integer,!0)))throw _="Malformed private key (expected DSA p value)",e._decrypted&&(_+=". Bad passphrase?"),new Error(_);if(null===(u=B.readString(n.Integer,!0)))throw _="Malformed private key (expected DSA q value)",e._decrypted&&(_+=". Bad passphrase?"),new Error(_);if(null===(l=B.readString(n.Integer,!0)))throw _="Malformed private key (expected DSA g value)",e._decrypted&&(_+=". Bad passphrase?"),new Error(_);if(null===(d=B.readString(n.Integer,!0)))throw _="Malformed private key (expected DSA y value)",e._decrypted&&(_+=". Bad passphrase?"),new Error(_);(t=new Buffer(15+a.length+4+u.length+4+l.length+4+d.length)).writeUInt32BE(7,0,!0),t.write("ssh-dss",4,7,"ascii"),r=11,t.writeUInt32BE(a.length,r,!0),a.copy(t,r+=4),t.writeUInt32BE(u.length,r+=a.length,!0),u.copy(t,r+=4),t.writeUInt32BE(l.length,r+=u.length,!0),l.copy(t,r+=4),t.writeUInt32BE(d.length,r+=l.length,!0),d.copy(t,r+=4)}else{if(null===(E=B.readString(n.OctetString,!0)))throw new Error("Malformed private key (expected ECDSA private key)");B.readByte();var S,U=B.readLength();if(null===U)throw new Error("Malformed private key (expected ECDSA context value)");if(B._offset=U,null===(m=B.readOID()))throw new Error("Malformed private key (expected ECDSA curve)");switch(m){case"1.2.840.10045.3.1.7":e.curve=v="nistp256",S=i.createECDH("prime256v1");break;case"1.3.132.0.34":e.curve=v="nistp384",S=i.createECDH("secp384r1");break;case"1.3.132.0.35":e.curve=v="nistp521",S=i.createECDH("secp521r1");break;default:throw new Error("Malformed private key (unsupported EC curve)")}S.setPrivateKey(E),g=S.getPublicKey(),(t=new Buffer(39+g.length)).writeUInt32BE(19,0,!0),t.write("ecdsa-sha2-"+v,4,19,"ascii"),t.writeUInt32BE(8,23,!0),t.write(v,27,8,"ascii"),t.writeUInt32BE(g.length,35,!0),g.copy(t,39)}}else{if(!e.public)throw new Error("Missing data generated by parseKey()");if(t=e.public,"ec"===e.type)v=e.curve;else if(0!==t[0]||0!==t[1]||0!==t[2]||7!==t[3]||115!==t[4]||115!==t[5]||104!==t[6]||45!==t[7]||(114!==t[8]||115!==t[9]||97!==t[10])&&(100!==t[8]||115!==t[9]||115!==t[10])){var I=new Buffer(11+t.length);t.copy(I,11),I.writeUInt32BE(7,0,!0),"rsa"===e.type?I.write("ssh-rsa",4,7,"ascii"):I.write("ssh-dss",4,7,"ascii"),t=I}}r=11,"rsa"===e.type?(w="ssh-rsa",y=f(t.slice(11))):"dss"===e.type?(w="ssh-dss",y=h(t.slice(11))):(w="ecdsa-sha2-"+v,y=p(t.slice(23)));if(!y)throw new Error("Invalid SSH-formatted public key");var A=y.toString("base64").replace(c,"$1\n"),T="-----BEGIN PUBLIC KEY-----\n"+A+("\n"===A[A.length-1]?"":"\n")+"-----END PUBLIC KEY-----";return{type:e.type,fulltype:w,curve:v,public:t,publicOrig:new Buffer(T)}},convertPPKPrivate:d,verifyPPKMAC:l,decryptKey:function(e,t){if(e._decrypted||!e.encryption)return;var r,s,a,c=0;switch(e.encryption=o[e.encryption]||e.encryption,e.encryption){case"aes-256-cbc":case"aes-256-ctr":c=32;break;case"des-ede3-cbc":case"des-ede3":case"aes-192-cbc":case"aes-192-ctr":c=24;break;case"aes-128-cbc":case"aes-128-ctr":case"cast-cbc":case"bf-cbc":c=16;break;default:throw new Error("Unsupported cipher for encrypted key: "+e.encryption)}if(e.ppk)s=u,r=(r=Buffer.concat([i.createHash("sha1").update("\0\0\0\0"+t,"utf8").digest(),i.createHash("sha1").update("\0\0\0"+t,"utf8").digest()])).slice(0,c);else{for(s=new Buffer(e.extra[0],"hex"),r=i.createHash("md5").update(t,"utf8").update(s.slice(0,8)).digest();c>r.length;)r=Buffer.concat([r,i.createHash("md5").update(r).update(t,"utf8").update(s).digest().slice(0,8)]);r.length>c&&(r=r.slice(0,c))}if((a=i.createDecipheriv(e.encryption,r,s)).setAutoPadding(!1),e.private=Buffer.concat([a.update(e.private),a.final()]),e._decrypted=!0,e.privateOrig){var f=e.privateOrig.toString("utf8"),h=/^(.+(?:\r\n|\n))/.exec(f)[1],p=e.private.toString("base64");h+=p.match(/.{1,70}/g).join("\n"),h+=/((?:\r\n|\n).+)$/.exec(f)[1],e.privateOrig=h}else if(e.ppk){if(!l(e,t,e.private))throw new Error("PPK MAC mismatch");d(e)}if("ec"!==e.type)e.fulltype="ssh-"+e.type;else{var E=new n.Reader(e.private);E.readSequence(),E.readInt(),E.readString(n.OctetString,!0),E.readByte();var g=E.readLength();if(null!==g)switch(E._offset=g,E.readOID()){case"1.2.840.10045.3.1.7":e.fulltype="ecdsa-sha2-nistp256";break;case"1.3.132.0.34":e.fulltype="ecdsa-sha2-nistp384";break;case"1.3.132.0.35":e.fulltype="ecdsa-sha2-nistp521"}if(void 0===e.fulltype)return new Error("Unsupported EC private key type")}},DSASigBERToBare:function(e){if(e.length<=40)return e;var t=new n.Reader(e);t.readSequence();var r=t.readString(n.Integer,!0),i=t.readString(n.Integer,!0),s=0,o=0;if(r.length<20){var a=new Buffer(20);r.copy(a,1),(r=a)[0]=0}if(i.length<20){var c=new Buffer(20);i.copy(c,1),(i=c)[0]=0}r.length>20&&0===r[0]&&(s=1);i.length>20&&0===i[0]&&(o=1);var u=new Buffer(r.length-s+(i.length-o));return r.copy(u,0,s),i.copy(u,r.length-s,o),u},DSASigBareToBER:function(e){if(e.length>40)return e;var t=new n.Writer;t.startSequence();var r=e.slice(0,20),i=e.slice(20);if(128&r[0]){var s=new Buffer(21);s[0]=0,r.copy(s,1),r=s}else 0!==r[0]||128&r[1]||(r=r.slice(1));if(128&i[0]){var o=new Buffer(21);o[0]=0,i.copy(o,1),i=o}else 0!==i[0]||128&i[1]||(i=i.slice(1));return t.writeBuffer(r,n.Integer),t.writeBuffer(i,n.Integer),t.endSequence(),t.buffer},ECDSASigASN1ToSSH:function(e){if(0===e[0])return e;var t=new n.Reader(e);t.readSequence();var r=t.readString(n.Integer,!0),i=t.readString(n.Integer,!0);if(null===r||null===i)throw new Error("Invalid signature");var s=new Buffer(4+r.length+4+i.length);return s.writeUInt32BE(r.length,0,!0),r.copy(s,4),s.writeUInt32BE(i.length,4+r.length,!0),i.copy(s,8+r.length),s},ECDSASigSSHToASN1:function(e,t,r){var i=E(e,0,t,r);if(!1===i)return!1;var s=E(e,e._pos,t,r);if(!1===s)return!1;var o=new n.Writer;return o.startSequence(),o.writeBuffer(i,n.Integer),o.writeBuffer(s,n.Integer),o.endSequence(),o.buffer},RSAKeySSHToASN1:f,DSAKeySSHToASN1:h,ECDSAKeySSHToASN1:p}},85:function(e,t){e.exports=require("dns")}});